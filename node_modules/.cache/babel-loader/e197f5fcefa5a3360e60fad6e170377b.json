{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  return t;\n};\n\nimport { isNullOrUndefined, extend, createElement, Ajax } from '@syncfusion/ej2-base';\nimport { getShapeColor } from '../model/theme';\nimport { GeoLocation, isCustomPath, convertGeoToPoint, Point, PathOption, Size, PolylineOption, removeElement } from '../utils/helper';\nimport { getElementByID, maintainSelection, getValueFromObject } from '../utils/helper';\nimport { RectOption, getTranslate, convertTileLatLongToPoint, checkShapeDataFields, CircleOption } from '../utils/helper';\nimport { getZoomTranslate, fixInitialScaleForTile } from '../utils/helper';\nimport { Tile } from '../model/base';\nimport { BingMap } from './bing-map';\nimport { ColorMapping } from './color-mapping';\nimport { layerRendering, shapeRendering } from '../index';\n/**\n * To calculate and render the shape layer\n */\n\nvar LayerPanel =\n/** @class */\nfunction () {\n  function LayerPanel(map) {\n    this.isMapCoordinates = true;\n    this.horizontalPan = false;\n    this.horizontalPanXCount = 0;\n    this.mapObject = map;\n    this.ajaxModule = new Ajax();\n    this.ajaxResponse = [];\n  }\n  /* tslint:disable:no-string-literal */\n\n\n  LayerPanel.prototype.measureLayerPanel = function () {\n    var _this = this;\n\n    var layerCollection = this.mapObject.layersCollection;\n    var areaRect = this.mapObject.mapAreaRect;\n    var secondaryEle = getElementByID(this.mapObject.element.id + '_Secondary_Element');\n\n    if (this.mapObject.isTileMap && secondaryEle) {\n      this.tileSvgObject = this.mapObject.renderer.createSvg({\n        id: this.mapObject.element.id + '_Tile_SVG',\n        width: areaRect.width,\n        height: areaRect.height\n      });\n      var parentElement = createElement('div', {\n        id: this.mapObject.element.id + '_Tile_SVG_Parent',\n        styles: 'position: absolute; height: ' + areaRect.height + 'px; width: ' + areaRect.width + 'px;'\n      });\n      parentElement.appendChild(this.tileSvgObject);\n      secondaryEle.appendChild(parentElement);\n    }\n\n    this.layerGroup = this.mapObject.renderer.createGroup({\n      id: this.mapObject.element.id + '_Layer_Collections',\n      'clip-path': 'url(#' + this.mapObject.element.id + '_MapArea_ClipRect)'\n    });\n\n    if (this.mapObject.layers[this.mapObject.baseLayerIndex].layerType === 'GoogleStaticMap') {\n      var staticMapSize = 640;\n      this.clipRectElement = this.mapObject.renderer.drawClipPath(new RectOption(this.mapObject.element.id + '_MapArea_ClipRect', 'transparent', {\n        width: 1,\n        color: 'Gray'\n      }, 1, {\n        x: (areaRect.width - staticMapSize) / 2,\n        y: 0,\n        width: staticMapSize,\n        height: areaRect.height\n      }));\n    } else {\n      this.clipRectElement = this.mapObject.renderer.drawClipPath(new RectOption(this.mapObject.element.id + '_MapArea_ClipRect', 'transparent', {\n        width: 1,\n        color: 'Gray'\n      }, 1, {\n        x: this.mapObject.isTileMap ? 0 : areaRect.x,\n        y: this.mapObject.isTileMap ? 0 : areaRect.y,\n        width: areaRect.width,\n        height: areaRect.height < 0 ? 0 : areaRect.height\n      }));\n    }\n\n    this.layerGroup.appendChild(this.clipRectElement);\n    this.mapObject.baseMapBounds = null;\n    this.mapObject.baseMapRectBounds = null;\n    this.mapObject.baseSize = null;\n    Array.prototype.forEach.call(layerCollection, function (layer, index) {\n      _this.currentLayer = layer;\n\n      _this.processLayers(layer, index);\n    });\n  };\n  /**\n   * Tile rendering\n   * @private\n   */\n  // tslint:disable-next-line:max-func-body-length\n\n\n  LayerPanel.prototype.renderTileLayer = function (panel, layer, layerIndex, bing) {\n    panel.currentFactor = panel.calculateFactor(layer);\n    panel.mapObject.defaultState = panel.mapObject.zoomSettings.zoomFactor !== 1 && !isNullOrUndefined(panel.mapObject.tileZoomLevel) && panel.mapObject.tileZoomLevel !== 1 ? false : true;\n\n    if (isNullOrUndefined(panel.mapObject.previousCenterLatitude) && isNullOrUndefined(panel.mapObject.previousCenterLongitude)) {\n      panel.mapObject.previousCenterLatitude = panel.mapObject.centerPosition.latitude;\n      panel.mapObject.previousCenterLongitude = panel.mapObject.centerPosition.longitude;\n    } else if (panel.mapObject.previousCenterLatitude !== panel.mapObject.centerPosition.latitude && panel.mapObject.previousCenterLongitude !== panel.mapObject.centerPosition.longitude) {\n      panel.mapObject.centerPositionChanged = true;\n      panel.mapObject.previousCenterLatitude = panel.mapObject.centerPosition.latitude;\n      panel.mapObject.previousCenterLongitude = panel.mapObject.centerPosition.longitude;\n    } else {\n      panel.mapObject.centerPositionChanged = false;\n    }\n\n    var center = new Point(panel.mapObject.centerPosition.longitude, panel.mapObject.centerPosition.latitude);\n    var centerTileMap = center;\n\n    if (this.mapObject.isTileMap && panel.mapObject.markerModule && panel.mapObject.zoomSettings.enable) {\n      panel.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);\n\n      if (!isNullOrUndefined(this.mapObject.markerCenterLatitude) && !isNullOrUndefined(this.mapObject.markerCenterLongitude)) {\n        centerTileMap = new Point(panel.mapObject.markerCenterLongitude, panel.mapObject.markerCenterLatitude);\n      }\n    }\n\n    if (!panel.mapObject.zoomSettings.shouldZoomInitially && panel.mapObject.centerPosition.longitude && panel.mapObject.centerPosition.latitude && !panel.mapObject.zoomPersistence && panel.mapObject.defaultState) {\n      center = new Point(panel.mapObject.centerPosition.longitude, panel.mapObject.centerPosition.latitude);\n    } else if (panel.mapObject.zoomSettings.shouldZoomInitially && panel.mapObject.markerZoomedState && !panel.mapObject.zoomPersistence && !isNullOrUndefined(panel.mapObject.markerZoomCenterPoint)) {\n      center = new Point(panel.mapObject.markerZoomCenterPoint.longitude, panel.mapObject.markerZoomCenterPoint.latitude);\n    } else {\n      center = {\n        x: null,\n        y: null\n      };\n    }\n\n    var zoomFactorValue = panel.mapObject.zoomSettings.shouldZoomInitially ? isNullOrUndefined(panel.mapObject.markerZoomFactor) ? 1 : panel.mapObject.markerZoomFactor : panel.mapObject.zoomSettings.zoomFactor;\n    zoomFactorValue = panel.mapObject.enablePersistence ? isNullOrUndefined(panel.mapObject.mapScaleValue) ? isNullOrUndefined(panel.mapObject.markerZoomFactor) ? panel.mapObject.zoomSettings.zoomFactor : panel.mapObject.markerZoomFactor : panel.mapObject.mapScaleValue : zoomFactorValue;\n    zoomFactorValue = panel.mapObject.zoomSettings.enable ? zoomFactorValue : panel.mapObject.zoomSettings.zoomFactor;\n\n    if (isNullOrUndefined(panel.mapObject.tileZoomLevel)) {\n      panel.mapObject.tileZoomLevel = zoomFactorValue;\n      panel.mapObject.previousZoomFactor = zoomFactorValue;\n    } else if (this.mapObject.isReset && panel.mapObject.tileZoomLevel === 1 && !panel.mapObject.zoomSettings.shouldZoomInitially) {\n      panel.mapObject.tileZoomLevel = panel.mapObject.tileZoomLevel;\n    } else if (panel.mapObject.zoomSettings.zoomFactor !== 1 || panel.mapObject.zoomSettings.shouldZoomInitially) {\n      panel.mapObject.tileZoomLevel = panel.mapObject.defaultState && panel.mapObject.zoomSettings.enable ? panel.mapObject.tileZoomLevel : !panel.mapObject.zoomSettings.shouldZoomInitially && !panel.mapObject.centerPositionChanged ? panel.mapObject.previousZoomFactor !== panel.mapObject.zoomSettings.zoomFactor ? panel.mapObject.zoomSettings.zoomFactor : panel.mapObject.tileZoomLevel : zoomFactorValue;\n\n      if (!isNullOrUndefined(panel.mapObject.tileTranslatePoint) && (panel.mapObject.markerZoomFactor !== panel.mapObject.mapScaleValue || isNullOrUndefined(panel.mapObject.markerZoomFactor) && isNullOrUndefined(panel.mapObject.mapScaleValue)) && (panel.mapObject.zoomSettings.zoomFactor <= 1 || panel.mapObject.previousZoomFactor !== panel.mapObject.zoomSettings.zoomFactor)) {\n        panel.mapObject.tileTranslatePoint.x = 0;\n        panel.mapObject.tileTranslatePoint.y = 0;\n      }\n    }\n\n    if (zoomFactorValue <= 1 && !isNullOrUndefined(panel.mapObject.height) && !panel.mapObject.zoomSettings.shouldZoomInitially && panel.mapObject.tileZoomLevel === panel.mapObject.tileZoomScale && this.mapObject.initialCheck) {\n      fixInitialScaleForTile(this.mapObject);\n    }\n\n    if (!isNullOrUndefined(panel.mapObject.centerLatOfGivenLocation) && !isNullOrUndefined(panel.mapObject.centerLongOfGivenLocation) && panel.mapObject.zoomNotApplied) {\n      centerTileMap.y = panel.mapObject.centerLatOfGivenLocation;\n      centerTileMap.x = panel.mapObject.centerLongOfGivenLocation;\n      panel.mapObject.tileZoomLevel = panel.mapObject.mapScaleValue = panel.mapObject.scaleOfGivenLocation;\n    }\n\n    panel.mapObject.tileTranslatePoint = panel.panTileMap(panel.mapObject.availableSize.width, panel.mapObject.availableSize.height, centerTileMap);\n\n    if (this.mapObject.zoomSettings.resetToInitial && this.mapObject.initialCheck && !isNullOrUndefined(panel.mapObject.height) && this.mapObject.availableSize.height > 512) {\n      this.mapObject.applyZoomReset = true;\n      this.mapObject.initialZoomLevel = Math.floor(this.mapObject.availableSize.height / 512) + 1;\n      var padding = this.mapObject.layers[this.mapObject.baseLayerIndex].layerType !== 'GoogleStaticMap' ? 20 : 0;\n      var totalSize = Math.pow(2, this.mapObject.initialZoomLevel) * 256;\n      this.mapObject.initialTileTranslate.x = this.mapObject.availableSize.width / 2 - totalSize / 2;\n      this.mapObject.initialTileTranslate.y = this.mapObject.availableSize.height / 2 - totalSize / 2 + padding;\n    }\n\n    panel.generateTiles(panel.mapObject.tileZoomLevel, panel.mapObject.tileTranslatePoint, null, bing);\n\n    if (!isNullOrUndefined(panel.mapObject.previousZoomFactor) && panel.mapObject.previousZoomFactor !== panel.mapObject.zoomSettings.zoomFactor) {\n      panel.mapObject.previousZoomFactor = panel.mapObject.zoomSettings.zoomFactor;\n    }\n\n    if (panel.mapObject.navigationLineModule) {\n      panel.layerObject.appendChild(panel.mapObject.navigationLineModule.renderNavigation(panel.currentLayer, panel.mapObject.tileZoomLevel, layerIndex));\n    }\n\n    if (panel.mapObject.markerModule) {\n      panel.mapObject.markerModule.markerRender(panel.layerObject, layerIndex, panel.mapObject.tileZoomLevel, null);\n    }\n\n    panel.translateLayerElements(panel.layerObject, layerIndex);\n    panel.layerGroup.appendChild(panel.layerObject);\n  };\n\n  LayerPanel.prototype.processLayers = function (layer, layerIndex) {\n    var _this = this;\n\n    this.layerObject = this.mapObject.renderer.createGroup({\n      id: this.mapObject.element.id + '_LayerIndex_' + layerIndex\n    });\n\n    if (!this.mapObject.enablePersistence) {\n      var itemName = this.mapObject.getModuleName() + this.mapObject.element.id;\n\n      if (navigator.userAgent.indexOf('Edge') === -1) {\n        if (!isNullOrUndefined(window.localStorage) && window.localStorage.getItem(itemName)) {\n          window.localStorage.removeItem(itemName);\n        }\n      }\n    }\n\n    var eventArgs = {\n      cancel: false,\n      name: layerRendering,\n      index: layerIndex,\n      layer: layer,\n      maps: this.mapObject,\n      visible: layer.visible\n    };\n\n    if (this.mapObject.isBlazor) {\n      var maps = eventArgs.maps,\n          layer_1 = eventArgs.layer,\n          blazorEventArgs = __rest(eventArgs, [\"maps\", \"layer\"]);\n\n      eventArgs = blazorEventArgs;\n    }\n\n    this.mapObject.trigger('layerRendering', eventArgs, function (observedArgs) {\n      if (!eventArgs.cancel && eventArgs.visible) {\n        if (layer.layerType !== 'Geometry') {\n          if (layer.layerType !== 'Bing' || _this.bing) {\n            _this.renderTileLayer(_this, layer, layerIndex);\n          } else if (layer.key && layer.key.length > 1) {\n            var proxy_1 = _this;\n            var bing_1 = new BingMap(_this.mapObject);\n            var bingType = layer.bingMapType === 'AerialWithLabel' ? 'AerialWithLabelsOnDemand' : layer.bingMapType;\n            var url = 'https://dev.virtualearth.net/REST/V1/Imagery/Metadata/' + bingType;\n            var ajax = new Ajax({\n              url: url + '?output=json&include=ImageryProviders&urischeme=https&key=' + layer.key\n            });\n\n            ajax.onSuccess = function (json) {\n              var jsonObject = JSON.parse(json);\n              var resource = jsonObject['resourceSets'][0]['resources'][0];\n              var imageUrl = resource['imageUrl'];\n              var subDomains = resource['imageUrlSubdomains'];\n              var maxZoom = resource['zoomMax'];\n\n              if (imageUrl !== null && imageUrl !== undefined && imageUrl !== bing_1.imageUrl) {\n                bing_1.imageUrl = imageUrl;\n              }\n\n              if (subDomains !== null && subDomains !== undefined && subDomains !== bing_1.subDomains) {\n                bing_1.subDomains = subDomains;\n              }\n\n              if (maxZoom !== null && maxZoom !== undefined && maxZoom !== bing_1.maxZoom) {\n                bing_1.maxZoom = maxZoom;\n              }\n\n              proxy_1.mapObject['bingMap'] = bing_1;\n              proxy_1.renderTileLayer(proxy_1, layer, layerIndex, bing_1);\n\n              _this.mapObject.arrangeTemplate();\n            };\n\n            ajax.send();\n          }\n        } else {\n          if (!isNullOrUndefined(layer.shapeData) && (!isNullOrUndefined(layer.shapeData['geometries']) || !isNullOrUndefined(layer.shapeData['features']))) {\n            var featureData = !isNullOrUndefined(layer.shapeData['geometries']) && layer.shapeData['geometries'].length > 0 ? layer.shapeData['geometries'] : layer.shapeData['features'];\n            layer.layerData = [];\n            var bbox = layer.shapeData['bbox'];\n\n            if (!isNullOrUndefined(bbox) && layer.isBaseLayer) {\n              _this.mapObject.baseMapBounds = new GeoLocation({\n                min: bbox[0][1],\n                max: bbox[1][1]\n              }, {\n                min: bbox[0][0],\n                max: bbox[1][0]\n              });\n            } else if (isNullOrUndefined(_this.mapObject.baseMapBounds) && !isCustomPath(featureData)) {\n              _this.calculateRectBounds(featureData);\n            }\n\n            _this.calculatePathCollection(layerIndex, featureData);\n          }\n        }\n      }\n    });\n\n    if (!this.mapObject.isTileMap) {\n      this.mapObject.svgObject.appendChild(this.layerGroup);\n    } else if (this.tileSvgObject) {\n      this.tileSvgObject.appendChild(this.layerGroup);\n      this.mapObject.baseMapBounds = null;\n    }\n  }; //tslint:disable:max-func-body-length\n\n\n  LayerPanel.prototype.bubbleCalculation = function (bubbleSettings, range) {\n    if (bubbleSettings.dataSource != null && bubbleSettings != null) {\n      var bubbleDataSource = bubbleSettings.dataSource;\n\n      for (var i = 0; i < bubbleDataSource.length; i++) {\n        var bubbledata = !isNullOrUndefined(bubbleSettings.valuePath) ? bubbleSettings.valuePath.indexOf('.') > -1 ? Number(getValueFromObject(bubbleSettings.dataSource[i], bubbleSettings.valuePath)) : parseFloat(bubbleSettings.dataSource[i][bubbleSettings.valuePath]) : parseFloat(bubbleSettings.dataSource[i][bubbleSettings.valuePath]);\n\n        if (i !== 0) {\n          if (bubbledata > range.max) {\n            range.max = bubbledata;\n          } else if (bubbledata < range.min) {\n            range.min = bubbledata;\n          }\n        } else {\n          range.max = range.min = bubbledata;\n        }\n      }\n    }\n  }; // tslint:disable-next-line:max-func-body-length\n\n\n  LayerPanel.prototype.calculatePathCollection = function (layerIndex, renderData) {\n    var _this = this;\n\n    this.groupElements = [];\n\n    if (!isCustomPath(renderData)) {\n      this.currentFactor = this.calculateFactor(this.currentLayer);\n    }\n\n    this.rectBounds = null;\n    var shapeSettings = this.currentLayer.shapeSettings;\n    var bubbleSettings = this.currentLayer.bubbleSettings;\n    Array.prototype.forEach.call(renderData, function (geometryData, index) {\n      if (!isNullOrUndefined(geometryData['geometry']) || !isNullOrUndefined(geometryData['coordinates'])) {\n        var type = !isNullOrUndefined(geometryData['geometry']) ? geometryData['geometry']['type'] : geometryData['type'];\n        var coords = !isNullOrUndefined(geometryData['geometry']) ? geometryData['geometry']['coordinates'] : geometryData['coordinates'];\n        var data = geometryData['geometry'];\n        var properties = geometryData['properties'];\n\n        if (type !== 'LineString') {\n          _this.generatePoints(type, coords, data, properties);\n        }\n      }\n    });\n    this.currentLayer.rectBounds = this.rectBounds;\n\n    if (isNullOrUndefined(this.mapObject.baseMapRectBounds) && this.currentLayer.isBaseLayer) {\n      this.mapObject.baseMapRectBounds = this.rectBounds;\n    }\n\n    var colors = shapeSettings.palette.length > 1 ? shapeSettings.palette : getShapeColor(this.mapObject.theme);\n    var labelTemplateEle = createElement('div', {\n      id: this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_Label_Template_Group',\n      className: this.mapObject.element.id + '_template',\n      styles: 'pointer-events: none; overflow: hidden; position: absolute;' + 'top:' + this.mapObject.mapAreaRect.y + 'px;' + 'left:' + this.mapObject.mapAreaRect.x + 'px;' + 'height:' + this.mapObject.mapAreaRect.height + 'px;' + 'width:' + this.mapObject.mapAreaRect.width + 'px;'\n    });\n\n    if (this.currentLayer.layerData.length !== 0) {\n      var _loop_1 = function (i) {\n        var k = void 0;\n        var currentShapeData = this_1.currentLayer.layerData[i];\n        var pathOptions;\n        var polyLineOptions;\n        var circleOptions;\n        var groupElement;\n        var drawObject = void 0;\n        var path = '';\n        var points = '';\n        var getShapeColor_1 = void 0;\n        var fill = shapeSettings.autofill ? colors[i % colors.length] : shapeSettings.fill;\n        var opacity;\n\n        if (shapeSettings.colorValuePath !== null && !isNullOrUndefined(currentShapeData['property'])) {\n          k = checkShapeDataFields(this_1.currentLayer.dataSource, currentShapeData['property'], this_1.currentLayer.shapeDataPath, this_1.currentLayer.shapePropertyPath, this_1.currentLayer);\n\n          if (k !== null && shapeSettings.colorMapping.length === 0) {\n            fill = this_1.currentLayer.shapeSettings.colorValuePath.indexOf('.') > -1 ? getValueFromObject(this_1.currentLayer.dataSource[k], shapeSettings.colorValuePath) : this_1.currentLayer.dataSource[k][shapeSettings.colorValuePath];\n          } else if (currentShapeData['property'][shapeSettings.colorValuePath] && this_1.currentLayer.dataSource.length === 0 && shapeSettings.colorMapping.length === 0) {\n            fill = this_1.currentLayer.shapeSettings.colorValuePath.indexOf('.') > -1 ? getValueFromObject(currentShapeData['property'], shapeSettings.colorValuePath) : currentShapeData['property'][shapeSettings.colorValuePath];\n          }\n\n          fill = !isNullOrUndefined(fill) ? fill : shapeSettings.fill;\n        }\n\n        var shapeID = this_1.mapObject.element.id + '_LayerIndex_' + layerIndex + '_shapeIndex_' + i + '_dataIndex_' + k;\n        getShapeColor_1 = this_1.getShapeColorMapping(this_1.currentLayer, currentShapeData['property'], fill);\n        fill = Object.prototype.toString.call(getShapeColor_1) === '[object Object]' && !isNullOrUndefined(getShapeColor_1['fill']) ? getShapeColor_1['fill'] : fill;\n        opacity = Object.prototype.toString.call(getShapeColor_1) === '[object Object]' && !isNullOrUndefined(getShapeColor_1['opacity']) ? getShapeColor_1['opacity'] : shapeSettings.opacity;\n        var eventArgs = {\n          cancel: false,\n          name: shapeRendering,\n          index: i,\n          data: this_1.currentLayer.dataSource ? this_1.currentLayer.dataSource[k] : null,\n          maps: this_1.mapObject,\n          shape: shapeSettings,\n          fill: fill,\n          border: {\n            width: shapeSettings.border.width,\n            color: shapeSettings.border.color\n          }\n        };\n\n        if (this_1.mapObject.isBlazor) {\n          var maps = eventArgs.maps,\n              blazorEventArgs = __rest(eventArgs, [\"maps\"]);\n\n          eventArgs = blazorEventArgs;\n        } // tslint:disable-next-line:max-func-body-length\n\n\n        var shapeRenderingSuccess = function (eventArgs) {\n          var drawingType = !isNullOrUndefined(currentShapeData['_isMultiPolygon']) ? 'MultiPolygon' : isNullOrUndefined(currentShapeData['type']) ? currentShapeData[0]['type'] : currentShapeData['type'];\n          drawingType = drawingType === 'Polygon' || drawingType === 'MultiPolygon' ? 'Polygon' : drawingType;\n\n          if (!eventArgs.cancel) {\n            eventArgs.fill = eventArgs.fill === '#A6A6A6' ? eventArgs.shape.fill : eventArgs.fill;\n            eventArgs.border.color = eventArgs.border.color === '#000000' ? eventArgs.shape.border.color : eventArgs.border.color;\n            eventArgs.border.width = eventArgs.border.width === 0 ? eventArgs.shape.border.width : eventArgs.border.width;\n            _this.mapObject.layers[layerIndex].shapeSettings.border = eventArgs.border;\n          } else {\n            eventArgs.fill = fill;\n            eventArgs.border.color = shapeSettings.border.color;\n            eventArgs.border.width = shapeSettings.border.width;\n            _this.mapObject.layers[layerIndex].shapeSettings.border = shapeSettings.border;\n          }\n\n          if (_this.groupElements.length < 1) {\n            groupElement = _this.mapObject.renderer.createGroup({\n              id: _this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_' + drawingType + '_Group',\n              transform: ''\n            });\n\n            _this.groupElements.push(groupElement);\n          } else {\n            for (var i_1 = 0; i_1 < _this.groupElements.length; i_1++) {\n              var ele = _this.groupElements[i_1];\n\n              if (ele.id.indexOf(drawingType) > -1) {\n                groupElement = ele;\n                break;\n              } else if (i_1 >= _this.groupElements.length - 1) {\n                groupElement = _this.mapObject.renderer.createGroup({\n                  id: _this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_' + drawingType + '_Group'\n                });\n\n                _this.groupElements.push(groupElement);\n\n                break;\n              }\n            }\n          }\n\n          var pathEle;\n\n          switch (drawingType) {\n            case 'Polygon':\n              if (!currentShapeData['_isMultiPolygon']) {\n                path += 'M' + currentShapeData[0]['point']['x'] + ' ' + currentShapeData[0]['point']['y'];\n                currentShapeData.map(function (shapeData) {\n                  path += ' L ' + shapeData['point']['x'] + ' ' + shapeData['point']['y'];\n                });\n              } else {\n                path = _this.generateMultiPolygonPath(currentShapeData);\n              }\n\n              path += ' z ';\n\n              if (path.length > 3) {\n                pathOptions = new PathOption(shapeID, eventArgs.fill, eventArgs.border.width, eventArgs.border.color, opacity, shapeSettings.dashArray, path);\n                pathEle = _this.mapObject.renderer.drawPath(pathOptions);\n              }\n\n              break;\n\n            case 'LineString':\n              currentShapeData.map(function (lineData) {\n                points += lineData['point']['x'] + ' , ' + lineData['point']['y'] + ' ';\n              });\n              polyLineOptions = new PolylineOption(shapeID, points, eventArgs.fill, eventArgs.border.width, eventArgs.border.color, opacity, shapeSettings.dashArray);\n              pathEle = _this.mapObject.renderer.drawPolyline(polyLineOptions);\n              break;\n\n            case 'Point':\n              var pointData = currentShapeData['point'];\n              circleOptions = new CircleOption(shapeID, eventArgs.fill, eventArgs.border, opacity, pointData['x'], pointData['y'], shapeSettings.circleRadius, null);\n              pathEle = _this.mapObject.renderer.drawCircle(circleOptions);\n              break;\n\n            case 'Path':\n              path = currentShapeData['point'];\n              pathOptions = new PathOption(shapeID, eventArgs.fill, eventArgs.border.width, eventArgs.border.color, opacity, shapeSettings.dashArray, path);\n              pathEle = _this.mapObject.renderer.drawPath(pathOptions);\n              break;\n          }\n\n          if (!isNullOrUndefined(pathEle)) {\n            var property = Object.prototype.toString.call(_this.currentLayer.shapePropertyPath) === '[object Array]' ? _this.currentLayer.shapePropertyPath : [_this.currentLayer.shapePropertyPath]; // tslint:disable-next-line:align\n\n            var properties = void 0;\n\n            for (var j = 0; j < property.length; j++) {\n              if (!isNullOrUndefined(currentShapeData['property'])) {\n                properties = property[j];\n                break;\n              }\n            }\n\n            pathEle.setAttribute('aria-label', !isNullOrUndefined(currentShapeData['property']) ? currentShapeData['property'][properties] : '');\n            pathEle.setAttribute('tabindex', (_this.mapObject.tabIndex + i + 2).toString());\n            maintainSelection(_this.mapObject.selectedElementId, _this.mapObject.shapeSelectionClass, pathEle, 'ShapeselectionMapStyle');\n\n            if (_this.mapObject.toggledShapeElementId) {\n              for (var j = 0; j < _this.mapObject.toggledShapeElementId.length; j++) {\n                var styleProperty = _this.mapObject.legendSettings.toggleLegendSettings.applyShapeSettings ? _this.currentLayer.shapeSettings : _this.mapObject.legendSettings.toggleLegendSettings;\n\n                if (_this.mapObject.toggledShapeElementId[j] === pathEle.id) {\n                  pathEle.setAttribute('fill', styleProperty.fill);\n                  pathEle.setAttribute('stroke', styleProperty.border.color);\n                  pathEle.setAttribute('opacity', styleProperty.opacity.toString());\n                  pathEle.setAttribute('stroke-width', styleProperty.border.width.toString());\n                }\n              }\n            }\n\n            groupElement.appendChild(pathEle);\n          }\n\n          if (i === _this.currentLayer.layerData.length - 1) {\n            _this.layerFeatures(layerIndex, colors, renderData, labelTemplateEle);\n          }\n        };\n\n        shapeRenderingSuccess.bind(this_1);\n        this_1.mapObject.trigger('shapeRendering', eventArgs, shapeRenderingSuccess);\n      };\n\n      var this_1 = this;\n\n      for (var i = 0; i < this.currentLayer.layerData.length; i++) {\n        _loop_1(i);\n      }\n    } else {\n      this.layerFeatures(layerIndex, colors, renderData, labelTemplateEle);\n    }\n  };\n  /**\n   *  layer features as bubble, marker, datalabel, navigation line.\n   */\n\n\n  LayerPanel.prototype.layerFeatures = function (layerIndex, colors, renderData, labelTemplateEle) {\n    var _this = this;\n\n    var bubbleG;\n\n    if (this.currentLayer.bubbleSettings.length && this.mapObject.bubbleModule) {\n      var length_1 = this.currentLayer.bubbleSettings.length;\n      var bubble_1;\n\n      var _loop_2 = function (j) {\n        bubble_1 = this_2.currentLayer.bubbleSettings[j];\n        bubbleG = this_2.mapObject.renderer.createGroup({\n          id: this_2.mapObject.element.id + '_LayerIndex_' + layerIndex + '_bubble_Group_' + j\n        });\n        var range = {\n          min: 0,\n          max: 0\n        };\n        this_2.bubbleCalculation(bubble_1, range);\n        var bubbleDataSource = bubble_1.dataSource;\n        bubbleDataSource.map(function (bubbleData, i) {\n          _this.renderBubble(_this.currentLayer, bubbleData, colors[i % colors.length], range, j, i, bubbleG, layerIndex, bubble_1);\n        });\n        this_2.groupElements.push(bubbleG);\n      };\n\n      var this_2 = this;\n\n      for (var j = 0; j < length_1; j++) {\n        _loop_2(j);\n      }\n    }\n\n    if (this.mapObject.markerModule && !this.mapObject.isTileMap && this.mapObject.zoomSettings.enable) {\n      this.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);\n    }\n\n    var group = this.mapObject.renderer.createGroup({\n      id: this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_dataLableIndex_Group',\n      style: 'pointer-events: none;'\n    });\n\n    if (this.mapObject.dataLabelModule && this.currentLayer.dataLabelSettings.visible) {\n      var intersect_1 = [];\n      renderData.map(function (currentShapeData, i) {\n        _this.renderLabel(_this.currentLayer, layerIndex, currentShapeData, group, i, labelTemplateEle, intersect_1);\n      });\n      this.groupElements.push(group);\n    }\n\n    if (this.mapObject.navigationLineModule) {\n      this.groupElements.push(this.mapObject.navigationLineModule.renderNavigation(this.currentLayer, this.currentFactor, layerIndex));\n    }\n\n    this.groupElements.map(function (element) {\n      _this.layerObject.appendChild(element);\n    });\n\n    if (this.mapObject.markerModule) {\n      this.mapObject.markerModule.markerRender(this.layerObject, layerIndex, this.mapObject.isTileMap ? Math.floor(this.currentFactor) : this.currentFactor, null);\n    }\n\n    this.translateLayerElements(this.layerObject, layerIndex);\n    this.layerGroup.appendChild(this.layerObject);\n  };\n  /**\n   *  render datalabel\n   */\n\n\n  LayerPanel.prototype.renderLabel = function (layer, layerIndex, shape, group, shapeIndex, labelTemplateEle, intersect) {\n    this.mapObject.dataLabelModule.renderLabel(layer, layerIndex, shape, layer.layerData, group, labelTemplateEle, shapeIndex, intersect);\n  };\n  /**\n   * To render path for multipolygon\n   */\n\n\n  LayerPanel.prototype.generateMultiPolygonPath = function (currentShapeData) {\n    var path = '';\n    var shape;\n\n    for (var j = 0; j < currentShapeData.length; j++) {\n      path += 'M' + currentShapeData[j][0]['point']['x'] + ' ' + currentShapeData[j][0]['point']['y'];\n      shape = currentShapeData[j];\n      shape.map(function (shapeData) {\n        path += ' L ' + shapeData['point']['x'] + ' ' + shapeData['point']['y'];\n      });\n    }\n\n    return path;\n  };\n  /**\n   * To render bubble\n   */\n\n\n  LayerPanel.prototype.renderBubble = function (layer, bubbleData, color, range, bubbleIndex, dataIndex, group, layerIndex, bubbleSettings) {\n    if (isNullOrUndefined(this.mapObject.bubbleModule) || !bubbleSettings.visible) {\n      return null;\n    }\n\n    color = bubbleSettings.fill ? bubbleSettings.fill : color;\n    this.mapObject.bubbleModule.id = this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_BubbleIndex_' + bubbleIndex + '_dataIndex_' + dataIndex;\n    this.mapObject.bubbleModule.renderBubble(bubbleSettings, bubbleData, color, range, bubbleIndex, dataIndex, layerIndex, layer, group, this.mapObject.bubbleModule.id);\n  };\n  /**\n   * To get the shape color from color mapping module\n   */\n\n\n  LayerPanel.prototype.getShapeColorMapping = function (layer, shape, color) {\n    color = color ? color : layer.shapeSettings.fill;\n\n    if (layer.shapeSettings.colorMapping.length === 0 && isNullOrUndefined(layer.dataSource)) {\n      return color;\n    }\n\n    var index = checkShapeDataFields(layer.dataSource, shape, layer.shapeDataPath, layer.shapePropertyPath, layer);\n    var colorMapping = new ColorMapping(this.mapObject);\n\n    if (isNullOrUndefined(layer.dataSource[index])) {\n      return color;\n    }\n\n    return colorMapping.getShapeColorMapping(layer.shapeSettings, layer.dataSource[index], color);\n  };\n\n  LayerPanel.prototype.generatePoints = function (type, coordinates, data, properties) {\n    var _this = this;\n\n    var latitude;\n    var longitude;\n    var newData = [];\n\n    switch (type.toLowerCase()) {\n      case 'polygon':\n        newData = this.calculatePolygonBox(coordinates[0], data, properties);\n\n        if (newData.length > 0) {\n          newData['property'] = properties;\n          newData['type'] = type;\n          newData['_isMultiPolygon'] = false;\n          this.currentLayer.layerData.push(newData);\n        }\n\n        break;\n\n      case 'multipolygon':\n        var multiPolygonDatas = [];\n\n        for (var i = 0; i < coordinates.length; i++) {\n          newData = this.calculatePolygonBox(coordinates[i][0], data, properties);\n\n          if (newData.length > 0) {\n            multiPolygonDatas.push(newData);\n          }\n        }\n\n        multiPolygonDatas['property'] = properties;\n        multiPolygonDatas['type'] = type;\n        multiPolygonDatas['_isMultiPolygon'] = true;\n        this.currentLayer.layerData.push(multiPolygonDatas);\n        break;\n\n      case 'linestring':\n        coordinates.map(function (points, index) {\n          latitude = points[1];\n          longitude = points[0];\n          var point = convertGeoToPoint(latitude, longitude, _this.currentFactor, _this.currentLayer, _this.mapObject);\n          newData.push({\n            point: point,\n            lat: latitude,\n            lng: longitude\n          });\n        });\n        newData['property'] = properties;\n        newData['type'] = type;\n        this.currentLayer.layerData.push(newData);\n        break;\n\n      case 'point':\n        var arrayCollections_1 = false;\n        coordinates.map(function (points, index) {\n          if (Object.prototype.toString.call(points) === '[object Array]') {\n            latitude = points[1];\n            longitude = points[0];\n            arrayCollections_1 = true;\n            var point = convertGeoToPoint(latitude, longitude, _this.currentFactor, _this.currentLayer, _this.mapObject);\n\n            _this.currentLayer.layerData.push({\n              point: point,\n              type: type,\n              lat: latitude,\n              lng: longitude,\n              property: properties\n            });\n          }\n        });\n\n        if (!arrayCollections_1) {\n          latitude = coordinates[1];\n          longitude = coordinates[0];\n          var point = convertGeoToPoint(latitude, longitude, this.currentFactor, this.currentLayer, this.mapObject);\n          this.currentLayer.layerData.push({\n            point: point,\n            type: type,\n            lat: latitude,\n            lng: longitude,\n            property: properties\n          });\n        }\n\n        break;\n\n      case 'path':\n        this.currentLayer.layerData.push({\n          point: data['d'],\n          type: type,\n          property: properties\n        });\n        break;\n    }\n  };\n\n  LayerPanel.prototype.calculateFactor = function (layer) {\n    var horFactor;\n    var verFactor = 1;\n    var divide = 10;\n    var exp = 'e+1';\n    var bounds = this.mapObject.baseMapBounds;\n    var mapSize = new Size(this.mapObject.mapAreaRect.width, this.mapObject.mapAreaRect.height - 5);\n    var mapHeight;\n    var mapWidth;\n\n    if (bounds) {\n      var start = convertGeoToPoint(bounds.latitude.min, bounds.longitude.min, null, layer, this.mapObject);\n      var end = convertGeoToPoint(bounds.latitude.max, bounds.longitude.max, null, layer, this.mapObject);\n      mapHeight = end.y - start.y;\n      mapWidth = end.x - start.x;\n    } else {\n      mapHeight = mapWidth = 500;\n    }\n\n    if (mapHeight < mapSize.height) {\n      horFactor = parseFloat(Math.abs(Number(mapSize.height / Number(mapHeight.toString() + exp)) * 100).toString().split('.')[0]) / divide;\n    } else {\n      horFactor = mapSize.height / mapHeight;\n    }\n\n    if (mapWidth < mapSize.width) {\n      verFactor = parseFloat(Math.abs(Number(mapSize.width / Number(mapWidth.toString() + exp)) * 100).toString().split('.')[0]) / divide;\n    } else {\n      verFactor = mapSize.width / mapWidth;\n    }\n\n    return Math.min(verFactor, horFactor);\n  };\n\n  LayerPanel.prototype.translateLayerElements = function (layerElement, index) {\n    var childNode;\n    this.mapObject.translateType = 'layer';\n\n    if (!isNullOrUndefined(this.mapObject.baseMapRectBounds)) {\n      var duration = this.currentLayer.animationDuration;\n      var animate = duration !== 0 || isNullOrUndefined(this.mapObject.zoomModule);\n      this.mapObject.baseTranslatePoint = this.mapObject.zoomTranslatePoint;\n      var translate = void 0;\n\n      if (this.mapObject.zoomSettings.zoomFactor > 1 && !isNullOrUndefined(this.mapObject.zoomModule)) {\n        translate = getZoomTranslate(this.mapObject, this.currentLayer, animate);\n      } else {\n        translate = getTranslate(this.mapObject, this.currentLayer, animate);\n      }\n\n      var scale = this.mapObject.previousScale = translate['scale'];\n      var location_1 = this.mapObject.previousPoint = translate['location'];\n      this.mapObject.baseTranslatePoint = this.mapObject.translatePoint = location_1;\n      this.mapObject.baseScale = this.mapObject.scale = scale;\n\n      for (var i = 0; i < layerElement.childElementCount; i++) {\n        childNode = layerElement.childNodes[i];\n\n        if (!(childNode.id.indexOf('_Markers_Group') > -1) && !(childNode.id.indexOf('_bubble_Group') > -1) && !(childNode.id.indexOf('_dataLableIndex_Group') > -1)) {\n          var transform = 'scale( ' + scale + ' ) ' + 'translate( ' + location_1.x + ' ' + location_1.y + ' ) ';\n          childNode.setAttribute('transform', transform);\n\n          if (duration > 0 && !isNullOrUndefined(this.mapObject.zoomModule)) {\n            if (this.mapObject.zoomSettings.zoomFactor > 1) {\n              translate = getZoomTranslate(this.mapObject, this.currentLayer);\n            } else {\n              translate = getTranslate(this.mapObject, this.currentLayer);\n            }\n\n            this.mapObject.scale = translate['scale'];\n            this.mapObject.zoomTranslatePoint = this.mapObject.translatePoint = translate['location'];\n          }\n        }\n      }\n    } else if (this.mapObject.isTileMap && !isNullOrUndefined(this.mapObject.scale)) {\n      for (var j = 0; j < layerElement.childElementCount; j++) {\n        childNode = layerElement.childNodes[j];\n\n        if (!(childNode.id.indexOf('_Markers_Group') > -1) && !(childNode.id.indexOf('_bubble_Group') > -1) && !(childNode.id.indexOf('_dataLableIndex_Group') > -1) && !(childNode.id.indexOf('_line_Group') > -1)) {\n          var transform = 'scale( ' + this.mapObject.scale + ' ) ' + 'translate( ' + this.mapObject.translatePoint.x + ' ' + this.mapObject.translatePoint.y + ' ) ';\n          childNode.setAttribute('transform', transform);\n        }\n      }\n    }\n  };\n\n  LayerPanel.prototype.calculateRectBounds = function (layerData) {\n    var _this = this;\n\n    Array.prototype.forEach.call(layerData, function (obj, index) {\n      if (!isNullOrUndefined(obj['geometry']) || !isNullOrUndefined(obj['coordinates'])) {\n        var type = !isNullOrUndefined(obj['geometry']) ? obj['geometry']['type'] : obj['type'];\n        var coordinates = !isNullOrUndefined(obj['geometry']) ? obj['geometry']['coordinates'] : obj['coordinates'];\n\n        switch (type.toLowerCase()) {\n          case 'polygon':\n            _this.calculateRectBox(coordinates[0]);\n\n            break;\n\n          case 'multipolygon':\n            coordinates.map(function (point, index) {\n              _this.calculateRectBox(point[0]);\n            });\n            break;\n        }\n      }\n    });\n  };\n\n  LayerPanel.prototype.calculatePolygonBox = function (coordinates, data, properties) {\n    var _this = this;\n\n    var newData = [];\n    var bounds = this.mapObject.baseMapBounds;\n    coordinates.map(function (currentPoint, index) {\n      var latitude = currentPoint[1];\n      var longitude = currentPoint[0];\n\n      if (longitude >= bounds.longitude.min && longitude <= bounds.longitude.max && latitude >= bounds.latitude.min && latitude <= bounds.latitude.max) {\n        var point = convertGeoToPoint(latitude, longitude, _this.currentFactor, _this.currentLayer, _this.mapObject);\n\n        if (isNullOrUndefined(_this.rectBounds)) {\n          _this.rectBounds = {\n            min: {\n              x: point.x,\n              y: point.y\n            },\n            max: {\n              x: point.x,\n              y: point.y\n            }\n          };\n        } else {\n          _this.rectBounds['min']['x'] = Math.min(_this.rectBounds['min']['x'], point.x);\n          _this.rectBounds['min']['y'] = Math.min(_this.rectBounds['min']['y'], point.y);\n          _this.rectBounds['max']['x'] = Math.max(_this.rectBounds['max']['x'], point.x);\n          _this.rectBounds['max']['y'] = Math.max(_this.rectBounds['max']['y'], point.y);\n        }\n\n        newData.push({\n          point: point,\n          lat: latitude,\n          lng: longitude\n        });\n      }\n    });\n    return newData;\n  };\n\n  LayerPanel.prototype.calculateRectBox = function (coordinates) {\n    var _this = this;\n\n    Array.prototype.forEach.call(coordinates, function (currentCoords) {\n      if (isNullOrUndefined(_this.mapObject.baseMapBounds)) {\n        _this.mapObject.baseMapBounds = new GeoLocation({\n          min: currentCoords[1],\n          max: currentCoords[1]\n        }, {\n          min: currentCoords[0],\n          max: currentCoords[0]\n        });\n      } else {\n        _this.mapObject.baseMapBounds.latitude.min = Math.min(_this.mapObject.baseMapBounds.latitude.min, currentCoords[1]);\n        _this.mapObject.baseMapBounds.latitude.max = Math.max(_this.mapObject.baseMapBounds.latitude.max, currentCoords[1]);\n        _this.mapObject.baseMapBounds.longitude.min = Math.min(_this.mapObject.baseMapBounds.longitude.min, currentCoords[0]);\n        _this.mapObject.baseMapBounds.longitude.max = Math.max(_this.mapObject.baseMapBounds.longitude.max, currentCoords[0]);\n      }\n    });\n  };\n\n  LayerPanel.prototype.generateTiles = function (zoomLevel, tileTranslatePoint, zoomType, bing, position) {\n    var userLang = this.mapObject.locale;\n    var size = this.mapObject.availableSize;\n    this.tiles = [];\n    var xcount;\n    var ycount;\n    xcount = ycount = Math.pow(2, zoomLevel);\n    var xLeft = 0;\n    var xRight = 0;\n\n    if (tileTranslatePoint.x + xcount * 256 < size.width) {\n      xLeft = tileTranslatePoint.x > 0 ? Math.ceil(tileTranslatePoint.x / 256) : 0;\n      xRight = tileTranslatePoint.x + xcount * 256 < size.width ? Math.ceil((size.width - (tileTranslatePoint.x + xcount * 256)) / 256) : 0;\n    }\n\n    xcount += xLeft + xRight;\n\n    if (zoomType === 'Pan') {\n      xcount = this.horizontalPanXCount >= xcount ? this.horizontalPanXCount : xcount;\n      this.horizontalPan = false;\n    } else {\n      this.horizontalPanXCount = xcount;\n      this.horizontalPan = true;\n    }\n\n    var baseLayer = this.mapObject.layers[this.mapObject.baseLayerIndex];\n    this.urlTemplate = baseLayer.urlTemplate;\n    var endY = Math.min(ycount, (-tileTranslatePoint.y + size.height) / 256 + 1);\n    var endX = Math.min(xcount, (-tileTranslatePoint.x + size.width + xRight * 256) / 256 + 1);\n    var startX = -(tileTranslatePoint.x + xLeft * 256 + 256) / 256;\n    var startY = -(tileTranslatePoint.y + 256) / 256;\n    bing = bing || this.bing || this.mapObject['bingMap'];\n\n    for (var i = Math.round(startX); i < Math.round(endX); i++) {\n      for (var j = Math.round(startY); j < Math.round(endY); j++) {\n        var x = 256 * i + tileTranslatePoint.x;\n        var y = 256 * j + tileTranslatePoint.y;\n\n        if (x > -256 && x <= size.width && y > -256 && y < size.height) {\n          if (j >= 0) {\n            var tileI = i;\n\n            if (i < 0) {\n              tileI = tileI % ycount + ycount;\n            }\n\n            var tile = new Tile(tileI % ycount, j);\n            tile.left = x;\n            tile.top = y;\n\n            if (baseLayer.layerType === 'Bing') {\n              var key = baseLayer.key;\n              tile.src = bing.getBingMap(tile, key, baseLayer.bingMapType, userLang, bing.imageUrl, bing.subDomains);\n            } else {\n              tile.src = this.urlTemplate.replace('level', zoomLevel.toString()).replace('tileX', tile.x.toString()).replace('tileY', tile.y.toString());\n            }\n\n            this.tiles.push(tile);\n          }\n        }\n      }\n    }\n\n    if (!isNullOrUndefined(zoomType)) {\n      if (zoomType.indexOf('wheel') > 1) {\n        this.animateToZoomX = this.mapObject.availableSize.width / 2 - position.x - 10;\n        this.animateToZoomY = -position.y;\n      } else {\n        this.animateToZoomX = -10;\n        this.animateToZoomY = -(this.mapObject.availableSize.height / 2 + 11.5) + 10;\n      }\n    }\n\n    var proxTiles = extend([], this.tiles, [], true);\n\n    for (var _i = 0, _a = this.mapObject.layers; _i < _a.length; _i++) {\n      var layer = _a[_i];\n\n      if (!(layer.type === 'SubLayer' && layer.visible)) {\n        continue;\n      }\n\n      if (layer.layerType === 'OSM' || layer.layerType === 'Bing') {\n        for (var _b = 0, proxTiles_1 = proxTiles; _b < proxTiles_1.length; _b++) {\n          var baseTile = proxTiles_1[_b];\n          var subtile = extend(baseTile, {}, {}, true);\n\n          if (layer.layerType === 'Bing') {\n            subtile.src = bing.getBingMap(subtile, layer.key, layer.bingMapType, userLang, bing.imageUrl, bing.subDomains);\n          } else {\n            subtile.src = layer.urlTemplate.replace('level', zoomLevel.toString()).replace('tileX', baseTile.x.toString()).replace('tileY', baseTile.y.toString());\n          }\n\n          this.tiles.push(subtile);\n        }\n      }\n    }\n\n    this.arrangeTiles(zoomType, this.animateToZoomX, this.animateToZoomY);\n  };\n\n  LayerPanel.prototype.arrangeTiles = function (type, x, y) {\n    var _this = this;\n\n    var element = document.getElementById(this.mapObject.element.id + '_tile_parent');\n    var element1 = document.getElementById(this.mapObject.element.id + '_tiles');\n    var timeOut;\n\n    if (!isNullOrUndefined(type) && type !== 'Pan' && type !== 'Reset' && type.indexOf('ZoomOut') === -1) {\n      this.tileAnimation(type, x, y);\n      timeOut = 250;\n    } else {\n      timeOut = 0;\n    }\n\n    if (this.mapObject.layers[this.mapObject.baseLayerIndex].layerType === 'GoogleStaticMap') {\n      this.renderGoogleMap(this.mapObject.layers[0].key, this.mapObject.staticMapZoom);\n    } else {\n      setTimeout(function () {\n        if (element) {\n          element.style.zIndex = '1';\n        }\n\n        if (element1) {\n          element1.style.zIndex = '0';\n          element1.style.visibility = 'hidden';\n        }\n\n        var animateElement;\n\n        if (!document.getElementById('animated_tiles') && element) {\n          animateElement = createElement('div', {\n            id: _this.mapObject.element.id + '_animated_tiles'\n          });\n          element.appendChild(animateElement);\n        } else {\n          if (type !== 'Pan' && element1 && element) {\n            element1.appendChild(element.children[0]);\n            animateElement = createElement('div', {\n              id: _this.mapObject.element.id + '_animated_tiles'\n            });\n            element.appendChild(animateElement);\n          } else {\n            animateElement = element ? element.children[0] : null;\n          }\n        }\n\n        var id = 0;\n\n        for (var _i = 0, _a = _this.tiles; _i < _a.length; _i++) {\n          var tile = _a[_i];\n          var imgElement = createElement('img');\n          imgElement.setAttribute('src', tile.src);\n          var child = void 0;\n\n          if (document.getElementById('tile_' + id) && type === 'Pan') {\n            removeElement('tile_' + id);\n          }\n\n          child = createElement('div', {\n            id: 'tile_' + id\n          });\n          child.style.position = 'absolute';\n          child.style.left = tile.left + 'px';\n          child.style.top = tile.top + 'px';\n          child.style.height = tile.height + 'px';\n          child.style.width = tile.width + 'px';\n          child.appendChild(imgElement);\n\n          if (animateElement) {\n            animateElement.appendChild(child);\n          }\n\n          id++;\n        } // tslint:disable-next-line:align\n\n      }, timeOut);\n    }\n  };\n  /**\n   * Animation for tile layers and hide the group element until the tile layer rendering\n   */\n\n\n  LayerPanel.prototype.tileAnimation = function (zoomType, translateX, translateY) {\n    var element = document.getElementById(this.mapObject.element.id + '_tile_parent');\n    var element1 = document.getElementById('animated_tiles');\n    var ele = document.getElementById(this.mapObject.element.id + '_tiles');\n    var scaleValue = '2';\n\n    if (zoomType.indexOf('ZoomOut') === 0) {\n      ele.style.zIndex = '1';\n      element.style.zIndex = '0'; // element1 = ele.children[ele.childElementCount - 1] as HTMLElement;\n\n      while (ele.childElementCount >= 1) {\n        ele.removeChild(ele.children[0]);\n      }\n\n      translateX = 0;\n      translateY = 128 - 23;\n      scaleValue = '0.5';\n    } else if (zoomType === 'Reset') {\n      ele.style.zIndex = '1';\n      element.style.zIndex = '0';\n\n      while (!(ele.childElementCount === 1) && !(ele.childElementCount === 0)) {\n        ele.removeChild(ele.children[1]);\n      }\n\n      element1 = ele.children[0];\n      translateX = 0;\n      translateY = 0;\n      scaleValue = '1';\n    }\n\n    if (!isNullOrUndefined(element1)) {\n      element1.style.transition = '250ms';\n      element1.style.transform = 'translate(' + translateX + 'px, ' + translateY + 'px) scale(' + scaleValue + ')';\n    }\n  };\n  /* tslint:disable:no-string-literal */\n\n  /**\n   * Static map rendering\n   * @param apikey\n   * @private\n   */\n\n\n  LayerPanel.prototype.renderGoogleMap = function (apikey, zoom) {\n    var staticMapString;\n    var map = this.mapObject; // zoom = this.mapObject.zoomSettings.shouldZoomInitially ? this.mapObject.markerZoomFactor : zoom;\n\n    zoom = this.mapObject.tileZoomLevel;\n    var x;\n    var y;\n    var totalSize = Math.pow(2, zoom) * 256;\n    x = map.mapAreaRect.width / 2 - totalSize / 2;\n    y = map.mapAreaRect.height / 2 - totalSize / 2;\n    var centerPoint = new Point(null, null);\n    var diffX = 0;\n    var diffY = 0;\n    var position = convertTileLatLongToPoint(centerPoint, zoom, {\n      x: x,\n      y: y\n    }, this.isMapCoordinates);\n\n    if (map.zoomModule && map.zoomSettings.enable) {\n      diffX = map.zoomModule.mouseDownLatLong['x'] - map.zoomModule.mouseMoveLatLong['x'];\n      diffY = map.zoomModule.mouseDownLatLong['y'] - map.zoomModule.mouseMoveLatLong['y'];\n    }\n\n    var panLatLng = map.pointToLatLong(position.x - diffX, position.y - diffY);\n    map.centerPosition.latitude = panLatLng['latitude'];\n    map.centerPosition.longitude = panLatLng['longitude'];\n    var mapWidth;\n    var mapHeight;\n\n    if (isNullOrUndefined(parseInt(map.width, 10))) {\n      mapWidth = parseInt(map.width, 10) - 22;\n    } else {\n      mapWidth = Math.round(map.mapAreaRect.width);\n    }\n\n    if (isNullOrUndefined(parseInt(map.height, 10))) {\n      mapHeight = parseInt(map.height, 10) - 22;\n    } else {\n      mapHeight = Math.round(map.mapAreaRect.height);\n    }\n\n    var eleWidth = mapWidth > 640 ? (mapWidth - 640) / 2 : 0;\n    var eleHeight = mapHeight > 640 ? (mapHeight - 640) / 2 : 0;\n    var center;\n    var mapType = map.layers[map.layers.length - 1].staticMapType.toString().toLowerCase();\n\n    if (map.centerPosition.latitude && map.centerPosition.longitude) {\n      center = map.centerPosition.latitude.toString() + ',' + map.centerPosition.longitude.toString();\n    } else {\n      center = '0,0';\n    }\n\n    staticMapString = 'https://maps.googleapis.com/maps/api/staticmap?size=' + mapWidth + 'x' + mapHeight + '&zoom=' + zoom + '&center=' + center + '&maptype=' + mapType + '&key=' + apikey;\n    document.getElementById(this.mapObject.element.id + '_tile_parent').innerHTML = '<div id=\"' + this.mapObject.element.id + '_StaticGoogleMap\"' + 'style=\"position:absolute; left:' + eleWidth + 'px; top:' + eleHeight + 'px\"><img src=\"' + staticMapString + '\"></div>';\n  };\n  /**\n   * To find the tile translate point\n   * @param factorX\n   * @param factorY\n   * @param centerPosition\n   */\n\n\n  LayerPanel.prototype.panTileMap = function (factorX, factorY, centerPosition) {\n    if (this.mapObject.tileZoomLevel <= this.mapObject.tileZoomScale && this.mapObject.initialCheck) {\n      this.mapObject.tileZoomLevel = this.mapObject.tileZoomScale;\n    }\n\n    var level = this.mapObject.tileZoomLevel;\n    var padding = this.mapObject.layers[this.mapObject.layers.length - 1].layerType !== 'GoogleStaticMap' ? 20 : 0;\n    var x;\n    var y;\n    var totalSize = Math.pow(2, level) * 256;\n    x = factorX / 2 - totalSize / 2;\n    y = factorY / 2 - totalSize / 2;\n    var position = convertTileLatLongToPoint(centerPosition, level, {\n      x: x,\n      y: y\n    }, this.isMapCoordinates);\n    padding = this.mapObject.zoomNotApplied ? 0 : padding;\n    x -= position.x - factorX / 2;\n    y = y - (position.y - factorY / 2) + padding;\n    this.mapObject.scale = Math.pow(2, level - 1);\n\n    if (isNullOrUndefined(this.mapObject.tileTranslatePoint) || this.mapObject.tileTranslatePoint.y === 0 && this.mapObject.tileTranslatePoint.x === 0 || isNullOrUndefined(this.mapObject.previousTileWidth) || isNullOrUndefined(this.mapObject.previousTileHeight)) {\n      this.mapObject.previousTileWidth = factorX;\n      this.mapObject.previousTileHeight = factorY;\n    }\n\n    if (!isNullOrUndefined(this.mapObject.tileTranslatePoint) && isNullOrUndefined(centerPosition.x) && (this.mapObject.zoomSettings.zoomFactor === 1 || this.mapObject.zoomSettings.zoomFactor !== level || !this.mapObject.defaultState)) {\n      if (factorX !== this.mapObject.previousTileWidth || factorY !== this.mapObject.previousTileHeight) {\n        var xdiff = x - (this.mapObject.previousTileWidth / 2 - totalSize / 2);\n        var ydiff = y - (this.mapObject.previousTileHeight / 2 - totalSize / 2 + padding);\n        this.mapObject.tileTranslatePoint.x = this.mapObject.tileTranslatePoint.x + xdiff;\n        this.mapObject.tileTranslatePoint.y = this.mapObject.tileTranslatePoint.y + ydiff;\n      }\n    }\n\n    if (!isNullOrUndefined(this.mapObject.tileTranslatePoint) && !this.mapObject.zoomNotApplied) {\n      if (this.mapObject.tileTranslatePoint.x !== 0 && this.mapObject.tileTranslatePoint.x !== x && !this.mapObject.centerPositionChanged) {\n        x = this.mapObject.tileTranslatePoint.x;\n      }\n\n      if (this.mapObject.tileTranslatePoint.y !== 0 && this.mapObject.tileTranslatePoint.y !== y && !this.mapObject.centerPositionChanged) {\n        y = this.mapObject.tileTranslatePoint.y;\n      }\n    }\n\n    this.mapObject.translatePoint = new Point((x - 0.01 * this.mapObject.scale) / this.mapObject.scale, (y - 0.01 * this.mapObject.scale) / this.mapObject.scale);\n    this.mapObject.previousTileWidth = factorX;\n    this.mapObject.previousTileHeight = factorY;\n    return new Point(x, y);\n  };\n\n  return LayerPanel;\n}();\n\nexport { LayerPanel };","map":{"version":3,"sources":["/Users/kristalduran/Desktop/PC3-/PC3 Mapa/pc3-mapa/node_modules/@syncfusion/ej2-maps/src/maps/layers/layer-panel.js"],"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","isNullOrUndefined","extend","createElement","Ajax","getShapeColor","GeoLocation","isCustomPath","convertGeoToPoint","Point","PathOption","Size","PolylineOption","removeElement","getElementByID","maintainSelection","getValueFromObject","RectOption","getTranslate","convertTileLatLongToPoint","checkShapeDataFields","CircleOption","getZoomTranslate","fixInitialScaleForTile","Tile","BingMap","ColorMapping","layerRendering","shapeRendering","LayerPanel","map","isMapCoordinates","horizontalPan","horizontalPanXCount","mapObject","ajaxModule","ajaxResponse","measureLayerPanel","_this","layerCollection","layersCollection","areaRect","mapAreaRect","secondaryEle","element","id","isTileMap","tileSvgObject","renderer","createSvg","width","height","parentElement","styles","appendChild","layerGroup","createGroup","layers","baseLayerIndex","layerType","staticMapSize","clipRectElement","drawClipPath","color","x","y","baseMapBounds","baseMapRectBounds","baseSize","Array","forEach","layer","index","currentLayer","processLayers","renderTileLayer","panel","layerIndex","bing","currentFactor","calculateFactor","defaultState","zoomSettings","zoomFactor","tileZoomLevel","previousCenterLatitude","previousCenterLongitude","centerPosition","latitude","longitude","centerPositionChanged","center","centerTileMap","markerModule","enable","calculateZoomCenterPositionAndFactor","markerCenterLatitude","markerCenterLongitude","shouldZoomInitially","zoomPersistence","markerZoomedState","markerZoomCenterPoint","zoomFactorValue","markerZoomFactor","enablePersistence","mapScaleValue","previousZoomFactor","isReset","tileTranslatePoint","tileZoomScale","initialCheck","centerLatOfGivenLocation","centerLongOfGivenLocation","zoomNotApplied","scaleOfGivenLocation","panTileMap","availableSize","resetToInitial","applyZoomReset","initialZoomLevel","Math","floor","padding","totalSize","pow","initialTileTranslate","generateTiles","navigationLineModule","layerObject","renderNavigation","markerRender","translateLayerElements","itemName","getModuleName","navigator","userAgent","window","localStorage","getItem","removeItem","eventArgs","cancel","name","maps","visible","isBlazor","layer_1","blazorEventArgs","trigger","observedArgs","key","proxy_1","bing_1","bingType","bingMapType","url","ajax","onSuccess","json","jsonObject","JSON","parse","resource","imageUrl","subDomains","maxZoom","undefined","arrangeTemplate","send","shapeData","featureData","layerData","bbox","isBaseLayer","min","max","calculateRectBounds","calculatePathCollection","svgObject","bubbleCalculation","bubbleSettings","range","dataSource","bubbleDataSource","bubbledata","valuePath","Number","parseFloat","renderData","groupElements","rectBounds","shapeSettings","geometryData","type","coords","data","properties","generatePoints","colors","palette","theme","labelTemplateEle","className","_loop_1","k","currentShapeData","this_1","pathOptions","polyLineOptions","circleOptions","groupElement","drawObject","path","points","getShapeColor_1","fill","autofill","opacity","colorValuePath","shapeDataPath","shapePropertyPath","colorMapping","shapeID","getShapeColorMapping","toString","shape","border","shapeRenderingSuccess","drawingType","transform","push","i_1","ele","pathEle","generateMultiPolygonPath","dashArray","drawPath","lineData","drawPolyline","pointData","circleRadius","drawCircle","property","j","setAttribute","tabIndex","selectedElementId","shapeSelectionClass","toggledShapeElementId","styleProperty","legendSettings","toggleLegendSettings","applyShapeSettings","layerFeatures","bind","bubbleG","bubbleModule","length_1","bubble_1","_loop_2","this_2","bubbleData","renderBubble","group","style","dataLabelModule","dataLabelSettings","intersect_1","renderLabel","shapeIndex","intersect","bubbleIndex","dataIndex","coordinates","newData","toLowerCase","calculatePolygonBox","multiPolygonDatas","point","lat","lng","arrayCollections_1","horFactor","verFactor","divide","exp","bounds","mapSize","mapHeight","mapWidth","start","end","abs","split","layerElement","childNode","translateType","duration","animationDuration","animate","zoomModule","baseTranslatePoint","zoomTranslatePoint","translate","scale","previousScale","location_1","previousPoint","translatePoint","baseScale","childElementCount","childNodes","obj","calculateRectBox","currentPoint","currentCoords","zoomLevel","zoomType","position","userLang","locale","size","tiles","xcount","ycount","xLeft","xRight","ceil","baseLayer","urlTemplate","endY","endX","startX","startY","round","tileI","tile","left","top","src","getBingMap","replace","animateToZoomX","animateToZoomY","proxTiles","_i","_a","_b","proxTiles_1","baseTile","subtile","arrangeTiles","document","getElementById","element1","timeOut","tileAnimation","renderGoogleMap","staticMapZoom","setTimeout","zIndex","visibility","animateElement","children","imgElement","child","translateX","translateY","scaleValue","removeChild","transition","apikey","zoom","staticMapString","centerPoint","diffX","diffY","mouseDownLatLong","mouseMoveLatLong","panLatLng","pointToLatLong","parseInt","eleWidth","eleHeight","mapType","staticMapType","innerHTML","factorX","factorY","level","previousTileWidth","previousTileHeight","xdiff","ydiff"],"mappings":"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","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n            t[p[i]] = s[p[i]];\n    return t;\n};\nimport { isNullOrUndefined, extend, createElement, Ajax } from '@syncfusion/ej2-base';\nimport { getShapeColor } from '../model/theme';\nimport { GeoLocation, isCustomPath, convertGeoToPoint, Point, PathOption, Size, PolylineOption, removeElement } from '../utils/helper';\nimport { getElementByID, maintainSelection, getValueFromObject } from '../utils/helper';\nimport { RectOption, getTranslate, convertTileLatLongToPoint, checkShapeDataFields, CircleOption } from '../utils/helper';\nimport { getZoomTranslate, fixInitialScaleForTile } from '../utils/helper';\nimport { Tile } from '../model/base';\nimport { BingMap } from './bing-map';\nimport { ColorMapping } from './color-mapping';\nimport { layerRendering, shapeRendering } from '../index';\n/**\n * To calculate and render the shape layer\n */\nvar LayerPanel = /** @class */ (function () {\n    function LayerPanel(map) {\n        this.isMapCoordinates = true;\n        this.horizontalPan = false;\n        this.horizontalPanXCount = 0;\n        this.mapObject = map;\n        this.ajaxModule = new Ajax();\n        this.ajaxResponse = [];\n    }\n    /* tslint:disable:no-string-literal */\n    LayerPanel.prototype.measureLayerPanel = function () {\n        var _this = this;\n        var layerCollection = this.mapObject.layersCollection;\n        var areaRect = this.mapObject.mapAreaRect;\n        var secondaryEle = getElementByID(this.mapObject.element.id + '_Secondary_Element');\n        if (this.mapObject.isTileMap && secondaryEle) {\n            this.tileSvgObject = this.mapObject.renderer.createSvg({\n                id: this.mapObject.element.id + '_Tile_SVG', width: areaRect.width,\n                height: areaRect.height,\n            });\n            var parentElement = createElement('div', {\n                id: this.mapObject.element.id + '_Tile_SVG_Parent', styles: 'position: absolute; height: ' +\n                    (areaRect.height) + 'px; width: '\n                    + (areaRect.width) + 'px;'\n            });\n            parentElement.appendChild(this.tileSvgObject);\n            secondaryEle.appendChild(parentElement);\n        }\n        this.layerGroup = (this.mapObject.renderer.createGroup({\n            id: this.mapObject.element.id + '_Layer_Collections',\n            'clip-path': 'url(#' + this.mapObject.element.id + '_MapArea_ClipRect)'\n        }));\n        if (this.mapObject.layers[this.mapObject.baseLayerIndex].layerType === 'GoogleStaticMap') {\n            var staticMapSize = 640;\n            this.clipRectElement = this.mapObject.renderer.drawClipPath(new RectOption(this.mapObject.element.id + '_MapArea_ClipRect', 'transparent', { width: 1, color: 'Gray' }, 1, {\n                x: ((areaRect.width - staticMapSize) / 2), y: 0,\n                width: staticMapSize, height: areaRect.height\n            }));\n        }\n        else {\n            this.clipRectElement = this.mapObject.renderer.drawClipPath(new RectOption(this.mapObject.element.id + '_MapArea_ClipRect', 'transparent', { width: 1, color: 'Gray' }, 1, {\n                x: this.mapObject.isTileMap ? 0 : areaRect.x, y: this.mapObject.isTileMap ? 0 : areaRect.y,\n                width: areaRect.width, height: (areaRect.height < 0) ? 0 : areaRect.height\n            }));\n        }\n        this.layerGroup.appendChild(this.clipRectElement);\n        this.mapObject.baseMapBounds = null;\n        this.mapObject.baseMapRectBounds = null;\n        this.mapObject.baseSize = null;\n        Array.prototype.forEach.call(layerCollection, function (layer, index) {\n            _this.currentLayer = layer;\n            _this.processLayers(layer, index);\n        });\n    };\n    /**\n     * Tile rendering\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    LayerPanel.prototype.renderTileLayer = function (panel, layer, layerIndex, bing) {\n        panel.currentFactor = panel.calculateFactor(layer);\n        panel.mapObject.defaultState = ((panel.mapObject.zoomSettings.zoomFactor !== 1) &&\n            (!isNullOrUndefined(panel.mapObject.tileZoomLevel) && panel.mapObject.tileZoomLevel !== 1)) ?\n            false : true;\n        if (isNullOrUndefined(panel.mapObject.previousCenterLatitude) &&\n            isNullOrUndefined(panel.mapObject.previousCenterLongitude)) {\n            panel.mapObject.previousCenterLatitude = panel.mapObject.centerPosition.latitude;\n            panel.mapObject.previousCenterLongitude = panel.mapObject.centerPosition.longitude;\n        }\n        else if (panel.mapObject.previousCenterLatitude !==\n            panel.mapObject.centerPosition.latitude && panel.mapObject.previousCenterLongitude !==\n            panel.mapObject.centerPosition.longitude) {\n            panel.mapObject.centerPositionChanged = true;\n            panel.mapObject.previousCenterLatitude = panel.mapObject.centerPosition.latitude;\n            panel.mapObject.previousCenterLongitude = panel.mapObject.centerPosition.longitude;\n        }\n        else {\n            panel.mapObject.centerPositionChanged = false;\n        }\n        var center = new Point(panel.mapObject.centerPosition.longitude, panel.mapObject.centerPosition.latitude);\n        var centerTileMap = center;\n        if ((this.mapObject.isTileMap && panel.mapObject.markerModule) && panel.mapObject.zoomSettings.enable) {\n            panel.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);\n            if (!isNullOrUndefined(this.mapObject.markerCenterLatitude) && !isNullOrUndefined(this.mapObject.markerCenterLongitude)) {\n                centerTileMap = new Point(panel.mapObject.markerCenterLongitude, panel.mapObject.markerCenterLatitude);\n            }\n        }\n        if (!panel.mapObject.zoomSettings.shouldZoomInitially && panel.mapObject.centerPosition.longitude\n            && panel.mapObject.centerPosition.latitude && !panel.mapObject.zoomPersistence && panel.mapObject.defaultState) {\n            center = new Point(panel.mapObject.centerPosition.longitude, panel.mapObject.centerPosition.latitude);\n        }\n        else if (panel.mapObject.zoomSettings.shouldZoomInitially\n            && panel.mapObject.markerZoomedState && !panel.mapObject.zoomPersistence\n            && !isNullOrUndefined(panel.mapObject.markerZoomCenterPoint)) {\n            center = new Point(panel.mapObject.markerZoomCenterPoint.longitude, panel.mapObject.markerZoomCenterPoint.latitude);\n        }\n        else {\n            center = { x: null, y: null };\n        }\n        var zoomFactorValue = panel.mapObject.zoomSettings.shouldZoomInitially ?\n            isNullOrUndefined(panel.mapObject.markerZoomFactor) ? 1 :\n                panel.mapObject.markerZoomFactor : panel.mapObject.zoomSettings.zoomFactor;\n        zoomFactorValue = (panel.mapObject.enablePersistence) ? ((isNullOrUndefined(panel.mapObject.mapScaleValue))\n            ? (isNullOrUndefined(panel.mapObject.markerZoomFactor) ? panel.mapObject.zoomSettings.zoomFactor :\n                panel.mapObject.markerZoomFactor) : panel.mapObject.mapScaleValue) : zoomFactorValue;\n        zoomFactorValue = panel.mapObject.zoomSettings.enable ? zoomFactorValue : panel.mapObject.zoomSettings.zoomFactor;\n        if (isNullOrUndefined(panel.mapObject.tileZoomLevel)) {\n            panel.mapObject.tileZoomLevel = zoomFactorValue;\n            panel.mapObject.previousZoomFactor = zoomFactorValue;\n        }\n        else if (this.mapObject.isReset && panel.mapObject.tileZoomLevel === 1 && !panel.mapObject.zoomSettings.shouldZoomInitially) {\n            panel.mapObject.tileZoomLevel = panel.mapObject.tileZoomLevel;\n        }\n        else if (panel.mapObject.zoomSettings.zoomFactor !== 1 || panel.mapObject.zoomSettings.shouldZoomInitially) {\n            panel.mapObject.tileZoomLevel = panel.mapObject.defaultState && panel.mapObject.zoomSettings.enable ?\n                panel.mapObject.tileZoomLevel : !panel.mapObject.zoomSettings.shouldZoomInitially\n                && !panel.mapObject.centerPositionChanged ?\n                panel.mapObject.previousZoomFactor !== panel.mapObject.zoomSettings.zoomFactor ?\n                    panel.mapObject.zoomSettings.zoomFactor : panel.mapObject.tileZoomLevel : zoomFactorValue;\n            if (!isNullOrUndefined(panel.mapObject.tileTranslatePoint) &&\n                (panel.mapObject.markerZoomFactor !== panel.mapObject.mapScaleValue\n                    || (isNullOrUndefined(panel.mapObject.markerZoomFactor)\n                        && isNullOrUndefined(panel.mapObject.mapScaleValue)))\n                && (panel.mapObject.zoomSettings.zoomFactor <= 1 || panel.mapObject.previousZoomFactor !==\n                    panel.mapObject.zoomSettings.zoomFactor)) {\n                panel.mapObject.tileTranslatePoint.x = 0;\n                panel.mapObject.tileTranslatePoint.y = 0;\n            }\n        }\n        if (zoomFactorValue <= 1 && !isNullOrUndefined(panel.mapObject.height) && !panel.mapObject.zoomSettings.shouldZoomInitially\n            && (panel.mapObject.tileZoomLevel === panel.mapObject.tileZoomScale) && this.mapObject.initialCheck) {\n            fixInitialScaleForTile(this.mapObject);\n        }\n        if (!isNullOrUndefined(panel.mapObject.centerLatOfGivenLocation) && !isNullOrUndefined(panel.mapObject.centerLongOfGivenLocation) &&\n            panel.mapObject.zoomNotApplied) {\n            centerTileMap.y = panel.mapObject.centerLatOfGivenLocation;\n            centerTileMap.x = panel.mapObject.centerLongOfGivenLocation;\n            panel.mapObject.tileZoomLevel = panel.mapObject.mapScaleValue = panel.mapObject.scaleOfGivenLocation;\n        }\n        panel.mapObject.tileTranslatePoint = panel.panTileMap(panel.mapObject.availableSize.width, panel.mapObject.availableSize.height, centerTileMap);\n        if (this.mapObject.zoomSettings.resetToInitial && this.mapObject.initialCheck && !isNullOrUndefined(panel.mapObject.height)\n            && this.mapObject.availableSize.height > 512) {\n            this.mapObject.applyZoomReset = true;\n            this.mapObject.initialZoomLevel = Math.floor(this.mapObject.availableSize.height / 512) + 1;\n            var padding = this.mapObject.layers[this.mapObject.baseLayerIndex].layerType !== 'GoogleStaticMap' ?\n                20 : 0;\n            var totalSize = Math.pow(2, this.mapObject.initialZoomLevel) * 256;\n            this.mapObject.initialTileTranslate.x = (this.mapObject.availableSize.width / 2) - (totalSize / 2);\n            this.mapObject.initialTileTranslate.y = (this.mapObject.availableSize.height / 2) - (totalSize / 2) + padding;\n        }\n        panel.generateTiles(panel.mapObject.tileZoomLevel, panel.mapObject.tileTranslatePoint, null, bing);\n        if (!isNullOrUndefined(panel.mapObject.previousZoomFactor)\n            && panel.mapObject.previousZoomFactor !== panel.mapObject.zoomSettings.zoomFactor) {\n            panel.mapObject.previousZoomFactor = panel.mapObject.zoomSettings.zoomFactor;\n        }\n        if (panel.mapObject.navigationLineModule) {\n            panel.layerObject.appendChild(panel.mapObject.navigationLineModule.renderNavigation(panel.currentLayer, panel.mapObject.tileZoomLevel, layerIndex));\n        }\n        if (panel.mapObject.markerModule) {\n            panel.mapObject.markerModule.markerRender(panel.layerObject, layerIndex, panel.mapObject.tileZoomLevel, null);\n        }\n        panel.translateLayerElements(panel.layerObject, layerIndex);\n        panel.layerGroup.appendChild(panel.layerObject);\n    };\n    LayerPanel.prototype.processLayers = function (layer, layerIndex) {\n        var _this = this;\n        this.layerObject = (this.mapObject.renderer.createGroup({\n            id: this.mapObject.element.id + '_LayerIndex_' + layerIndex\n        }));\n        if (!this.mapObject.enablePersistence) {\n            var itemName = this.mapObject.getModuleName() + this.mapObject.element.id;\n            if (navigator.userAgent.indexOf('Edge') === -1) {\n                if (!isNullOrUndefined(window.localStorage) && window.localStorage.getItem(itemName)) {\n                    window.localStorage.removeItem(itemName);\n                }\n            }\n        }\n        var eventArgs = {\n            cancel: false, name: layerRendering, index: layerIndex,\n            layer: layer, maps: this.mapObject, visible: layer.visible\n        };\n        if (this.mapObject.isBlazor) {\n            var maps = eventArgs.maps, layer_1 = eventArgs.layer, blazorEventArgs = __rest(eventArgs, [\"maps\", \"layer\"]);\n            eventArgs = blazorEventArgs;\n        }\n        this.mapObject.trigger('layerRendering', eventArgs, function (observedArgs) {\n            if (!eventArgs.cancel && eventArgs.visible) {\n                if (layer.layerType !== 'Geometry') {\n                    if (layer.layerType !== 'Bing' || _this.bing) {\n                        _this.renderTileLayer(_this, layer, layerIndex);\n                    }\n                    else if (layer.key && layer.key.length > 1) {\n                        var proxy_1 = _this;\n                        var bing_1 = new BingMap(_this.mapObject);\n                        var bingType = layer.bingMapType === 'AerialWithLabel' ? 'AerialWithLabelsOnDemand' : layer.bingMapType;\n                        var url = 'https://dev.virtualearth.net/REST/V1/Imagery/Metadata/' + bingType;\n                        var ajax = new Ajax({\n                            url: url + '?output=json&include=ImageryProviders&urischeme=https&key=' + layer.key\n                        });\n                        ajax.onSuccess = function (json) {\n                            var jsonObject = JSON.parse(json);\n                            var resource = jsonObject['resourceSets'][0]['resources'][0];\n                            var imageUrl = resource['imageUrl'];\n                            var subDomains = resource['imageUrlSubdomains'];\n                            var maxZoom = resource['zoomMax'];\n                            if (imageUrl !== null && imageUrl !== undefined && imageUrl !== bing_1.imageUrl) {\n                                bing_1.imageUrl = imageUrl;\n                            }\n                            if (subDomains !== null && subDomains !== undefined && subDomains !== bing_1.subDomains) {\n                                bing_1.subDomains = subDomains;\n                            }\n                            if (maxZoom !== null && maxZoom !== undefined && maxZoom !== bing_1.maxZoom) {\n                                bing_1.maxZoom = maxZoom;\n                            }\n                            proxy_1.mapObject['bingMap'] = bing_1;\n                            proxy_1.renderTileLayer(proxy_1, layer, layerIndex, bing_1);\n                            _this.mapObject.arrangeTemplate();\n                        };\n                        ajax.send();\n                    }\n                }\n                else {\n                    if (!isNullOrUndefined(layer.shapeData) && (!isNullOrUndefined(layer.shapeData['geometries']) ||\n                        !isNullOrUndefined(layer.shapeData['features']))) {\n                        var featureData = (!isNullOrUndefined(layer.shapeData['geometries']) &&\n                            layer.shapeData['geometries'].length > 0 ? layer.shapeData['geometries'] :\n                            layer.shapeData['features']);\n                        layer.layerData = [];\n                        var bbox = layer.shapeData['bbox'];\n                        if (!isNullOrUndefined(bbox) && layer.isBaseLayer) {\n                            _this.mapObject.baseMapBounds = new GeoLocation({ min: bbox[0][1], max: bbox[1][1] }, { min: bbox[0][0], max: bbox[1][0] });\n                        }\n                        else if (isNullOrUndefined(_this.mapObject.baseMapBounds) && !isCustomPath(featureData)) {\n                            _this.calculateRectBounds(featureData);\n                        }\n                        _this.calculatePathCollection(layerIndex, featureData);\n                    }\n                }\n            }\n        });\n        if (!this.mapObject.isTileMap) {\n            this.mapObject.svgObject.appendChild(this.layerGroup);\n        }\n        else if (this.tileSvgObject) {\n            this.tileSvgObject.appendChild(this.layerGroup);\n            this.mapObject.baseMapBounds = null;\n        }\n    };\n    //tslint:disable:max-func-body-length\n    LayerPanel.prototype.bubbleCalculation = function (bubbleSettings, range) {\n        if (bubbleSettings.dataSource != null && bubbleSettings != null) {\n            var bubbleDataSource = bubbleSettings.dataSource;\n            for (var i = 0; i < bubbleDataSource.length; i++) {\n                var bubbledata = (!isNullOrUndefined(bubbleSettings.valuePath)) ? ((bubbleSettings.valuePath.indexOf('.') > -1) ?\n                    Number(getValueFromObject(bubbleSettings.dataSource[i], bubbleSettings.valuePath)) :\n                    parseFloat(bubbleSettings.dataSource[i][bubbleSettings.valuePath])) :\n                    parseFloat(bubbleSettings.dataSource[i][bubbleSettings.valuePath]);\n                if (i !== 0) {\n                    if (bubbledata > range.max) {\n                        range.max = bubbledata;\n                    }\n                    else if (bubbledata < range.min) {\n                        range.min = bubbledata;\n                    }\n                }\n                else {\n                    range.max = range.min = bubbledata;\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    LayerPanel.prototype.calculatePathCollection = function (layerIndex, renderData) {\n        var _this = this;\n        this.groupElements = [];\n        if ((!isCustomPath(renderData))) {\n            this.currentFactor = this.calculateFactor(this.currentLayer);\n        }\n        this.rectBounds = null;\n        var shapeSettings = this.currentLayer.shapeSettings;\n        var bubbleSettings = this.currentLayer.bubbleSettings;\n        Array.prototype.forEach.call(renderData, function (geometryData, index) {\n            if (!isNullOrUndefined(geometryData['geometry']) || !isNullOrUndefined(geometryData['coordinates'])) {\n                var type = !isNullOrUndefined(geometryData['geometry']) ? geometryData['geometry']['type'] : geometryData['type'];\n                var coords = !isNullOrUndefined(geometryData['geometry']) ? geometryData['geometry']['coordinates'] :\n                    geometryData['coordinates'];\n                var data = geometryData['geometry'];\n                var properties = geometryData['properties'];\n                if (type !== 'LineString') {\n                    _this.generatePoints(type, coords, data, properties);\n                }\n            }\n        });\n        this.currentLayer.rectBounds = this.rectBounds;\n        if (isNullOrUndefined(this.mapObject.baseMapRectBounds) && this.currentLayer.isBaseLayer) {\n            this.mapObject.baseMapRectBounds = this.rectBounds;\n        }\n        var colors = shapeSettings.palette.length > 1 ? shapeSettings.palette : getShapeColor(this.mapObject.theme);\n        var labelTemplateEle = createElement('div', {\n            id: this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_Label_Template_Group',\n            className: this.mapObject.element.id + '_template',\n            styles: 'pointer-events: none; overflow: hidden; position: absolute;' +\n                'top:' + this.mapObject.mapAreaRect.y + 'px;' +\n                'left:' + this.mapObject.mapAreaRect.x + 'px;' +\n                'height:' + this.mapObject.mapAreaRect.height + 'px;' +\n                'width:' + this.mapObject.mapAreaRect.width + 'px;'\n        });\n        if (this.currentLayer.layerData.length !== 0) {\n            var _loop_1 = function (i) {\n                var k = void 0;\n                var currentShapeData = this_1.currentLayer.layerData[i];\n                var pathOptions;\n                var polyLineOptions;\n                var circleOptions;\n                var groupElement;\n                var drawObject = void 0;\n                var path = '';\n                var points = '';\n                var getShapeColor_1 = void 0;\n                var fill = (shapeSettings.autofill) ? colors[i % colors.length] : shapeSettings.fill;\n                var opacity;\n                if (shapeSettings.colorValuePath !== null && !isNullOrUndefined(currentShapeData['property'])) {\n                    k = checkShapeDataFields(this_1.currentLayer.dataSource, currentShapeData['property'], this_1.currentLayer.shapeDataPath, this_1.currentLayer.shapePropertyPath, this_1.currentLayer);\n                    if (k !== null && shapeSettings.colorMapping.length === 0) {\n                        fill = ((this_1.currentLayer.shapeSettings.colorValuePath.indexOf('.') > -1) ?\n                            (getValueFromObject(this_1.currentLayer.dataSource[k], shapeSettings.colorValuePath)) :\n                            this_1.currentLayer.dataSource[k][shapeSettings.colorValuePath]);\n                    }\n                    else if (currentShapeData['property'][shapeSettings.colorValuePath] &&\n                        this_1.currentLayer.dataSource.length === 0 && shapeSettings.colorMapping.length === 0) {\n                        fill = ((this_1.currentLayer.shapeSettings.colorValuePath.indexOf('.') > -1) ?\n                            (getValueFromObject(currentShapeData['property'], shapeSettings.colorValuePath)) :\n                            currentShapeData['property'][shapeSettings.colorValuePath]);\n                    }\n                    fill = !isNullOrUndefined(fill) ? fill : shapeSettings.fill;\n                }\n                var shapeID = this_1.mapObject.element.id + '_LayerIndex_' + layerIndex + '_shapeIndex_' + i + '_dataIndex_' + k;\n                getShapeColor_1 = this_1.getShapeColorMapping(this_1.currentLayer, currentShapeData['property'], fill);\n                fill = Object.prototype.toString.call(getShapeColor_1) === '[object Object]' && !isNullOrUndefined(getShapeColor_1['fill'])\n                    ? getShapeColor_1['fill'] : fill;\n                opacity = (Object.prototype.toString.call(getShapeColor_1) === '[object Object]'\n                    && !isNullOrUndefined(getShapeColor_1['opacity'])) ? getShapeColor_1['opacity'] : shapeSettings.opacity;\n                var eventArgs = {\n                    cancel: false, name: shapeRendering, index: i,\n                    data: this_1.currentLayer.dataSource ? this_1.currentLayer.dataSource[k] : null,\n                    maps: this_1.mapObject,\n                    shape: shapeSettings, fill: fill,\n                    border: { width: shapeSettings.border.width, color: shapeSettings.border.color }\n                };\n                if (this_1.mapObject.isBlazor) {\n                    var maps = eventArgs.maps, blazorEventArgs = __rest(eventArgs, [\"maps\"]);\n                    eventArgs = blazorEventArgs;\n                }\n                // tslint:disable-next-line:max-func-body-length\n                var shapeRenderingSuccess = function (eventArgs) {\n                    var drawingType = !isNullOrUndefined(currentShapeData['_isMultiPolygon'])\n                        ? 'MultiPolygon' : isNullOrUndefined(currentShapeData['type']) ? currentShapeData[0]['type'] : currentShapeData['type'];\n                    drawingType = (drawingType === 'Polygon' || drawingType === 'MultiPolygon') ? 'Polygon' : drawingType;\n                    if (!eventArgs.cancel) {\n                        eventArgs.fill = eventArgs.fill === '#A6A6A6' ? eventArgs.shape.fill : eventArgs.fill;\n                        eventArgs.border.color = eventArgs.border.color === '#000000' ? eventArgs.shape.border.color\n                            : eventArgs.border.color;\n                        eventArgs.border.width = eventArgs.border.width === 0 ? eventArgs.shape.border.width : eventArgs.border.width;\n                        _this.mapObject.layers[layerIndex].shapeSettings.border = eventArgs.border;\n                    }\n                    else {\n                        eventArgs.fill = fill;\n                        eventArgs.border.color = shapeSettings.border.color;\n                        eventArgs.border.width = shapeSettings.border.width;\n                        _this.mapObject.layers[layerIndex].shapeSettings.border = shapeSettings.border;\n                    }\n                    if (_this.groupElements.length < 1) {\n                        groupElement = _this.mapObject.renderer.createGroup({\n                            id: _this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_' + drawingType + '_Group', transform: ''\n                        });\n                        _this.groupElements.push(groupElement);\n                    }\n                    else {\n                        for (var i_1 = 0; i_1 < _this.groupElements.length; i_1++) {\n                            var ele = _this.groupElements[i_1];\n                            if (ele.id.indexOf(drawingType) > -1) {\n                                groupElement = ele;\n                                break;\n                            }\n                            else if (i_1 >= _this.groupElements.length - 1) {\n                                groupElement = _this.mapObject.renderer.createGroup({\n                                    id: _this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_' + drawingType + '_Group'\n                                });\n                                _this.groupElements.push(groupElement);\n                                break;\n                            }\n                        }\n                    }\n                    var pathEle;\n                    switch (drawingType) {\n                        case 'Polygon':\n                            if (!currentShapeData['_isMultiPolygon']) {\n                                path += 'M' + (currentShapeData[0]['point']['x']) + ' ' + (currentShapeData[0]['point']['y']);\n                                currentShapeData.map(function (shapeData) {\n                                    path += ' L ' + (shapeData['point']['x']) + ' ' + (shapeData['point']['y']);\n                                });\n                            }\n                            else {\n                                path = _this.generateMultiPolygonPath(currentShapeData);\n                            }\n                            path += ' z ';\n                            if (path.length > 3) {\n                                pathOptions = new PathOption(shapeID, eventArgs.fill, eventArgs.border.width, eventArgs.border.color, opacity, shapeSettings.dashArray, path);\n                                pathEle = _this.mapObject.renderer.drawPath(pathOptions);\n                            }\n                            break;\n                        case 'LineString':\n                            currentShapeData.map(function (lineData) {\n                                points += lineData['point']['x'] + ' , ' + lineData['point']['y'] + ' ';\n                            });\n                            polyLineOptions = new PolylineOption(shapeID, points, eventArgs.fill, eventArgs.border.width, eventArgs.border.color, opacity, shapeSettings.dashArray);\n                            pathEle = _this.mapObject.renderer.drawPolyline(polyLineOptions);\n                            break;\n                        case 'Point':\n                            var pointData = currentShapeData['point'];\n                            circleOptions = new CircleOption(shapeID, eventArgs.fill, eventArgs.border, opacity, pointData['x'], pointData['y'], shapeSettings.circleRadius, null);\n                            pathEle = _this.mapObject.renderer.drawCircle(circleOptions);\n                            break;\n                        case 'Path':\n                            path = currentShapeData['point'];\n                            pathOptions = new PathOption(shapeID, eventArgs.fill, eventArgs.border.width, eventArgs.border.color, opacity, shapeSettings.dashArray, path);\n                            pathEle = _this.mapObject.renderer.drawPath(pathOptions);\n                            break;\n                    }\n                    if (!isNullOrUndefined(pathEle)) {\n                        var property = (Object.prototype.toString.call(_this.currentLayer.shapePropertyPath) === '[object Array]' ?\n                            _this.currentLayer.shapePropertyPath : [_this.currentLayer.shapePropertyPath]);\n                        // tslint:disable-next-line:align\n                        var properties = void 0;\n                        for (var j = 0; j < property.length; j++) {\n                            if (!isNullOrUndefined(currentShapeData['property'])) {\n                                properties = property[j];\n                                break;\n                            }\n                        }\n                        pathEle.setAttribute('aria-label', ((!isNullOrUndefined(currentShapeData['property'])) ?\n                            (currentShapeData['property'][properties]) : ''));\n                        pathEle.setAttribute('tabindex', (_this.mapObject.tabIndex + i + 2).toString());\n                        maintainSelection(_this.mapObject.selectedElementId, _this.mapObject.shapeSelectionClass, pathEle, 'ShapeselectionMapStyle');\n                        if (_this.mapObject.toggledShapeElementId) {\n                            for (var j = 0; j < _this.mapObject.toggledShapeElementId.length; j++) {\n                                var styleProperty = _this.mapObject.legendSettings.toggleLegendSettings.applyShapeSettings ?\n                                    _this.currentLayer.shapeSettings : _this.mapObject.legendSettings.toggleLegendSettings;\n                                if (_this.mapObject.toggledShapeElementId[j] === pathEle.id) {\n                                    pathEle.setAttribute('fill', styleProperty.fill);\n                                    pathEle.setAttribute('stroke', styleProperty.border.color);\n                                    pathEle.setAttribute('opacity', (styleProperty.opacity).toString());\n                                    pathEle.setAttribute('stroke-width', (styleProperty.border.width).toString());\n                                }\n                            }\n                        }\n                        groupElement.appendChild(pathEle);\n                    }\n                    if (i === _this.currentLayer.layerData.length - 1) {\n                        _this.layerFeatures(layerIndex, colors, renderData, labelTemplateEle);\n                    }\n                };\n                shapeRenderingSuccess.bind(this_1);\n                this_1.mapObject.trigger('shapeRendering', eventArgs, shapeRenderingSuccess);\n            };\n            var this_1 = this;\n            for (var i = 0; i < this.currentLayer.layerData.length; i++) {\n                _loop_1(i);\n            }\n        }\n        else {\n            this.layerFeatures(layerIndex, colors, renderData, labelTemplateEle);\n        }\n    };\n    /**\n     *  layer features as bubble, marker, datalabel, navigation line.\n     */\n    LayerPanel.prototype.layerFeatures = function (layerIndex, colors, renderData, labelTemplateEle) {\n        var _this = this;\n        var bubbleG;\n        if (this.currentLayer.bubbleSettings.length && this.mapObject.bubbleModule) {\n            var length_1 = this.currentLayer.bubbleSettings.length;\n            var bubble_1;\n            var _loop_2 = function (j) {\n                bubble_1 = this_2.currentLayer.bubbleSettings[j];\n                bubbleG = this_2.mapObject.renderer.createGroup({\n                    id: this_2.mapObject.element.id + '_LayerIndex_' + layerIndex + '_bubble_Group_' + j\n                });\n                var range = { min: 0, max: 0 };\n                this_2.bubbleCalculation(bubble_1, range);\n                var bubbleDataSource = bubble_1.dataSource;\n                bubbleDataSource.map(function (bubbleData, i) {\n                    _this.renderBubble(_this.currentLayer, bubbleData, colors[i % colors.length], range, j, i, bubbleG, layerIndex, bubble_1);\n                });\n                this_2.groupElements.push(bubbleG);\n            };\n            var this_2 = this;\n            for (var j = 0; j < length_1; j++) {\n                _loop_2(j);\n            }\n        }\n        if ((this.mapObject.markerModule && !this.mapObject.isTileMap) && this.mapObject.zoomSettings.enable) {\n            this.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);\n        }\n        var group = (this.mapObject.renderer.createGroup({\n            id: this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_dataLableIndex_Group',\n            style: 'pointer-events: none;'\n        }));\n        if (this.mapObject.dataLabelModule && this.currentLayer.dataLabelSettings.visible) {\n            var intersect_1 = [];\n            renderData.map(function (currentShapeData, i) {\n                _this.renderLabel(_this.currentLayer, layerIndex, currentShapeData, group, i, labelTemplateEle, intersect_1);\n            });\n            this.groupElements.push(group);\n        }\n        if (this.mapObject.navigationLineModule) {\n            this.groupElements.push(this.mapObject.navigationLineModule.renderNavigation(this.currentLayer, this.currentFactor, layerIndex));\n        }\n        this.groupElements.map(function (element) {\n            _this.layerObject.appendChild(element);\n        });\n        if (this.mapObject.markerModule) {\n            this.mapObject.markerModule.markerRender(this.layerObject, layerIndex, (this.mapObject.isTileMap ? Math.floor(this.currentFactor)\n                : this.currentFactor), null);\n        }\n        this.translateLayerElements(this.layerObject, layerIndex);\n        this.layerGroup.appendChild(this.layerObject);\n    };\n    /**\n     *  render datalabel\n     */\n    LayerPanel.prototype.renderLabel = function (layer, layerIndex, shape, group, shapeIndex, labelTemplateEle, intersect) {\n        this.mapObject.dataLabelModule.renderLabel(layer, layerIndex, shape, layer.layerData, group, labelTemplateEle, shapeIndex, intersect);\n    };\n    /**\n     * To render path for multipolygon\n     */\n    LayerPanel.prototype.generateMultiPolygonPath = function (currentShapeData) {\n        var path = '';\n        var shape;\n        for (var j = 0; j < currentShapeData.length; j++) {\n            path += 'M' + (currentShapeData[j][0]['point']['x']) + ' ' + (currentShapeData[j][0]['point']['y']);\n            shape = currentShapeData[j];\n            shape.map(function (shapeData) {\n                path += ' L ' + (shapeData['point']['x']) + ' ' + (shapeData['point']['y']);\n            });\n        }\n        return path;\n    };\n    /**\n     * To render bubble\n     */\n    LayerPanel.prototype.renderBubble = function (layer, bubbleData, color, range, bubbleIndex, dataIndex, group, layerIndex, bubbleSettings) {\n        if (isNullOrUndefined(this.mapObject.bubbleModule) || !bubbleSettings.visible) {\n            return null;\n        }\n        color = bubbleSettings.fill ? bubbleSettings.fill : color;\n        this.mapObject.bubbleModule.id = this.mapObject.element.id + '_LayerIndex_' + layerIndex + '_BubbleIndex_' +\n            bubbleIndex + '_dataIndex_' + dataIndex;\n        this.mapObject.bubbleModule.renderBubble(bubbleSettings, bubbleData, color, range, bubbleIndex, dataIndex, layerIndex, layer, group, this.mapObject.bubbleModule.id);\n    };\n    /**\n     * To get the shape color from color mapping module\n     */\n    LayerPanel.prototype.getShapeColorMapping = function (layer, shape, color) {\n        color = color ? color : layer.shapeSettings.fill;\n        if (layer.shapeSettings.colorMapping.length === 0 && isNullOrUndefined(layer.dataSource)) {\n            return color;\n        }\n        var index = checkShapeDataFields(layer.dataSource, shape, layer.shapeDataPath, layer.shapePropertyPath, layer);\n        var colorMapping = new ColorMapping(this.mapObject);\n        if (isNullOrUndefined(layer.dataSource[index])) {\n            return color;\n        }\n        return colorMapping.getShapeColorMapping(layer.shapeSettings, layer.dataSource[index], color);\n    };\n    LayerPanel.prototype.generatePoints = function (type, coordinates, data, properties) {\n        var _this = this;\n        var latitude;\n        var longitude;\n        var newData = [];\n        switch (type.toLowerCase()) {\n            case 'polygon':\n                newData = this.calculatePolygonBox(coordinates[0], data, properties);\n                if (newData.length > 0) {\n                    newData['property'] = properties;\n                    newData['type'] = type;\n                    newData['_isMultiPolygon'] = false;\n                    this.currentLayer.layerData.push(newData);\n                }\n                break;\n            case 'multipolygon':\n                var multiPolygonDatas = [];\n                for (var i = 0; i < coordinates.length; i++) {\n                    newData = this.calculatePolygonBox(coordinates[i][0], data, properties);\n                    if (newData.length > 0) {\n                        multiPolygonDatas.push(newData);\n                    }\n                }\n                multiPolygonDatas['property'] = properties;\n                multiPolygonDatas['type'] = type;\n                multiPolygonDatas['_isMultiPolygon'] = true;\n                this.currentLayer.layerData.push(multiPolygonDatas);\n                break;\n            case 'linestring':\n                coordinates.map(function (points, index) {\n                    latitude = points[1];\n                    longitude = points[0];\n                    var point = convertGeoToPoint(latitude, longitude, _this.currentFactor, _this.currentLayer, _this.mapObject);\n                    newData.push({\n                        point: point, lat: latitude, lng: longitude\n                    });\n                });\n                newData['property'] = properties;\n                newData['type'] = type;\n                this.currentLayer.layerData.push(newData);\n                break;\n            case 'point':\n                var arrayCollections_1 = false;\n                coordinates.map(function (points, index) {\n                    if (Object.prototype.toString.call(points) === '[object Array]') {\n                        latitude = points[1];\n                        longitude = points[0];\n                        arrayCollections_1 = true;\n                        var point = convertGeoToPoint(latitude, longitude, _this.currentFactor, _this.currentLayer, _this.mapObject);\n                        _this.currentLayer.layerData.push({\n                            point: point, type: type, lat: latitude, lng: longitude, property: properties\n                        });\n                    }\n                });\n                if (!arrayCollections_1) {\n                    latitude = coordinates[1];\n                    longitude = coordinates[0];\n                    var point = convertGeoToPoint(latitude, longitude, this.currentFactor, this.currentLayer, this.mapObject);\n                    this.currentLayer.layerData.push({\n                        point: point, type: type, lat: latitude, lng: longitude, property: properties\n                    });\n                }\n                break;\n            case 'path':\n                this.currentLayer.layerData.push({\n                    point: data['d'], type: type, property: properties\n                });\n                break;\n        }\n    };\n    LayerPanel.prototype.calculateFactor = function (layer) {\n        var horFactor;\n        var verFactor = 1;\n        var divide = 10;\n        var exp = 'e+1';\n        var bounds = this.mapObject.baseMapBounds;\n        var mapSize = new Size(this.mapObject.mapAreaRect.width, this.mapObject.mapAreaRect.height - 5);\n        var mapHeight;\n        var mapWidth;\n        if (bounds) {\n            var start = convertGeoToPoint(bounds.latitude.min, bounds.longitude.min, null, layer, this.mapObject);\n            var end = convertGeoToPoint(bounds.latitude.max, bounds.longitude.max, null, layer, this.mapObject);\n            mapHeight = end.y - start.y;\n            mapWidth = end.x - start.x;\n        }\n        else {\n            mapHeight = mapWidth = 500;\n        }\n        if (mapHeight < mapSize.height) {\n            horFactor = parseFloat(Math.abs(Number(mapSize.height / Number(mapHeight.toString() + exp)) * 100).toString().split('.')[0])\n                / divide;\n        }\n        else {\n            horFactor = mapSize.height / mapHeight;\n        }\n        if (mapWidth < mapSize.width) {\n            verFactor = parseFloat(Math.abs(Number(mapSize.width / Number(mapWidth.toString() + exp)) * 100).toString().split('.')[0])\n                / divide;\n        }\n        else {\n            verFactor = mapSize.width / mapWidth;\n        }\n        return (Math.min(verFactor, horFactor));\n    };\n    LayerPanel.prototype.translateLayerElements = function (layerElement, index) {\n        var childNode;\n        this.mapObject.translateType = 'layer';\n        if (!isNullOrUndefined(this.mapObject.baseMapRectBounds)) {\n            var duration = this.currentLayer.animationDuration;\n            var animate = duration !== 0 || isNullOrUndefined(this.mapObject.zoomModule);\n            this.mapObject.baseTranslatePoint = this.mapObject.zoomTranslatePoint;\n            var translate = void 0;\n            if (this.mapObject.zoomSettings.zoomFactor > 1 && !isNullOrUndefined(this.mapObject.zoomModule)) {\n                translate = getZoomTranslate(this.mapObject, this.currentLayer, animate);\n            }\n            else {\n                translate = getTranslate(this.mapObject, this.currentLayer, animate);\n            }\n            var scale = this.mapObject.previousScale = translate['scale'];\n            var location_1 = this.mapObject.previousPoint = translate['location'];\n            this.mapObject.baseTranslatePoint = this.mapObject.translatePoint = location_1;\n            this.mapObject.baseScale = this.mapObject.scale = scale;\n            for (var i = 0; i < layerElement.childElementCount; i++) {\n                childNode = layerElement.childNodes[i];\n                if (!(childNode.id.indexOf('_Markers_Group') > -1) &&\n                    (!(childNode.id.indexOf('_bubble_Group') > -1)) &&\n                    (!(childNode.id.indexOf('_dataLableIndex_Group') > -1))) {\n                    var transform = 'scale( ' + scale + ' ) '\n                        + 'translate( ' + location_1.x + ' ' + location_1.y + ' ) ';\n                    childNode.setAttribute('transform', transform);\n                    if (duration > 0 && !isNullOrUndefined(this.mapObject.zoomModule)) {\n                        if (this.mapObject.zoomSettings.zoomFactor > 1) {\n                            translate = getZoomTranslate(this.mapObject, this.currentLayer);\n                        }\n                        else {\n                            translate = getTranslate(this.mapObject, this.currentLayer);\n                        }\n                        this.mapObject.scale = translate['scale'];\n                        this.mapObject.zoomTranslatePoint = this.mapObject.translatePoint = translate['location'];\n                    }\n                }\n            }\n        }\n        else if (this.mapObject.isTileMap && !isNullOrUndefined(this.mapObject.scale)) {\n            for (var j = 0; j < layerElement.childElementCount; j++) {\n                childNode = layerElement.childNodes[j];\n                if (!(childNode.id.indexOf('_Markers_Group') > -1) &&\n                    (!(childNode.id.indexOf('_bubble_Group') > -1)) &&\n                    (!(childNode.id.indexOf('_dataLableIndex_Group') > -1)) &&\n                    (!(childNode.id.indexOf('_line_Group') > -1))) {\n                    var transform = 'scale( ' + this.mapObject.scale + ' ) ' + 'translate( ' + this.mapObject.translatePoint.x\n                        + ' ' + this.mapObject.translatePoint.y + ' ) ';\n                    childNode.setAttribute('transform', transform);\n                }\n            }\n        }\n    };\n    LayerPanel.prototype.calculateRectBounds = function (layerData) {\n        var _this = this;\n        Array.prototype.forEach.call(layerData, function (obj, index) {\n            if (!isNullOrUndefined(obj['geometry']) || !isNullOrUndefined(obj['coordinates'])) {\n                var type = !isNullOrUndefined(obj['geometry']) ? obj['geometry']['type'] : obj['type'];\n                var coordinates = !isNullOrUndefined(obj['geometry']) ? obj['geometry']['coordinates'] : obj['coordinates'];\n                switch (type.toLowerCase()) {\n                    case 'polygon':\n                        _this.calculateRectBox(coordinates[0]);\n                        break;\n                    case 'multipolygon':\n                        coordinates.map(function (point, index) {\n                            _this.calculateRectBox(point[0]);\n                        });\n                        break;\n                }\n            }\n        });\n    };\n    LayerPanel.prototype.calculatePolygonBox = function (coordinates, data, properties) {\n        var _this = this;\n        var newData = [];\n        var bounds = this.mapObject.baseMapBounds;\n        coordinates.map(function (currentPoint, index) {\n            var latitude = currentPoint[1];\n            var longitude = currentPoint[0];\n            if ((longitude >= bounds.longitude.min && longitude <= bounds.longitude.max)\n                && (latitude >= bounds.latitude.min && latitude <= bounds.latitude.max)) {\n                var point = convertGeoToPoint(latitude, longitude, _this.currentFactor, _this.currentLayer, _this.mapObject);\n                if (isNullOrUndefined(_this.rectBounds)) {\n                    _this.rectBounds = { min: { x: point.x, y: point.y }, max: { x: point.x, y: point.y } };\n                }\n                else {\n                    _this.rectBounds['min']['x'] = Math.min(_this.rectBounds['min']['x'], point.x);\n                    _this.rectBounds['min']['y'] = Math.min(_this.rectBounds['min']['y'], point.y);\n                    _this.rectBounds['max']['x'] = Math.max(_this.rectBounds['max']['x'], point.x);\n                    _this.rectBounds['max']['y'] = Math.max(_this.rectBounds['max']['y'], point.y);\n                }\n                newData.push({\n                    point: point,\n                    lat: latitude,\n                    lng: longitude\n                });\n            }\n        });\n        return newData;\n    };\n    LayerPanel.prototype.calculateRectBox = function (coordinates) {\n        var _this = this;\n        Array.prototype.forEach.call(coordinates, function (currentCoords) {\n            if (isNullOrUndefined(_this.mapObject.baseMapBounds)) {\n                _this.mapObject.baseMapBounds = new GeoLocation({ min: currentCoords[1], max: currentCoords[1] }, { min: currentCoords[0], max: currentCoords[0] });\n            }\n            else {\n                _this.mapObject.baseMapBounds.latitude.min = Math.min(_this.mapObject.baseMapBounds.latitude.min, currentCoords[1]);\n                _this.mapObject.baseMapBounds.latitude.max = Math.max(_this.mapObject.baseMapBounds.latitude.max, currentCoords[1]);\n                _this.mapObject.baseMapBounds.longitude.min = Math.min(_this.mapObject.baseMapBounds.longitude.min, currentCoords[0]);\n                _this.mapObject.baseMapBounds.longitude.max = Math.max(_this.mapObject.baseMapBounds.longitude.max, currentCoords[0]);\n            }\n        });\n    };\n    LayerPanel.prototype.generateTiles = function (zoomLevel, tileTranslatePoint, zoomType, bing, position) {\n        var userLang = this.mapObject.locale;\n        var size = this.mapObject.availableSize;\n        this.tiles = [];\n        var xcount;\n        var ycount;\n        xcount = ycount = Math.pow(2, zoomLevel);\n        var xLeft = 0;\n        var xRight = 0;\n        if ((tileTranslatePoint.x + (xcount * 256)) < size.width) {\n            xLeft = tileTranslatePoint.x > 0 ? Math.ceil(tileTranslatePoint.x / 256) : 0;\n            xRight = ((tileTranslatePoint.x + xcount * 256) < size.width) ?\n                Math.ceil((size.width - (tileTranslatePoint.x + xcount * 256)) / 256) : 0;\n        }\n        xcount += xLeft + xRight;\n        if (zoomType === 'Pan') {\n            xcount = (this.horizontalPanXCount >= xcount) ? this.horizontalPanXCount : xcount;\n            this.horizontalPan = false;\n        }\n        else {\n            this.horizontalPanXCount = xcount;\n            this.horizontalPan = true;\n        }\n        var baseLayer = this.mapObject.layers[this.mapObject.baseLayerIndex];\n        this.urlTemplate = baseLayer.urlTemplate;\n        var endY = Math.min(ycount, ((-tileTranslatePoint.y + size.height) / 256) + 1);\n        var endX = Math.min(xcount, ((-tileTranslatePoint.x + size.width + (xRight * 256)) / 256) + 1);\n        var startX = (-((tileTranslatePoint.x + (xLeft * 256)) + 256) / 256);\n        var startY = (-(tileTranslatePoint.y + 256) / 256);\n        bing = bing || this.bing || this.mapObject['bingMap'];\n        for (var i = Math.round(startX); i < Math.round(endX); i++) {\n            for (var j = Math.round(startY); j < Math.round(endY); j++) {\n                var x = 256 * i + tileTranslatePoint.x;\n                var y = 256 * j + tileTranslatePoint.y;\n                if (x > -256 && x <= size.width && y > -256 && y < size.height) {\n                    if (j >= 0) {\n                        var tileI = i;\n                        if (i < 0) {\n                            tileI = (tileI % ycount) + ycount;\n                        }\n                        var tile = new Tile(tileI % ycount, j);\n                        tile.left = x;\n                        tile.top = y;\n                        if (baseLayer.layerType === 'Bing') {\n                            var key = baseLayer.key;\n                            tile.src = bing.getBingMap(tile, key, baseLayer.bingMapType, userLang, bing.imageUrl, bing.subDomains);\n                        }\n                        else {\n                            tile.src = this.urlTemplate.replace('level', zoomLevel.toString()).replace('tileX', tile.x.toString())\n                                .replace('tileY', tile.y.toString());\n                        }\n                        this.tiles.push(tile);\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(zoomType)) {\n            if (zoomType.indexOf('wheel') > 1) {\n                this.animateToZoomX = (this.mapObject.availableSize.width / 2) - position.x - 10;\n                this.animateToZoomY = -position.y;\n            }\n            else {\n                this.animateToZoomX = -10;\n                this.animateToZoomY = -(this.mapObject.availableSize.height / 2 + 11.5) + 10;\n            }\n        }\n        var proxTiles = extend([], this.tiles, [], true);\n        for (var _i = 0, _a = this.mapObject.layers; _i < _a.length; _i++) {\n            var layer = _a[_i];\n            if (!(layer.type === 'SubLayer' && layer.visible)) {\n                continue;\n            }\n            if (layer.layerType === 'OSM' || layer.layerType === 'Bing') {\n                for (var _b = 0, proxTiles_1 = proxTiles; _b < proxTiles_1.length; _b++) {\n                    var baseTile = proxTiles_1[_b];\n                    var subtile = extend(baseTile, {}, {}, true);\n                    if (layer.layerType === 'Bing') {\n                        subtile.src = bing.getBingMap(subtile, layer.key, layer.bingMapType, userLang, bing.imageUrl, bing.subDomains);\n                    }\n                    else {\n                        subtile.src = layer.urlTemplate.replace('level', zoomLevel.toString()).replace('tileX', baseTile.x.toString())\n                            .replace('tileY', baseTile.y.toString());\n                    }\n                    this.tiles.push(subtile);\n                }\n            }\n        }\n        this.arrangeTiles(zoomType, this.animateToZoomX, this.animateToZoomY);\n    };\n    LayerPanel.prototype.arrangeTiles = function (type, x, y) {\n        var _this = this;\n        var element = document.getElementById(this.mapObject.element.id + '_tile_parent');\n        var element1 = document.getElementById(this.mapObject.element.id + '_tiles');\n        var timeOut;\n        if (!isNullOrUndefined(type) && type !== 'Pan' && type !== 'Reset' && type.indexOf('ZoomOut') === -1) {\n            this.tileAnimation(type, x, y);\n            timeOut = 250;\n        }\n        else {\n            timeOut = 0;\n        }\n        if (this.mapObject.layers[this.mapObject.baseLayerIndex].layerType === 'GoogleStaticMap') {\n            this.renderGoogleMap(this.mapObject.layers[0].key, this.mapObject.staticMapZoom);\n        }\n        else {\n            setTimeout(function () {\n                if (element) {\n                    element.style.zIndex = '1';\n                }\n                if (element1) {\n                    element1.style.zIndex = '0';\n                    element1.style.visibility = 'hidden';\n                }\n                var animateElement;\n                if (!document.getElementById('animated_tiles') && element) {\n                    animateElement = createElement('div', { id: _this.mapObject.element.id + '_animated_tiles' });\n                    element.appendChild(animateElement);\n                }\n                else {\n                    if (type !== 'Pan' && element1 && element) {\n                        element1.appendChild(element.children[0]);\n                        animateElement = createElement('div', { id: _this.mapObject.element.id + '_animated_tiles' });\n                        element.appendChild(animateElement);\n                    }\n                    else {\n                        animateElement = element ? element.children[0] : null;\n                    }\n                }\n                var id = 0;\n                for (var _i = 0, _a = _this.tiles; _i < _a.length; _i++) {\n                    var tile = _a[_i];\n                    var imgElement = createElement('img');\n                    imgElement.setAttribute('src', tile.src);\n                    var child = void 0;\n                    if (document.getElementById('tile_' + id) && type === 'Pan') {\n                        removeElement('tile_' + id);\n                    }\n                    child = createElement('div', { id: 'tile_' + id });\n                    child.style.position = 'absolute';\n                    child.style.left = tile.left + 'px';\n                    child.style.top = tile.top + 'px';\n                    child.style.height = tile.height + 'px';\n                    child.style.width = tile.width + 'px';\n                    child.appendChild(imgElement);\n                    if (animateElement) {\n                        animateElement.appendChild(child);\n                    }\n                    id++;\n                }\n                // tslint:disable-next-line:align\n            }, timeOut);\n        }\n    };\n    /**\n     * Animation for tile layers and hide the group element until the tile layer rendering\n     */\n    LayerPanel.prototype.tileAnimation = function (zoomType, translateX, translateY) {\n        var element = document.getElementById(this.mapObject.element.id + '_tile_parent');\n        var element1 = document.getElementById('animated_tiles');\n        var ele = document.getElementById(this.mapObject.element.id + '_tiles');\n        var scaleValue = '2';\n        if (zoomType.indexOf('ZoomOut') === 0) {\n            ele.style.zIndex = '1';\n            element.style.zIndex = '0';\n            // element1 = ele.children[ele.childElementCount - 1] as HTMLElement;\n            while (ele.childElementCount >= 1) {\n                ele.removeChild(ele.children[0]);\n            }\n            translateX = 0;\n            translateY = 128 - 23;\n            scaleValue = '0.5';\n        }\n        else if (zoomType === 'Reset') {\n            ele.style.zIndex = '1';\n            element.style.zIndex = '0';\n            while (!(ele.childElementCount === 1) && !(ele.childElementCount === 0)) {\n                ele.removeChild(ele.children[1]);\n            }\n            element1 = ele.children[0];\n            translateX = 0;\n            translateY = 0;\n            scaleValue = '1';\n        }\n        if (!isNullOrUndefined(element1)) {\n            element1.style.transition = '250ms';\n            element1.style.transform = 'translate(' + translateX + 'px, ' + translateY + 'px) scale(' + scaleValue + ')';\n        }\n    };\n    /* tslint:disable:no-string-literal */\n    /**\n     * Static map rendering\n     * @param apikey\n     * @private\n     */\n    LayerPanel.prototype.renderGoogleMap = function (apikey, zoom) {\n        var staticMapString;\n        var map = this.mapObject;\n        // zoom = this.mapObject.zoomSettings.shouldZoomInitially ? this.mapObject.markerZoomFactor : zoom;\n        zoom = this.mapObject.tileZoomLevel;\n        var x;\n        var y;\n        var totalSize = Math.pow(2, zoom) * 256;\n        x = (map.mapAreaRect.width / 2) - (totalSize / 2);\n        y = (map.mapAreaRect.height / 2) - (totalSize / 2);\n        var centerPoint = new Point(null, null);\n        var diffX = 0;\n        var diffY = 0;\n        var position = convertTileLatLongToPoint(centerPoint, zoom, { x: x, y: y }, this.isMapCoordinates);\n        if (map.zoomModule && map.zoomSettings.enable) {\n            diffX = map.zoomModule.mouseDownLatLong['x'] - map.zoomModule.mouseMoveLatLong['x'];\n            diffY = map.zoomModule.mouseDownLatLong['y'] - map.zoomModule.mouseMoveLatLong['y'];\n        }\n        var panLatLng = map.pointToLatLong(position.x - diffX, position.y - diffY);\n        map.centerPosition.latitude = panLatLng['latitude'];\n        map.centerPosition.longitude = panLatLng['longitude'];\n        var mapWidth;\n        var mapHeight;\n        if (isNullOrUndefined(parseInt(map.width, 10))) {\n            mapWidth = parseInt(map.width, 10) - 22;\n        }\n        else {\n            mapWidth = Math.round(map.mapAreaRect.width);\n        }\n        if (isNullOrUndefined(parseInt(map.height, 10))) {\n            mapHeight = parseInt(map.height, 10) - 22;\n        }\n        else {\n            mapHeight = Math.round(map.mapAreaRect.height);\n        }\n        var eleWidth = mapWidth > 640 ? (mapWidth - 640) / 2 : 0;\n        var eleHeight = mapHeight > 640 ? (mapHeight - 640) / 2 : 0;\n        var center;\n        var mapType = (map.layers[map.layers.length - 1].staticMapType).toString().toLowerCase();\n        if (map.centerPosition.latitude && map.centerPosition.longitude) {\n            center = map.centerPosition.latitude.toString() + ',' + map.centerPosition.longitude.toString();\n        }\n        else {\n            center = '0,0';\n        }\n        staticMapString = 'https://maps.googleapis.com/maps/api/staticmap?size=' + mapWidth + 'x' + mapHeight +\n            '&zoom=' + zoom + '&center=' + center + '&maptype=' + mapType + '&key=' + apikey;\n        document.getElementById(this.mapObject.element.id + '_tile_parent').innerHTML\n            = '<div id=\"' + this.mapObject.element.id + '_StaticGoogleMap\"' + 'style=\"position:absolute; left:' + eleWidth + 'px; top:'\n                + eleHeight + 'px\"><img src=\"' + staticMapString + '\"></div>';\n    };\n    /**\n     * To find the tile translate point\n     * @param factorX\n     * @param factorY\n     * @param centerPosition\n     */\n    LayerPanel.prototype.panTileMap = function (factorX, factorY, centerPosition) {\n        if (this.mapObject.tileZoomLevel <= this.mapObject.tileZoomScale && this.mapObject.initialCheck) {\n            this.mapObject.tileZoomLevel = this.mapObject.tileZoomScale;\n        }\n        var level = this.mapObject.tileZoomLevel;\n        var padding = this.mapObject.layers[this.mapObject.layers.length - 1].layerType !== 'GoogleStaticMap' ?\n            20 : 0;\n        var x;\n        var y;\n        var totalSize = Math.pow(2, level) * 256;\n        x = (factorX / 2) - (totalSize / 2);\n        y = (factorY / 2) - (totalSize / 2);\n        var position = convertTileLatLongToPoint(centerPosition, level, { x: x, y: y }, this.isMapCoordinates);\n        padding = this.mapObject.zoomNotApplied ? 0 : padding;\n        x -= position.x - (factorX / 2);\n        y = (y - (position.y - (factorY / 2))) + padding;\n        this.mapObject.scale = Math.pow(2, level - 1);\n        if ((isNullOrUndefined(this.mapObject.tileTranslatePoint) || (this.mapObject.tileTranslatePoint.y === 0 &&\n            this.mapObject.tileTranslatePoint.x === 0)) || (isNullOrUndefined(this.mapObject.previousTileWidth) ||\n            isNullOrUndefined(this.mapObject.previousTileHeight))) {\n            this.mapObject.previousTileWidth = factorX;\n            this.mapObject.previousTileHeight = factorY;\n        }\n        if (!isNullOrUndefined(this.mapObject.tileTranslatePoint) && (isNullOrUndefined(centerPosition.x)) &&\n            (this.mapObject.zoomSettings.zoomFactor === 1 ||\n                this.mapObject.zoomSettings.zoomFactor !== level || !this.mapObject.defaultState)) {\n            if ((factorX !== this.mapObject.previousTileWidth || factorY !== this.mapObject.previousTileHeight)) {\n                var xdiff = x - ((this.mapObject.previousTileWidth / 2) - (totalSize / 2));\n                var ydiff = y - ((this.mapObject.previousTileHeight / 2) - (totalSize / 2) + padding);\n                this.mapObject.tileTranslatePoint.x = this.mapObject.tileTranslatePoint.x + xdiff;\n                this.mapObject.tileTranslatePoint.y = this.mapObject.tileTranslatePoint.y + ydiff;\n            }\n        }\n        if (!isNullOrUndefined(this.mapObject.tileTranslatePoint) && !this.mapObject.zoomNotApplied) {\n            if (this.mapObject.tileTranslatePoint.x !== 0 && this.mapObject.tileTranslatePoint.x !== x\n                && !this.mapObject.centerPositionChanged) {\n                x = this.mapObject.tileTranslatePoint.x;\n            }\n            if (this.mapObject.tileTranslatePoint.y !== 0 && this.mapObject.tileTranslatePoint.y !== y\n                && !this.mapObject.centerPositionChanged) {\n                y = this.mapObject.tileTranslatePoint.y;\n            }\n        }\n        this.mapObject.translatePoint = new Point((x - (0.01 * this.mapObject.scale)) / this.mapObject.scale, (y - (0.01 * this.mapObject.scale)) / this.mapObject.scale);\n        this.mapObject.previousTileWidth = factorX;\n        this.mapObject.previousTileHeight = factorY;\n        return new Point(x, y);\n    };\n    return LayerPanel;\n}());\nexport { LayerPanel };\n"]},"metadata":{},"sourceType":"module"}