{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  return t;\n};\n\nimport { Point, getElementByID, PathOption, Rect, convertGeoToPoint, CircleOption, convertTileLatLongToPoint } from '../utils/helper';\nimport { RectOption, createTooltip, calculateScale, getTouchCenter, getTouches, targetTouches } from '../utils/helper';\nimport { MapLocation, zoomAnimate, smoothTranslate, measureText, textTrim, clusterTemplate, marker } from '../utils/helper';\nimport { markerTemplate, removeElement, getElement, clusterSeparate, markerColorChoose } from '../utils/helper';\nimport { markerShapeChoose } from '../utils/helper';\nimport { isNullOrUndefined, EventHandler, Browser, remove, createElement } from '@syncfusion/ej2-base';\nimport { changeBorderWidth, markerRendering } from '../index';\nimport { pan } from '../model/constants';\nimport { getValueFromObject } from '../utils/helper';\n/**\n * Zoom module used to process the zoom for maps\n */\n\n/* tslint:disable:max-line-length */\n\nvar Zoom =\n/** @class */\nfunction () {\n  function Zoom(maps) {\n    this.isPanning = false;\n    this.mouseEnter = false;\n    this.isTouch = false;\n    this.rectZoomingStart = false;\n    this.pinchRect = new Rect(0, 0, 0, 0);\n    this.browserName = Browser.info.name;\n    this.isPointer = Browser.isPointer;\n    this.handled = false;\n    this.pinchFactor = 1;\n    this.startTouches = [];\n    this.shapeZoomLocation = [];\n    this.intersect = [];\n    this.mouseDownLatLong = {\n      x: 0,\n      y: 0\n    };\n    this.mouseMoveLatLong = {\n      x: 0,\n      y: 0\n    };\n    /**\n     * @private\n     */\n\n    this.isSingleClick = false;\n    this.maps = maps;\n    this.wheelEvent = this.browserName === 'mozilla' ? this.isPointer ? 'mousewheel' : 'DOMMouseScroll' : 'mousewheel';\n    this.cancelEvent = this.isPointer ? 'pointerleave' : 'mouseleave';\n    this.selectionColor = this.maps.zoomSettings.selectionColor;\n    this.fillColor = this.maps.zoomSettings.color;\n    this.addEventListener();\n    this.groupElements = [];\n  }\n  /* tslint:disable:no-string-literal */\n\n  /**\n   * To perform zooming for maps\n   * @param position\n   * @param newZoomFactor\n   * @param type\n   */\n\n\n  Zoom.prototype.performZooming = function (position, newZoomFactor, type) {\n    var _this = this;\n\n    var map = this.maps;\n    map.previousProjection = map.projectionType;\n    map.defaultState = false;\n    map.initialCheck = false;\n    map.markerZoomedState = false;\n    map.zoomPersistence = map.enablePersistence;\n    var prevLevel = map.tileZoomLevel;\n    var scale = map.previousScale = map.scale;\n    var maxZoom = map.zoomSettings.maxZoom;\n    var minZoom = map.zoomSettings.minZoom;\n    newZoomFactor = minZoom > newZoomFactor && type === 'ZoomIn' ? minZoom + 1 : newZoomFactor;\n    var prevTilePoint = map.tileTranslatePoint;\n\n    if (!map.isTileMap && (type === 'ZoomIn' ? newZoomFactor >= minZoom && newZoomFactor <= maxZoom : newZoomFactor >= minZoom)) {\n      var availSize = map.mapAreaRect;\n      var minBounds = map.baseMapRectBounds['min'];\n      var maxBounds = map.baseMapRectBounds['max'];\n      var mapTotalWidth = Math.abs(minBounds['x'] - maxBounds['x']);\n      var mapTotalHeight = Math.abs(minBounds['y'] - maxBounds['y']);\n      var point = map.translatePoint;\n      var translatePointX = point.x - (availSize.width / scale - availSize.width / newZoomFactor) / (availSize.width / position.x);\n      var translatePointY = point.y - (availSize.height / scale - availSize.height / newZoomFactor) / (availSize.height / position.y);\n      var currentHeight = Math.abs(map.baseMapRectBounds['max']['y'] - map.baseMapRectBounds['min']['y']) * newZoomFactor;\n      translatePointX = currentHeight < map.mapAreaRect.height ? availSize.x + (-minBounds['x'] + (availSize.width / 2 - mapTotalWidth / 2)) : translatePointX;\n      translatePointY = currentHeight < map.mapAreaRect.height ? availSize.y + (-minBounds['y'] + (availSize.height / 2 - mapTotalHeight / 2)) : translatePointY;\n      map.translatePoint = new Point(translatePointX, translatePointY);\n      map.scale = newZoomFactor;\n      this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n      this.applyTransform();\n    } else if (map.isTileMap && newZoomFactor >= minZoom && newZoomFactor <= maxZoom) {\n      this.getTileTranslatePosition(prevLevel, newZoomFactor, position, type);\n      map.tileZoomLevel = newZoomFactor;\n      map.scale = Math.pow(2, newZoomFactor - 1);\n\n      if (type === 'ZoomOut' && map.zoomSettings.resetToInitial && map.applyZoomReset && newZoomFactor <= map.initialZoomLevel) {\n        map.initialCheck = true;\n        map.zoomPersistence = false;\n        map.tileTranslatePoint.x = map.initialTileTranslate.x;\n        map.tileTranslatePoint.y = map.initialTileTranslate.y;\n        newZoomFactor = map.tileZoomLevel = map.mapScaleValue = map.initialZoomLevel;\n        map.scale = Math.pow(2, newZoomFactor - 1);\n      }\n\n      map.translatePoint.y = (map.tileTranslatePoint.y - 0.01 * map.scale) / map.scale;\n      map.translatePoint.x = (map.tileTranslatePoint.x - 0.01 * map.scale) / map.scale;\n      this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n\n      if (document.querySelector('.GroupElement')) {\n        document.querySelector('.GroupElement').style.display = 'none';\n      }\n\n      if (document.getElementById(this.maps.element.id + '_LayerIndex_1')) {\n        document.getElementById(this.maps.element.id + '_LayerIndex_1').style.display = 'none';\n      }\n\n      map.mapLayerPanel.generateTiles(newZoomFactor, map.tileTranslatePoint, type + 'wheel', null, position);\n      var element1 = document.getElementById(this.maps.element.id + '_tiles');\n      setTimeout(function () {\n        // if (type === 'ZoomOut') {\n        //     element1.removeChild(element1.children[element1.childElementCount - 1]);\n        //     if (element1.childElementCount) {\n        //         element1.removeChild(element1.children[element1.childElementCount - 1]);\n        //     } else {\n        //         element1 = element1;\n        //     }\n        // }\n        _this.applyTransform();\n\n        if (document.getElementById(_this.maps.element.id + '_LayerIndex_1')) {\n          document.getElementById(_this.maps.element.id + '_LayerIndex_1').style.display = 'block';\n        } // tslint:disable-next-line:align\n\n      }, 250);\n    }\n\n    this.maps.zoomNotApplied = false;\n  };\n\n  Zoom.prototype.triggerZoomEvent = function (prevTilePoint, prevLevel, type) {\n    var map = this.maps;\n    var zoomArgs;\n\n    if (!map.isTileMap) {\n      zoomArgs = {\n        cancel: false,\n        name: 'zoom',\n        type: type,\n        maps: !map.isBlazor ? map : null,\n        tileTranslatePoint: {},\n        translatePoint: {\n          previous: map.previousPoint,\n          current: map.translatePoint\n        },\n        tileZoomLevel: {},\n        scale: {\n          previous: map.previousScale,\n          current: map.scale\n        }\n      };\n    } else {\n      zoomArgs = {\n        cancel: false,\n        name: 'zoom',\n        type: type,\n        maps: !map.isBlazor ? map : null,\n        tileTranslatePoint: {\n          previous: prevTilePoint,\n          current: map.tileTranslatePoint\n        },\n        translatePoint: {\n          previous: map.previousPoint,\n          current: map.translatePoint\n        },\n        tileZoomLevel: {\n          previous: prevLevel,\n          current: map.tileZoomLevel\n        },\n        scale: {\n          previous: map.previousScale,\n          current: map.scale\n        }\n      };\n    }\n\n    map.trigger('zoom', zoomArgs);\n  };\n\n  Zoom.prototype.getTileTranslatePosition = function (prevLevel, currentLevel, position, type) {\n    var map = this.maps;\n    var tileDefaultSize = 256;\n    var padding = type === 'ZoomOut' ? 10 : type === 'Reset' && currentLevel > 1 ? 0 : 10;\n    var bounds = map.availableSize;\n    var prevSize = Math.pow(2, prevLevel) * 256;\n    var totalSize = Math.pow(2, currentLevel) * 256;\n    var x = (position.x - map.tileTranslatePoint.x) / prevSize * 100;\n    var y = (position.y - map.tileTranslatePoint.y) / prevSize * 100;\n    map.tileTranslatePoint.x = currentLevel === 1 ? bounds.width / 2 - tileDefaultSize * 2 / 2 : position.x - x * totalSize / 100;\n    map.tileTranslatePoint.y = currentLevel === 1 ? bounds.height / 2 - tileDefaultSize * 2 / 2 + padding * 2 : position.y - y * totalSize / 100;\n  };\n\n  Zoom.prototype.performRectZooming = function () {\n    this.isDragZoom = true;\n    var map = this.maps;\n    var size = map.availableSize;\n    map.previousProjection = map.projectionType;\n    var prevLevel = map.tileZoomLevel;\n    var prevTilePoint = map.tileTranslatePoint;\n    var zoomRect = this.zoomingRect;\n    var maxZoom = map.zoomSettings.maxZoom;\n    var minZoom = map.zoomSettings.minZoom;\n\n    if (zoomRect.height > 0 && zoomRect.width > 0) {\n      var x = this.zoomingRect.x + this.zoomingRect.width / 2;\n      var y = this.zoomingRect.y + this.zoomingRect.height / 2;\n      var zoomCalculationFactor = void 0;\n\n      if (!map.isTileMap) {\n        var scale = map.previousScale = map.scale;\n        zoomCalculationFactor = scale + Math.round((size.width / zoomRect.width + size.height / zoomRect.height) / 2);\n        var translatePoint = map.previousPoint = map.translatePoint;\n        var translatePointX = translatePoint.x - (size.width / scale - size.width / zoomCalculationFactor) / (size.width / x);\n        var translatePointY = translatePoint.y - (size.height / scale - size.height / zoomCalculationFactor) / (size.height / y);\n        map.translatePoint = new Point(translatePointX, translatePointY);\n        map.scale = zoomCalculationFactor;\n        this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n      } else {\n        zoomCalculationFactor = prevLevel + Math.round(prevLevel + (size.width / zoomRect.width + size.height / zoomRect.height) / 2);\n        zoomCalculationFactor = zoomCalculationFactor >= minZoom && zoomCalculationFactor <= maxZoom ? zoomCalculationFactor : maxZoom;\n        this.getTileTranslatePosition(prevLevel, zoomCalculationFactor, {\n          x: x,\n          y: y\n        });\n        map.tileZoomLevel = zoomCalculationFactor;\n        map.translatePoint.x = (map.tileTranslatePoint.x - 0.5 * Math.pow(2, zoomCalculationFactor)) / Math.pow(2, zoomCalculationFactor);\n        map.translatePoint.y = (map.tileTranslatePoint.y - 0.5 * Math.pow(2, zoomCalculationFactor)) / Math.pow(2, zoomCalculationFactor);\n        map.scale = Math.pow(2, zoomCalculationFactor);\n        this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n        map.mapLayerPanel.generateTiles(zoomCalculationFactor, map.tileTranslatePoint);\n      }\n\n      map.mapScaleValue = zoomCalculationFactor;\n      this.applyTransform(true);\n      this.maps.zoomNotApplied = false;\n      this.zoomingRect = null;\n    }\n  };\n\n  Zoom.prototype.setInteraction = function (newInteraction) {\n    this.lastScale = 1;\n    this.interaction = newInteraction;\n  };\n\n  Zoom.prototype.updateInteraction = function () {\n    if (this.fingers === 2) {\n      this.setInteraction('zoom');\n    } else {\n      this.setInteraction(null);\n    }\n  };\n\n  Zoom.prototype.performPinchZooming = function (e) {\n    var map = this.maps;\n    var prevLevel = map.tileZoomLevel;\n    var availSize = map.mapAreaRect;\n    map.previousScale = map.scale;\n    map.previousPoint = map.translatePoint;\n    var prevTilePoint = map.tileTranslatePoint;\n    var scale = calculateScale(this.touchStartList, this.touchMoveList);\n    var touchCenter = getTouchCenter(getTouches(this.touchMoveList, this.maps));\n    var newScale = scale / this.lastScale;\n    this.lastScale = scale;\n    this.pinchFactor *= newScale;\n    this.pinchFactor = Math.min(this.maps.zoomSettings.maxZoom, Math.max(this.pinchFactor, this.maps.zoomSettings.minZoom));\n    var zoomCalculationFactor = this.pinchFactor;\n    var zoomArgs;\n\n    if (!map.isTileMap) {\n      var minBounds = map.baseMapRectBounds['min'];\n      var maxBounds = map.baseMapRectBounds['max'];\n      var mapTotalWidth = Math.abs(minBounds['x'] - maxBounds['x']);\n      var mapTotalHeight = Math.abs(minBounds['y'] - maxBounds['y']);\n      var translatePoint = map.translatePoint;\n      var currentHeight = Math.abs(map.baseMapRectBounds['max']['y'] - map.baseMapRectBounds['min']['y']) * zoomCalculationFactor;\n      var translatePointX = translatePoint.x - (availSize.width / map.scale - availSize.width / zoomCalculationFactor) / (availSize.width / touchCenter.x);\n      var translatePointY = translatePoint.y - (availSize.height / map.scale - availSize.height / zoomCalculationFactor) / (availSize.height / touchCenter.y);\n      translatePointX = currentHeight < map.mapAreaRect.height ? availSize.x + (-minBounds['x'] + (availSize.width / 2 - mapTotalWidth / 2)) : translatePointX;\n      translatePointY = currentHeight < map.mapAreaRect.height ? availSize.y + (-minBounds['y'] + (availSize.height / 2 - mapTotalHeight / 2)) : translatePointY;\n      map.translatePoint = new Point(translatePointX, translatePointY);\n      map.scale = zoomCalculationFactor;\n      this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n    } else {\n      var newTileFactor = zoomCalculationFactor;\n      this.getTileTranslatePosition(prevLevel, newTileFactor, {\n        x: touchCenter.x,\n        y: touchCenter.y\n      });\n      map.tileZoomLevel = newTileFactor;\n      map.translatePoint.x = (map.tileTranslatePoint.x - 0.5 * Math.pow(2, newTileFactor)) / Math.pow(2, newTileFactor);\n      map.translatePoint.y = (map.tileTranslatePoint.y - 0.5 * Math.pow(2, newTileFactor)) / Math.pow(2, newTileFactor);\n      map.scale = Math.pow(2, newTileFactor);\n      this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n      map.mapLayerPanel.generateTiles(newTileFactor, map.tileTranslatePoint);\n    }\n\n    this.applyTransform();\n  };\n\n  Zoom.prototype.drawZoomRectangle = function () {\n    var map = this.maps;\n    var down = this.mouseDownPoints;\n    var move = this.mouseMovePoints;\n    var x;\n    var y;\n    var width;\n    var height;\n    var border = {\n      width: 1,\n      color: '#009900'\n    };\n    width = Math.abs(move.x - down.x);\n    height = Math.abs(move.y - down.y);\n    x = move.x > down.x ? down.x : down.x - width;\n    y = move.y > down.y ? down.y : down.y - height;\n    var elementRect = getElementByID(map.element.id).getBoundingClientRect();\n\n    if (x > map.mapAreaRect.x && x < map.mapAreaRect.x + map.mapAreaRect.width && y > map.mapAreaRect.y && y < map.mapAreaRect.y + map.mapAreaRect.height) {\n      this.zoomingRect = new Rect(x, y, width, height);\n      var rectSVGObject = map.renderer.createSvg({\n        id: map.element.id + '_Selection_Rect_Zooming',\n        width: map.availableSize.width,\n        height: map.availableSize.height\n      });\n      var rectOption = new RectOption(map.element.id + '_ZoomRect', '#d3d3d3', border, 0.5, this.zoomingRect, 0, 0, '', '3');\n      rectSVGObject.appendChild(map.renderer.drawRectangle(rectOption));\n      getElementByID(map.element.id + '_Secondary_Element').appendChild(rectSVGObject);\n    }\n  };\n  /**\n   * To animate the zooming process\n   */\n\n\n  Zoom.prototype.animateTransform = function (element, animate, x, y, scale) {\n    var duration = this.currentLayer.animationDuration;\n\n    if (!animate || duration === 0) {\n      element.setAttribute('transform', 'scale(' + scale + ') translate( ' + x + ' ' + y + ' )');\n      return;\n    }\n\n    zoomAnimate(element, 0, duration, new MapLocation(x, y), scale, this.maps.mapAreaRect, this.maps);\n  }; //tslint:disable:max-func-body-length\n\n\n  Zoom.prototype.applyTransform = function (animate) {\n    var layerIndex;\n    this.templateCount = 0;\n    var layer;\n    var zoomshapelocation;\n    var i;\n    var markerStyle;\n    var scale = this.maps.scale;\n    var x = this.maps.translatePoint.x;\n    var y = this.maps.translatePoint.y;\n    var collection = [];\n    this.maps.zoomShapeCollection = [];\n\n    if (document.getElementById(this.maps.element.id + '_mapsTooltip')) {\n      removeElement(this.maps.element.id + '_mapsTooltip');\n    }\n\n    if (this.layerCollectionEle) {\n      for (var i_1 = 0; i_1 < this.layerCollectionEle.childElementCount; i_1++) {\n        var layerElement = this.layerCollectionEle.childNodes[i_1];\n\n        if (layerElement.tagName === 'g') {\n          this.templateCount++;\n          this.index = layerElement.id.indexOf('_LayerIndex_') > -1 && parseFloat(layerElement.id.split('_LayerIndex_')[1].split('_')[0]);\n          this.currentLayer = this.maps.layersCollection[this.index];\n          var factor = this.maps.mapLayerPanel.calculateFactor(this.currentLayer);\n\n          for (var j = 0; j < layerElement.childElementCount; j++) {\n            var currentEle = layerElement.childNodes[j];\n\n            if (!(currentEle.id.indexOf('_Markers_Group') > -1) && !(currentEle.id.indexOf('_bubble_Group') > -1) && !(currentEle.id.indexOf('_dataLableIndex_Group') > -1)) {\n              if (this.maps.isTileMap && currentEle.id.indexOf('_line_Group') > -1) {\n                currentEle.remove();\n\n                if (layerElement.children.length > 0 && layerElement.children[0]) {\n                  layerElement.insertBefore(this.maps.navigationLineModule.renderNavigation(this.currentLayer, this.maps.tileZoomLevel, this.index), layerElement.children[0]);\n                } else {\n                  layerElement.appendChild(this.maps.navigationLineModule.renderNavigation(this.currentLayer, this.maps.tileZoomLevel, this.index));\n                }\n              } else {\n                changeBorderWidth(currentEle, this.index, scale, this.maps);\n                this.maps.zoomTranslatePoint = this.maps.translatePoint;\n                this.animateTransform(currentEle, animate, x, y, scale);\n                this.shapeZoomLocation = currentEle.childNodes;\n              }\n            } else if (currentEle.id.indexOf('_Markers_Group') > -1) {\n              if (!this.isPanning) {\n                this.markerTranslates(currentEle.childNodes[0], factor, x, y, scale, 'Marker', layerElement, animate);\n              }\n\n              currentEle = layerElement.childNodes[j];\n\n              if (!isNullOrUndefined(currentEle)) {\n                for (var k = 0; k < currentEle.childElementCount; k++) {\n                  this.markerTranslate(currentEle.childNodes[k], factor, x, y, scale, 'Marker', animate);\n                  var layerIndex_1 = parseInt(currentEle.childNodes[k]['id'].split('_LayerIndex_')[1].split('_')[0], 10);\n                  var dataIndex = parseInt(currentEle.childNodes[k]['id'].split('_dataIndex_')[1].split('_')[0], 10);\n                  var markerIndex = parseInt(currentEle.childNodes[k]['id'].split('_MarkerIndex_')[1].split('_')[0], 10);\n                  var markerSelectionValues = this.currentLayer.markerSettings[markerIndex].dataSource[dataIndex];\n\n                  for (var x_1 = 0; x_1 < this.currentLayer.markerSettings[markerIndex].initialMarkerSelection.length; x_1++) {\n                    if (this.currentLayer.markerSettings[markerIndex].initialMarkerSelection[x_1]['latitude'] === markerSelectionValues['latitude'] || this.currentLayer.markerSettings[markerIndex].initialMarkerSelection[x_1]['longitude'] === markerSelectionValues['longitude']) {\n                      this.maps.markerSelection(this.currentLayer.markerSettings[markerIndex].selectionSettings, this.maps, currentEle.children[k], this.currentLayer.markerSettings[markerIndex].dataSource[dataIndex]);\n                    }\n                  }\n\n                  if (!this.maps.isTileMap && this.currentLayer.animationDuration > 0) {\n                    markerStyle = 'visibility:hidden';\n                    currentEle.setAttribute('style', markerStyle);\n                  }\n                }\n\n                if (this.isPanning && this.maps.markerModule.sameMarkerData.length > 0) {\n                  clusterSeparate(this.maps.markerModule.sameMarkerData, this.maps, currentEle, true);\n                } else if (this.maps.markerModule.sameMarkerData.length > 0) {\n                  this.maps.markerModule.sameMarkerData = [];\n\n                  if (document.getElementById(this.maps.element.id + '_mapsTooltip')) {\n                    removeElement(this.maps.element.id + '_mapsTooltip');\n                  }\n                }\n\n                if (document.getElementById(this.maps.element.id + '_mapsTooltip') && this.maps.mapsTooltipModule.tooltipTargetID.indexOf('_MarkerIndex_') && !this.isPanning) {\n                  var mapsTooltip = this.maps.mapsTooltipModule;\n                  var tooltipElement = currentEle.querySelector('#' + mapsTooltip.tooltipTargetID);\n\n                  if (!isNullOrUndefined(tooltipElement)) {\n                    if (tooltipElement['style']['visibility'] === 'hidden') {\n                      removeElement(this.maps.element.id + '_mapsTooltip');\n                    } else {\n                      var x_2 = parseFloat(tooltipElement.getAttribute('transform').split('(')[1].split(')')[0].split(' ')[1]);\n                      var y_1 = parseFloat(tooltipElement.getAttribute('transform').split('(')[1].split(')')[0].split(' ')[2]);\n\n                      if (this.maps.isTileMap) {\n                        x_2 += +getElement(this.maps.element.id + '_tile_parent')['style']['left'].split('px')[0];\n                        y_1 += +getElement(this.maps.element.id + '_tile_parent')['style']['top'].split('px')[0];\n                      }\n\n                      mapsTooltip.svgTooltip.location.x = x_2;\n                      mapsTooltip.svgTooltip.location.y = y_1;\n                      mapsTooltip.svgTooltip.enableAnimation = false;\n                    }\n                  }\n                }\n              }\n            } else if (currentEle.id.indexOf('_bubble_Group') > -1) {\n              var childElement = void 0;\n\n              for (var k = 0; k < currentEle.childElementCount; k++) {\n                childElement = currentEle.childNodes[k];\n                var bubbleTransform = childElement.getAttribute('transform');\n                layerIndex = parseFloat(childElement.id.split('_LayerIndex_')[1].split('_')[0]);\n                var bubleIndex = parseFloat(childElement.id.split('_BubbleIndex_')[1].split('_')[0]);\n                var dataIndex = parseFloat(childElement.id.split('_BubbleIndex_')[1].split('_')[2]);\n\n                for (var l = 0; l < this.maps.bubbleModule.bubbleCollection.length; l++) {\n                  var bubbleCollection = this.maps.bubbleModule.bubbleCollection[l];\n\n                  if (bubbleCollection['LayerIndex'] === layerIndex && bubbleCollection['BubbleIndex'] === bubleIndex && bubbleCollection['DataIndex'] === dataIndex) {\n                    var centerX = bubbleCollection['center']['x'];\n                    var centerY = bubbleCollection['center']['y'];\n                    var currentX = (centerX + x) * scale;\n                    var currentY = (centerY + y) * scale;\n                    var duration = this.currentLayer.animationDuration;\n\n                    if (!animate || duration === 0) {\n                      childElement.setAttribute('transform', 'translate( ' + currentX + ' ' + currentY + ' )');\n                    } else {\n                      smoothTranslate(childElement, 0, duration, new MapLocation(currentX, currentY));\n                    }\n\n                    break;\n                  }\n                }\n              }\n            } else if (currentEle.id.indexOf('_dataLableIndex_Group') > -1) {\n              this.intersect = [];\n              this.maps.zoomLabelPositions = [];\n              this.maps.zoomLabelPositions = this.maps.dataLabelModule.dataLabelCollections;\n\n              for (var k = 0; k < currentEle.childElementCount; k++) {\n                if (currentEle.childNodes[k]['id'].indexOf('_LabelIndex_') > -1) {\n                  var labelIndex = parseFloat(currentEle.childNodes[k]['id'].split('_LabelIndex_')[1].split('_')[0]);\n                  this.zoomshapewidth = this.shapeZoomLocation[labelIndex].getBoundingClientRect();\n                  this.maps.zoomShapeCollection.push(this.zoomshapewidth);\n                  this.dataLabelTranslate(currentEle.childNodes[k], factor, x, y, scale, 'DataLabel', animate);\n                  var dataLabel = this.maps.layers[this.index].dataLabelSettings;\n                  var border = dataLabel.border;\n\n                  if (k > 0 && border['width'] > 1) {\n                    if (currentEle.childNodes[k - 1]['id'].indexOf('_rectIndex_') > -1) {\n                      var labelX = (this.maps.zoomLabelPositions[labelIndex]['location']['x'] + x) * scale;\n                      var labelY = (this.maps.zoomLabelPositions[labelIndex]['location']['y'] + y) * scale;\n                      var zoomtext = currentEle.childNodes[k]['innerHTML'];\n                      var style = this.maps.layers[this.index].dataLabelSettings.textStyle;\n                      var zoomtextSize = measureText(zoomtext, style);\n                      var padding = 5;\n                      var rectElement = currentEle.childNodes[k - 1];\n                      var rectX = labelX - zoomtextSize['width'] / 2;\n                      var rectY = labelY - zoomtextSize['height'] / 2 - padding;\n                      rectElement['setAttribute']('x', rectX);\n                      rectElement['setAttribute']('y', rectY);\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        this.maps.arrangeTemplate();\n        var blazor = this.maps.isBlazor ? this.maps.blazorTemplates() : null;\n      }\n\n      if (!isNullOrUndefined(this.currentLayer)) {\n        if (!animate || this.currentLayer.animationDuration === 0) {\n          this.processTemplate(x, y, scale, this.maps);\n        }\n      }\n    }\n  }; //tslint:disable\n\n\n  Zoom.prototype.markerTranslates = function (element, factor, x, y, scale, type, layerElement, animate) {\n    var _this = this;\n\n    if (animate === void 0) {\n      animate = false;\n    }\n\n    var markerSVGObject;\n    var templateFn;\n    var nullCount = 0;\n    var markerCounts = 0;\n    var markerTemplateCounts = 0;\n    var layerIndex = parseInt((element ? element : layerElement).id.split('_LayerIndex_')[1].split('_')[0], 10);\n    markerSVGObject = this.maps.renderer.createGroup({\n      id: this.maps.element.id + '_Markers_Group',\n      class: 'GroupElement',\n      style: 'pointer-events: auto;'\n    });\n\n    if (document.getElementById(markerSVGObject.id)) {\n      removeElement(markerSVGObject.id);\n    }\n\n    var mapsAreaRect = this.maps.mapAreaRect;\n    var markerTemplateElements = createElement('div', {\n      id: this.maps.element.id + '_LayerIndex_' + layerIndex + '_Markers_Template_Group',\n      className: 'template',\n      styles: 'overflow: hidden; position: absolute;pointer-events: none;' + 'top:' + mapsAreaRect.y + 'px;' + 'left:' + mapsAreaRect.x + 'px;' + 'height:' + mapsAreaRect.height + 'px;' + 'width:' + mapsAreaRect.width + 'px;'\n    });\n\n    if (document.getElementById(markerTemplateElements.id)) {\n      removeElement(markerTemplateElements.id);\n    }\n\n    var currentLayers = this.maps.layersCollection[layerIndex];\n    currentLayers.markerSettings.map(function (markerSettings, markerIndex) {\n      var markerDatas = markerSettings.dataSource;\n      Array.prototype.forEach.call(markerDatas, function (data, dataIndex) {\n        _this.maps.markerNullCount = markerIndex >= 0 && dataIndex === 0 ? 0 : _this.maps.markerNullCount;\n        var eventArgs = {\n          template: markerSettings.template,\n          data: data,\n          maps: _this.maps,\n          marker: markerSettings,\n          cancel: false,\n          name: markerRendering,\n          fill: markerSettings.fill,\n          colorValuePath: markerSettings.colorValuePath,\n          shapeValuePath: markerSettings.shapeValuePath,\n          height: markerSettings.height,\n          width: markerSettings.width,\n          imageUrl: markerSettings.imageUrl,\n          shape: markerSettings.shape,\n          border: markerSettings.border\n        };\n        eventArgs = markerShapeChoose(eventArgs, data);\n        eventArgs = markerColorChoose(eventArgs, data);\n\n        if (_this.maps.isBlazor) {\n          var maps = eventArgs.maps,\n              marker_1 = eventArgs.marker,\n              blazorEventArgs = __rest(eventArgs, [\"maps\", \"marker\"]);\n\n          eventArgs = blazorEventArgs;\n          var latitudeValue = 'Latitude';\n          var longitudeValue = 'Longitude';\n          markerSettings.longitudeValuePath = !isNullOrUndefined(markerSettings.longitudeValuePath) ? markerSettings.longitudeValuePath : !isNullOrUndefined(data['Longitude']) ? longitudeValue : !isNullOrUndefined(data['longitude']) ? 'longitude' : null;\n          markerSettings.latitudeValuePath = !isNullOrUndefined(markerSettings.latitudeValuePath) ? markerSettings.latitudeValuePath : !isNullOrUndefined(data['Latitude']) ? latitudeValue : !isNullOrUndefined(data['latitude']) ? 'latitude' : null;\n        }\n\n        _this.maps.trigger('markerRendering', eventArgs, function (MarkerArgs) {\n          if (markerSettings.shapeValuePath !== eventArgs.shapeValuePath) {\n            eventArgs = markerShapeChoose(eventArgs, data);\n          }\n\n          if (markerSettings.colorValuePath !== eventArgs.colorValuePath) {\n            eventArgs = markerColorChoose(eventArgs, data);\n          }\n\n          var lati = !isNullOrUndefined(markerSettings.latitudeValuePath) ? Number(getValueFromObject(data, markerSettings.latitudeValuePath)) : !isNullOrUndefined(data['latitude']) ? parseFloat(data['latitude']) : !isNullOrUndefined(data['Latitude']) ? data['Latitude'] : 0;\n          var long = !isNullOrUndefined(markerSettings.longitudeValuePath) ? Number(getValueFromObject(data, markerSettings.longitudeValuePath)) : !isNullOrUndefined(data['longitude']) ? parseFloat(data['longitude']) : !isNullOrUndefined(data['Longitude']) ? data['Longitude'] : 0;\n\n          if (_this.maps.isBlazor) {\n            var data1 = {};\n            var j = 0;\n            var text = [];\n\n            for (var i = 0; i < Object.keys(data).length; i++) {\n              if (Object.keys(data)[i].toLowerCase() !== 'text' && Object.keys(data)[i].toLowerCase() !== 'latitude' && Object.keys(data)[i].toLowerCase() !== 'blazortemplateid' && Object.keys(data)[i].toLowerCase() !== 'longitude' && Object.keys(data)[i].toLowerCase() !== 'name') {\n                data1['text'] = text;\n                text[j] = data[Object.keys(data)[i].toLowerCase()];\n                j++;\n              }\n            }\n\n            data['text'] = data1['text'];\n          }\n\n          var offset = markerSettings.offset;\n\n          if (!eventArgs.cancel && markerSettings.visible && !isNullOrUndefined(long) && !isNullOrUndefined(lati)) {\n            var markerID = _this.maps.element.id + '_LayerIndex_' + layerIndex + '_MarkerIndex_' + markerIndex + '_dataIndex_' + dataIndex;\n            var location_1 = _this.maps.isTileMap ? convertTileLatLongToPoint(new MapLocation(long, lati), _this.maps.tileZoomLevel, _this.maps.tileTranslatePoint, true) : convertGeoToPoint(lati, long, factor, currentLayers, _this.maps);\n            var animate_1 = currentLayers.animationDuration !== 0 || isNullOrUndefined(_this.maps.zoomModule);\n            var transPoint = {\n              x: x,\n              y: y\n            };\n\n            if (eventArgs.template && !isNaN(location_1.x) && !isNaN(location_1.y)) {\n              markerTemplateCounts++;\n              markerTemplate(eventArgs, templateFn, markerID, data, markerIndex, markerTemplateElements, location_1, scale, offset, _this.maps);\n            } else if (!eventArgs.template && !isNaN(location_1.x) && !isNaN(location_1.y)) {\n              markerCounts++;\n              marker(eventArgs, markerSettings, markerDatas, dataIndex, location_1, transPoint, markerID, offset, scale, _this.maps, markerSVGObject);\n            }\n          }\n\n          nullCount += !isNaN(lati) && !isNaN(long) ? 0 : 1;\n          markerTemplateCounts += eventArgs.cancel ? 1 : 0;\n          markerCounts += eventArgs.cancel ? 1 : 0;\n          _this.maps.markerNullCount = !isNullOrUndefined(lati) || !isNullOrUndefined(long) ? _this.maps.markerNullCount : _this.maps.markerNullCount + 1;\n          var markerDataLength = markerDatas.length - _this.maps.markerNullCount;\n\n          if (markerSVGObject.childElementCount === markerDatas.length - markerTemplateCounts - nullCount && type !== 'Template') {\n            layerElement.appendChild(markerSVGObject);\n\n            if (currentLayers.markerClusterSettings.allowClustering) {\n              _this.maps.svgObject.appendChild(markerSVGObject);\n\n              _this.maps.element.appendChild(_this.maps.svgObject);\n\n              clusterTemplate(currentLayers, markerSVGObject, _this.maps, layerIndex, markerSVGObject, layerElement, true, true);\n            }\n          }\n\n          if (markerTemplateElements.childElementCount === markerDatas.length - markerCounts - nullCount && getElementByID(_this.maps.element.id + '_Secondary_Element')) {\n            getElementByID(_this.maps.element.id + '_Secondary_Element').appendChild(markerTemplateElements);\n\n            if (currentLayers.markerClusterSettings.allowClustering) {\n              clusterTemplate(currentLayers, markerTemplateElements, _this.maps, layerIndex, markerSVGObject, layerElement, false, true);\n            }\n          }\n        });\n      });\n    });\n  };\n\n  ;\n  /**\n   * To translate the layer template elements\n   * @private\n   */\n\n  Zoom.prototype.processTemplate = function (x, y, scale, maps) {\n    for (var i = 0; i < this.templateCount; i++) {\n      this.currentLayer = maps.layersCollection[i];\n      var factor = maps.mapLayerPanel.calculateFactor(this.currentLayer);\n      var markerTemplateElement = getElementByID(maps.element.id + '_LayerIndex_' + i + '_Markers_Template_Group');\n      var datalabelTemplateElemement = getElementByID(maps.element.id + '_LayerIndex_' + i + '_Label_Template_Group');\n\n      if (!isNullOrUndefined(markerTemplateElement) && markerTemplateElement.childElementCount > 0) {\n        for (var k = 0; k < markerTemplateElement.childElementCount; k++) {\n          this.markerTranslate(markerTemplateElement.childNodes[k], factor, x, y, scale, 'Template');\n        }\n      }\n\n      if (!isNullOrUndefined(datalabelTemplateElemement) && datalabelTemplateElemement.childElementCount > 0) {\n        for (var k = 0; k < datalabelTemplateElemement.childElementCount; k++) {\n          this.dataLabelTranslate(datalabelTemplateElemement.childNodes[k], factor, x, y, scale, 'Template');\n        }\n      }\n    }\n  }; //tslint:disable:max-func-body-length\n\n\n  Zoom.prototype.dataLabelTranslate = function (element, factor, x, y, scale, type, animate) {\n    if (animate === void 0) {\n      animate = false;\n    }\n\n    var labelCollection = this.maps.dataLabelModule.dataLabelCollections;\n    var zoomelement = element.getBoundingClientRect();\n    var text;\n    var trimmedLable;\n    var style = this.maps.layers[this.index].dataLabelSettings.textStyle;\n    var zoomtext;\n    var zoomtextSize;\n    var zoomtrimLabel;\n    var labelPath = this.maps.layers[this.index].dataLabelSettings.labelPath;\n    var layerIndex = parseFloat(element.id.split('_LayerIndex_')[1].split('_')[0]);\n    var shapeIndex = parseFloat(element.id.split('_shapeIndex_')[1].split('_')[0]);\n    var labelIndex;\n\n    if (element.id.indexOf('_LabelIndex_') > -1) {\n      labelIndex = parseFloat(element.id.split('_LabelIndex_')[1].split('_')[0]);\n    }\n\n    var duration = this.currentLayer.animationDuration;\n\n    for (var l = 0; l < labelCollection.length; l++) {\n      var label = labelCollection[l];\n\n      if (label['layerIndex'] === layerIndex && label['shapeIndex'] === shapeIndex && label['labelIndex'] === labelIndex) {\n        var labelX = label['location']['x'];\n        var labelY = label['location']['y'];\n\n        if (type === 'Template') {\n          var layerEle = getElementByID(this.maps.element.id + '_Layer_Collections');\n          labelX = Math.abs(this.maps.baseMapRectBounds['min']['x'] - labelX) * scale;\n          labelY = Math.abs(this.maps.baseMapRectBounds['min']['y'] - labelY) * scale;\n          var templateOffset = element.getBoundingClientRect();\n          var layerOffset = layerEle.getBoundingClientRect();\n          var elementOffset = element.parentElement.getBoundingClientRect();\n          var x_3 = labelX + (layerOffset.left - elementOffset.left) - templateOffset.width / 2;\n          var y_2 = labelY + (layerOffset.top - elementOffset.top) - templateOffset.height / 2;\n          element.style.left = x_3 + 'px';\n          element.style.top = y_2 + 'px';\n        } else {\n          labelX = (labelX + x) * scale;\n          labelY = (labelY + y) * scale;\n          zoomtext = label['dataLabelText'];\n          zoomtextSize = measureText(zoomtext, style);\n          var start = labelY - zoomtextSize['height'] / 4;\n          var end = labelY + zoomtextSize['height'] / 4;\n          var xpositionEnds = labelX + zoomtextSize['width'] / 2;\n          var xpositionStart = labelX - zoomtextSize['width'] / 2;\n          var textLocations = {\n            rightWidth: xpositionEnds,\n            leftWidth: xpositionStart,\n            heightTop: start,\n            heightBottom: end\n          };\n\n          if (!animate || duration === 0) {\n            element.setAttribute('transform', 'translate( ' + labelX + ' ' + labelY + ' )');\n          }\n\n          if (this.maps.layers[this.index].dataLabelSettings.smartLabelMode === 'Hide') {\n            if (scale > 1) {\n              text = this.zoomshapewidth['width'] >= zoomtextSize['width'] ? zoomtext : '';\n              element.innerHTML = text;\n            } else {\n              text = this.maps.dataLabelShape[l] >= zoomtextSize['width'] ? zoomtext : '';\n              element.innerHTML = text;\n            }\n          }\n\n          if (this.maps.layers[this.index].dataLabelSettings.smartLabelMode === 'Trim') {\n            if (scale > 1) {\n              zoomtrimLabel = textTrim(this.zoomshapewidth['width'], zoomtext, style);\n              text = zoomtrimLabel;\n              element.innerHTML = text;\n            } else {\n              zoomtrimLabel = textTrim(this.maps.dataLabelShape[l], zoomtext, style);\n              text = zoomtrimLabel;\n              element.innerHTML = text;\n            }\n          }\n\n          if (this.maps.layers[this.index].dataLabelSettings.intersectionAction === 'Hide') {\n            for (var m = 0; m < this.intersect.length; m++) {\n              if (!isNullOrUndefined(this.intersect[m])) {\n                if (textLocations['leftWidth'] > this.intersect[m]['rightWidth'] || textLocations['rightWidth'] < this.intersect[m]['leftWidth'] || textLocations['heightTop'] > this.intersect[m]['heightBottom'] || textLocations['heightBottom'] < this.intersect[m]['heightTop']) {\n                  text = !isNullOrUndefined(text) ? text : zoomtext;\n                  element.innerHTML = text;\n                } else {\n                  text = '';\n                  element.innerHTML = text;\n                  break;\n                }\n              }\n            }\n\n            this.intersect.push(textLocations);\n          }\n\n          if (this.maps.layers[this.index].dataLabelSettings.intersectionAction === 'Trim') {\n            for (var j = 0; j < this.intersect.length; j++) {\n              if (!isNullOrUndefined(this.intersect[j])) {\n                if (textLocations['rightWidth'] < this.intersect[j]['leftWidth'] || textLocations['leftWidth'] > this.intersect[j]['rightWidth'] || textLocations['heightBottom'] < this.intersect[j]['heightTop'] || textLocations['heightTop'] > this.intersect[j]['heightBottom']) {\n                  trimmedLable = !isNullOrUndefined(text) ? text : zoomtext;\n\n                  if (scale > 1) {\n                    trimmedLable = textTrim(this.zoomshapewidth['width'], trimmedLable, style);\n                  }\n\n                  element.innerHTML = trimmedLable;\n                } else {\n                  if (textLocations['leftWidth'] > this.intersect[j]['leftWidth']) {\n                    var width = this.intersect[j]['rightWidth'] - textLocations['leftWidth'];\n                    var difference = width - (textLocations['rightWidth'] - textLocations['leftWidth']);\n                    text = !isNullOrUndefined(text) ? text : zoomtext;\n                    trimmedLable = textTrim(difference, text, style);\n                    element.innerHTML = trimmedLable;\n                    break;\n                  }\n\n                  if (textLocations['leftWidth'] < this.intersect[j]['leftWidth']) {\n                    var width = textLocations['rightWidth'] - this.intersect[j]['leftWidth'];\n                    var difference = Math.abs(width - (textLocations['rightWidth'] - textLocations['leftWidth']));\n                    text = !isNullOrUndefined(text) ? text : zoomtext;\n                    trimmedLable = textTrim(difference, text, style);\n                    element.innerHTML = trimmedLable;\n                    break;\n                  }\n                }\n              }\n            }\n\n            this.intersect.push(textLocations);\n\n            if (isNullOrUndefined(trimmedLable)) {\n              trimmedLable = textTrim(this.zoomshapewidth['width'], zoomtext, style);\n              element.innerHTML = trimmedLable;\n            }\n          } else {\n            smoothTranslate(element, 0, duration, new MapLocation(labelX, labelY));\n          }\n        }\n      }\n    }\n  };\n\n  Zoom.prototype.markerTranslate = function (element, factor, x, y, scale, type, animate) {\n    if (animate === void 0) {\n      animate = false;\n    }\n\n    var layerIndex = parseInt(element.id.split('_LayerIndex_')[1].split('_')[0], 10);\n    var markerIndex = parseInt(element.id.split('_MarkerIndex_')[1].split('_')[0], 10);\n    var dataIndex = parseInt(element.id.split('_dataIndex_')[1].split('_')[0], 10);\n    var layer = this.maps.layersCollection[layerIndex];\n    var marker = layer.markerSettings[markerIndex];\n\n    if (!isNullOrUndefined(marker) && !isNullOrUndefined(marker.dataSource) && !isNullOrUndefined(marker.dataSource[dataIndex])) {\n      if (this.maps.isBlazor) {\n        marker.longitudeValuePath = !isNullOrUndefined(marker.longitudeValuePath) ? marker.longitudeValuePath : !isNullOrUndefined(marker.dataSource[dataIndex]['Longitude']) ? 'Longitude' : !isNullOrUndefined(marker.dataSource[dataIndex]['longitude']) ? 'longitude' : null;\n        marker.latitudeValuePath = !isNullOrUndefined(marker.latitudeValuePath) ? marker.latitudeValuePath : !isNullOrUndefined(marker.dataSource[dataIndex]['Latitude']) ? 'Latitude' : !isNullOrUndefined(marker.dataSource[dataIndex]['latitude']) ? 'latitude' : null;\n        var data1 = {};\n        var j = 0;\n        var text = [];\n\n        for (var i = 0; i < Object.keys(marker.dataSource[dataIndex]).length; i++) {\n          if (Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'text' && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'longitude' && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'latitude' && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'blazortemplateid' && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'name') {\n            data1['text'] = text;\n            text[j] = marker.dataSource[dataIndex][Object.keys(marker.dataSource[dataIndex])[i].toLowerCase()];\n            j++;\n          }\n        }\n\n        marker.dataSource[dataIndex]['text'] = data1['text'];\n      }\n\n      var lng = !isNullOrUndefined(marker.longitudeValuePath) ? Number(getValueFromObject(marker.dataSource[dataIndex], marker.longitudeValuePath)) : !isNullOrUndefined(marker.dataSource[dataIndex]['longitude']) ? parseFloat(marker.dataSource[dataIndex]['longitude']) : !isNullOrUndefined(marker.dataSource[dataIndex]['Latitude']) ? parseFloat(marker.dataSource[dataIndex]['Latitude']) : 0;\n      var lat = !isNullOrUndefined(marker.latitudeValuePath) ? Number(getValueFromObject(marker.dataSource[dataIndex], marker.latitudeValuePath)) : !isNullOrUndefined(marker.dataSource[dataIndex]['latitude']) ? parseFloat(marker.dataSource[dataIndex]['latitude']) : !isNullOrUndefined(marker.dataSource[dataIndex]['Latitude']) ? parseFloat(marker.dataSource[dataIndex]['Latitude']) : 0;\n      var duration = this.currentLayer.animationDuration;\n      var location_2 = this.maps.isTileMap ? convertTileLatLongToPoint(new Point(lng, lat), this.maps.tileZoomLevel, this.maps.tileTranslatePoint, true) : convertGeoToPoint(lat, lng, factor, layer, this.maps);\n\n      if (this.maps.isTileMap) {\n        if (type === 'Template') {\n          var templateOffset = element.getBoundingClientRect();\n          element.style.left = location_2.x - templateOffset.width / 2 + marker.offset.x + 'px';\n          element.style.top = location_2.y - templateOffset.height / 2 + marker.offset.y + 'px';\n\n          if (this.maps.layers[this.maps.baseLayerIndex].layerType === 'GoogleStaticMap') {\n            var staticMapOffset = getElementByID(this.maps.element.id + '_StaticGoogleMap').getBoundingClientRect();\n            var staticMapOffsetWidth = 640;\n\n            if (element['style']['display'] !== 'none') {\n              if ((staticMapOffset['x'] > templateOffset['x'] || staticMapOffset['x'] + staticMapOffsetWidth < templateOffset['x'] + templateOffset['width']) && (staticMapOffset['y'] > templateOffset['y'] || staticMapOffset['y'] + staticMapOffset['height'] < templateOffset['y'] + templateOffset['height'])) {\n                element['style']['display'] = 'none';\n              } else if (staticMapOffset['x'] > templateOffset['x'] || staticMapOffset['x'] + staticMapOffsetWidth < templateOffset['x'] + templateOffset['width']) {\n                element['style']['display'] = 'none';\n              }\n            }\n          }\n        } else {\n          location_2.x += marker.offset.x;\n          location_2.y += marker.offset.y;\n          element.setAttribute('transform', 'translate( ' + location_2.x + ' ' + location_2.y + ' )');\n        }\n      } else {\n        if (type === 'Template') {\n          location_2.x = Math.abs(this.maps.baseMapRectBounds['min']['x'] - location_2.x) * scale;\n          location_2.y = Math.abs(this.maps.baseMapRectBounds['min']['y'] - location_2.y) * scale;\n          var layerOffset = getElementByID(this.maps.element.id + '_Layer_Collections').getBoundingClientRect();\n          var elementOffset = element.parentElement.getBoundingClientRect();\n          element.style.left = location_2.x + (layerOffset.left - elementOffset.left) + marker.offset.x + 'px';\n          element.style.top = location_2.y + (layerOffset.top - elementOffset.top) + marker.offset.y + 'px';\n          element.style.transform = 'translate(-50%, -50%)';\n        } else {\n          location_2.x = (location_2.x + x) * scale + marker.offset.x;\n          location_2.y = (location_2.y + y) * scale + marker.offset.y;\n\n          if (!animate || duration === 0) {\n            element.setAttribute('transform', 'translate( ' + location_2.x + ' ' + location_2.y + ' )');\n          } else {\n            smoothTranslate(element, 0, duration, location_2);\n          }\n        }\n      }\n    }\n  };\n\n  Zoom.prototype.panning = function (direction, xDifference, yDifference, mouseLocation) {\n    var map = this.maps;\n    var panArgs;\n    var down = this.mouseDownPoints;\n    var move = this.mouseMovePoints;\n    var scale = map.scale;\n    map.markerZoomedState = false;\n    map.zoomPersistence = map.enablePersistence;\n    map.defaultState = false;\n    map.initialCheck = false;\n    var translatePoint = map.translatePoint;\n    var prevTilePoint = map.tileTranslatePoint;\n    var x;\n    var y;\n    xDifference = !isNullOrUndefined(xDifference) ? xDifference : down.x - move.x;\n    yDifference = !isNullOrUndefined(yDifference) ? yDifference : down.y - move.y;\n\n    if (!map.isTileMap) {\n      x = translatePoint.x - xDifference / scale;\n      y = translatePoint.y - yDifference / scale;\n      var layerRect = getElementByID(map.element.id + '_Layer_Collections').getBoundingClientRect();\n      var elementRect = getElementByID(map.element.id + '_svg').getBoundingClientRect();\n      var panningXDirection = xDifference < 0 ? layerRect.left <= elementRect.left + map.mapAreaRect.x : layerRect.left + layerRect.width >= elementRect.left + elementRect.width + map.mapAreaRect.x + map.margin.left;\n      var panningYDirection = yDifference < 0 ? layerRect.top <= elementRect.top + map.mapAreaRect.y : layerRect.top + layerRect.height + map.margin.top >= elementRect.top + elementRect.height;\n      var location_3 = this.maps.getGeoLocation(this.maps.layersCollection.length - 1, mouseLocation);\n      panArgs = {\n        cancel: false,\n        name: pan,\n        maps: !map.isBlazor ? map : null,\n        tileTranslatePoint: {},\n        translatePoint: {\n          previous: translatePoint,\n          current: new Point(x, y)\n        },\n        scale: map.scale,\n        tileZoomLevel: map.tileZoomLevel,\n        latitude: location_3['latitude'],\n        longitude: location_3['longitude']\n      };\n      map.trigger(pan, panArgs);\n\n      if (!panArgs.cancel) {\n        if (panningXDirection && panningYDirection) {\n          map.translatePoint = new Point(x, y);\n          this.applyTransform();\n        } else if (panningXDirection) {\n          map.translatePoint = new Point(x, map.translatePoint.y);\n          this.applyTransform();\n        } else if (panningYDirection) {\n          map.translatePoint = new Point(map.translatePoint.x, y);\n          this.applyTransform();\n        }\n      }\n\n      this.maps.zoomNotApplied = false;\n    } else if (this.maps.tileZoomLevel > 1) {\n      x = map.tileTranslatePoint.x - xDifference;\n      y = map.tileTranslatePoint.y - yDifference;\n      this.distanceX = x - map.tileTranslatePoint.x;\n      this.distanceY = y - map.tileTranslatePoint.y;\n      map.tileTranslatePoint.x = x;\n      map.tileTranslatePoint.y = y;\n\n      if (map.tileTranslatePoint.y > -10 && yDifference < 0 || map.tileTranslatePoint.y < -((Math.pow(2, this.maps.tileZoomLevel) - 2) * 256) && yDifference > 0) {\n        map.tileTranslatePoint.x = x + xDifference;\n        map.tileTranslatePoint.y = y + yDifference;\n      }\n\n      map.translatePoint.x = (map.tileTranslatePoint.x - xDifference) / map.scale;\n      map.translatePoint.y = (map.tileTranslatePoint.y - yDifference) / map.scale;\n      var location_4 = this.maps.getTileGeoLocation(mouseLocation);\n      panArgs = {\n        cancel: false,\n        name: pan,\n        maps: !map.isBlazor ? map : null,\n        tileTranslatePoint: {\n          previous: prevTilePoint,\n          current: map.tileTranslatePoint\n        },\n        translatePoint: {\n          previous: translatePoint,\n          current: map.translatePoint\n        },\n        scale: map.scale,\n        tileZoomLevel: map.tileZoomLevel,\n        latitude: location_4['latitude'],\n        longitude: location_4['longitude']\n      };\n      map.trigger(pan, panArgs);\n      map.mapLayerPanel.generateTiles(map.tileZoomLevel, map.tileTranslatePoint, 'Pan');\n      this.applyTransform();\n    }\n\n    map.zoomTranslatePoint = map.translatePoint;\n    this.mouseDownPoints = this.mouseMovePoints;\n    this.maps.zoomNotApplied = false;\n    this.isSingleClick = false;\n  };\n\n  Zoom.prototype.toAlignSublayer = function () {\n    this.maps.translatePoint.x = !isNullOrUndefined(this.distanceX) ? this.maps.translatePoint.x - this.distanceX / this.maps.scale : this.maps.translatePoint.x;\n    this.maps.translatePoint.y = !isNullOrUndefined(this.distanceY) ? this.maps.translatePoint.y - this.distanceY / this.maps.scale : this.maps.translatePoint.y;\n    this.applyTransform(false);\n  };\n\n  Zoom.prototype.toolBarZooming = function (zoomFactor, type) {\n    var _this = this;\n\n    var map = this.maps;\n    map.initialCheck = false;\n    map.defaultState = type === 'Reset' && zoomFactor === 1 && !(map.zoomSettings.resetToInitial && map.applyZoomReset) || type === 'ZoomOut' && zoomFactor === 1;\n    var prevLevel = map.tileZoomLevel;\n    var scale = map.previousScale = map.scale;\n    map.markerZoomedState = false;\n    map.zoomPersistence = map.enablePersistence;\n    map.mapScaleValue = zoomFactor;\n    var maxZoom = map.zoomSettings.maxZoom;\n    var minZoom = map.zoomSettings.minZoom;\n    var size = map.mapAreaRect;\n    var translatePoint = map.previousPoint = map.translatePoint;\n    var prevTilePoint = map.tileTranslatePoint;\n    map.previousProjection = map.projectionType;\n    zoomFactor = type === 'ZoomOut' ? Math.round(zoomFactor) === 1 ? 1 : zoomFactor : zoomFactor;\n    zoomFactor = type === 'Reset' ? 1 : Math.round(zoomFactor) === 0 ? 1 : zoomFactor;\n    zoomFactor = minZoom > zoomFactor && type === 'ZoomIn' ? minZoom + 1 : zoomFactor;\n    var zoomArgs;\n\n    if (!map.isTileMap && (type === 'ZoomIn' ? zoomFactor >= minZoom && zoomFactor <= maxZoom : zoomFactor >= minZoom || map.isReset)) {\n      var min = map.baseMapRectBounds['min'];\n      var max = map.baseMapRectBounds['max'];\n      var mapWidth = Math.abs(max['x'] - min['x']);\n      var mapHeight = Math.abs(min['y'] - max['y']);\n      var translatePointX = translatePoint.x - (size.width / scale - size.width / zoomFactor) / 2;\n      var translatePointY = translatePoint.y - (size.height / scale - size.height / zoomFactor) / 2;\n      var currentHeight = Math.abs(map.baseMapRectBounds['max']['y'] - map.baseMapRectBounds['min']['y']) * zoomFactor;\n      translatePointX = currentHeight < map.mapAreaRect.height ? size.x + (-min['x'] + (size.width / 2 - mapWidth / 2)) : translatePointX;\n      translatePointY = currentHeight < map.mapAreaRect.height ? size.y + (-min['y'] + (size.height / 2 - mapHeight / 2)) : translatePointY;\n      map.translatePoint = new Point(translatePointX, translatePointY);\n      map.zoomTranslatePoint = map.translatePoint;\n      map.scale = zoomFactor;\n      this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n      this.applyTransform(true);\n    } else if (map.isTileMap && (zoomFactor >= minZoom && zoomFactor <= maxZoom || map.isReset)) {\n      var tileZoomFactor = prevLevel < minZoom && !map.isReset ? minZoom : zoomFactor;\n      map.scale = Math.pow(2, tileZoomFactor - 1);\n      map.tileZoomLevel = tileZoomFactor;\n      var position = {\n        x: map.availableSize.width / 2,\n        y: map.availableSize.height / 2\n      };\n      this.getTileTranslatePosition(prevLevel, tileZoomFactor, position, type);\n\n      if (map.zoomSettings.resetToInitial && map.applyZoomReset && type === 'Reset' || type === 'ZoomOut' && map.zoomSettings.resetToInitial && map.applyZoomReset && tileZoomFactor <= map.initialZoomLevel) {\n        map.initialCheck = true;\n        map.zoomPersistence = false;\n        map.tileTranslatePoint.x = map.initialTileTranslate.x;\n        map.tileTranslatePoint.y = map.initialTileTranslate.y;\n        tileZoomFactor = map.tileZoomLevel = map.mapScaleValue = map.initialZoomLevel;\n      }\n\n      this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n      map.translatePoint.y = (map.tileTranslatePoint.y - 0.01 * map.scale) / map.scale;\n      map.translatePoint.x = (map.tileTranslatePoint.x - 0.01 * map.scale) / map.scale;\n\n      if (document.getElementById(this.maps.element.id + '_LayerIndex_1')) {\n        document.getElementById(this.maps.element.id + '_LayerIndex_1').style.display = 'none';\n      }\n\n      if (document.querySelector('.GroupElement')) {\n        document.querySelector('.GroupElement').style.display = 'none';\n      }\n\n      map.mapLayerPanel.generateTiles(tileZoomFactor, map.tileTranslatePoint, type);\n      var element1 = document.getElementById(this.maps.element.id + '_tiles');\n      setTimeout(function () {\n        if (type === 'ZoomOut' || type === \"Reset\") {// element1.removeChild(element1.children[element1.childElementCount - 1]);\n          // element1.childElementCount ? element1.removeChild(element1.children[element1.childElementCount - 1]) : element1;\n        }\n\n        _this.applyTransform(true);\n\n        if (document.getElementById(_this.maps.element.id + '_LayerIndex_1')) {\n          document.getElementById(_this.maps.element.id + '_LayerIndex_1').style.display = 'block';\n        }\n      }, 250);\n    }\n\n    this.maps.zoomNotApplied = false;\n  };\n  /* tslint:disable:max-func-body-length */\n\n\n  Zoom.prototype.createZoomingToolbars = function () {\n    var map = this.maps;\n    this.toolBarGroup = map.renderer.createGroup({\n      id: map.element.id + '_Zooming_KitCollection',\n      opacity: 0.3\n    });\n    var kitHeight = 16;\n    var kitWidth = 16;\n    var xSpacing = 15;\n    var ySpacing = 15;\n    var padding = 20;\n    var orientation = map.zoomSettings.toolBarOrientation;\n    var toolbarsCollection = map.zoomSettings.toolbars;\n    var shadowElement = '<filter id=\"chart_shadow\" height=\"130%\"><feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"5\"/>';\n    shadowElement += '<feOffset dx=\"-3\" dy=\"4\" result=\"offsetblur\"/><feComponentTransfer><feFuncA type=\"linear\" slope=\"1\"/>';\n    shadowElement += '</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>';\n    var toolBarLength = map.zoomSettings.toolbars.length;\n    var toolWidth = map.zoomSettings.toolBarOrientation === 'Horizontal' ? toolBarLength * kitWidth + toolBarLength * padding : kitWidth * 2;\n    var toolHeight = map.zoomSettings.toolBarOrientation === 'Horizontal' ? kitHeight * 2 : toolBarLength * kitHeight + toolBarLength * padding;\n    this.toolBarGroup.appendChild(map.renderer.drawRectangle(new RectOption(map.element.id + '_Zooming_Rect', 'transparent', {\n      color: 'transparent',\n      width: 1\n    }, 1, new Rect(0, 0, toolWidth, toolHeight), 0, 0)));\n    var defElement = map.renderer.createDefs();\n    defElement.innerHTML = shadowElement;\n    this.toolBarGroup.appendChild(defElement);\n    var outerElement = map.renderer.drawRectangle(new RectOption(map.element.id + '_Zooming_Rect', 'transparent', {\n      color: 'transparent',\n      width: 1\n    }, 0.1, new Rect(0, 0, toolWidth, toolHeight), 0, 0));\n    outerElement.setAttribute('filter', 'url(#chart_shadow)');\n    this.toolBarGroup.appendChild(outerElement);\n    var performFunction;\n\n    for (var i = 0; i < toolbarsCollection.length; i++) {\n      var toolbar_1 = toolbarsCollection[i];\n      var pathOptions = void 0;\n      var polyOptions = void 0;\n      this.currentToolbarEle = map.renderer.createGroup({\n        id: map.element.id + '_Zooming_ToolBar_' + toolbar_1 + '_Group',\n        transform: 'translate( ' + xSpacing + ' ' + ySpacing + ' ) '\n      });\n      this.currentToolbarEle.setAttribute('class', 'e-maps-toolbar');\n      var fillColor = '';\n      var fill = 'transparent';\n      var direction = '';\n      var polygonDirection = '';\n\n      switch (toolbar_1.toLowerCase()) {\n        case 'zoom':\n          var fillColor_1 = void 0;\n          var strokeColor = void 0;\n          direction = 'M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,';\n          direction += '5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571';\n          direction = direction + 'L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,';\n\n          if (this.maps.zoomSettings.enablePanning && !this.maps.zoomSettings.enableSelectionZooming) {\n            fillColor_1 = fill;\n            strokeColor = this.maps.themeStyle.zoomFillColor;\n          } else if (this.maps.zoomSettings.enablePanning && this.maps.zoomSettings.enableSelectionZooming) {\n            fillColor_1 = fill;\n            strokeColor = this.maps.themeStyle.zoomFillColor;\n          } else if (!this.maps.zoomSettings.enablePanning && !this.maps.zoomSettings.enableSelectionZooming) {\n            fillColor_1 = fill;\n            strokeColor = this.maps.themeStyle.zoomFillColor;\n          } else {\n            fillColor_1 = this.selectionColor;\n            strokeColor = this.selectionColor;\n          }\n\n          this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, fillColor_1, 1, strokeColor, 1, null, direction + '4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z')));\n          this.zoomElements = this.currentToolbarEle;\n          this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n          break;\n\n        case 'zoomin':\n          direction = 'M 8, 0 L 8, 16 M 0, 8 L 16, 8';\n          this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1 + '_Path', fill, 3, this.maps.themeStyle.zoomFillColor, 1, null, direction)));\n          this.zoomInElements = this.currentToolbarEle;\n          this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n          break;\n\n        case 'zoomout':\n          direction = 'M 0, 8 L 16, 8';\n          this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, fill, 3, this.maps.themeStyle.zoomFillColor, 1, null, direction)));\n          this.zoomOutElements = this.currentToolbarEle;\n          this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n          break;\n\n        case 'pan':\n          var color = void 0;\n          direction = 'M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,';\n          direction += '11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z';\n\n          if (this.maps.zoomSettings.enablePanning && this.maps.zoomModule.isDragZoom) {\n            color = \"#737373\";\n          } else if (!this.maps.zoomSettings.enablePanning) {\n            color = \"#737373\";\n            this.currentToolbarEle.setAttribute('class', '');\n          } else {\n            color = this.selectionColor;\n          }\n\n          this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, color, 1, color, 1, null, direction)));\n          this.panColor = color;\n          this.panElements = this.currentToolbarEle;\n          this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n          break;\n\n        case 'reset':\n          direction = 'M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,';\n          direction += '1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,';\n          direction += '13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,';\n          this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, this.fillColor, null, this.maps.themeStyle.zoomFillColor, 1, null, direction + '3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z')));\n          this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n          break;\n      }\n\n      this.currentToolbarEle.appendChild(map.renderer.drawCircle(new CircleOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1 + '_Rect', fill, {\n        color: this.maps.themeStyle.zoomFillColor,\n        width: 1\n      }, 1, 8, 8, 16, '')));\n      xSpacing = orientation === 'Horizontal' ? xSpacing + (kitWidth + padding) : xSpacing;\n      ySpacing = orientation === 'Horizontal' ? ySpacing : ySpacing + (kitHeight + padding);\n      this.toolBarGroup.appendChild(this.currentToolbarEle);\n    }\n  };\n\n  Zoom.prototype.performToolBarAction = function (e) {\n    var target = e.target;\n    e.stopImmediatePropagation();\n    var isTouch = e.pointerType === 'touch' || e.pointerType === '2' || e.type.indexOf('touch') > -1;\n    var toolbar = target.id.split('_Zooming_ToolBar_')[1].split('_')[0];\n\n    if (isTouch) {\n      this.handled = true;\n      this.performZoomingByToolBar(toolbar);\n    } else if ((e.type === 'mousedown' || e.type === 'pointerdown') && !this.handled) {\n      this.handled = false;\n      this.performZoomingByToolBar(toolbar);\n    } else {\n      this.handled = false;\n    }\n  };\n  /**\n   *\n   * @private\n   */\n\n\n  Zoom.prototype.performZoomingByToolBar = function (type) {\n    var map = this.maps;\n    map.isReset = false;\n\n    switch (type.toLowerCase()) {\n      case 'zoom':\n        this.panColor = this.fillColor;\n        this.zoomColor = this.selectionColor;\n        this.applySelection(this.zoomElements, this.selectionColor);\n        this.applySelection(this.panElements, this.fillColor);\n        break;\n\n      case 'pan':\n        if (!this.maps.zoomSettings.enablePanning) {\n          this.panColor = '#737373';\n        } else {\n          this.panColor = this.selectionColor;\n        }\n\n        this.zoomColor = this.fillColor;\n\n        if (!this.maps.zoomSettings.enablePanning) {\n          this.applySelection(this.zoomElements, this.selectionColor);\n          this.applySelection(this.panElements, this.panColor);\n        } else {\n          this.applySelection(this.zoomElements, this.fillColor);\n          this.applySelection(this.panElements, this.panColor);\n        }\n\n        break;\n\n      case 'zoomin':\n        map.staticMapZoom = map.tileZoomLevel;\n\n        if (map.staticMapZoom > 0 && map.staticMapZoom < 22) {\n          map.staticMapZoom += 1;\n        }\n\n        this.toolBarZooming((map.isTileMap ? map.tileZoomLevel : map.scale) + 1, 'ZoomIn');\n        break;\n\n      case 'zoomout':\n        map.staticMapZoom = map.tileZoomLevel;\n        map.markerCenterLatitude = null;\n        map.markerCenterLongitude = null;\n        this.toolBarZooming((map.isTileMap ? map.tileZoomLevel : map.scale) - 1, 'ZoomOut');\n        break;\n\n      case 'reset':\n        map.staticMapZoom = map.zoomSettings.enable ? map.zoomSettings.zoomFactor : 0;\n        map.markerCenterLatitude = null;\n        map.markerCenterLongitude = null;\n        this.toolBarZooming(1, 'Reset');\n\n        if (!this.maps.zoomSettings.enablePanning) {\n          this.applySelection(this.zoomElements, this.selectionColor);\n          this.applySelection(this.panElements, '#737373');\n        } else {\n          this.applySelection(this.zoomElements, this.fillColor);\n          this.applySelection(this.panElements, this.selectionColor);\n        }\n\n    }\n\n    this.panningStyle(type.toLowerCase());\n  };\n\n  Zoom.prototype.panningStyle = function (toolbar) {\n    var svg = getElementByID(this.maps.element.id + '_svg');\n\n    if (toolbar === 'pan' || this.isPanning) {\n      svg.setAttribute('class', 'e-maps-panning');\n    } else {\n      svg.setAttribute('class', '');\n    }\n  };\n\n  Zoom.prototype.applySelection = function (elements, color) {\n    if (!elements) {\n      return;\n    }\n\n    var childElement;\n\n    for (var i = 0; i < elements.childElementCount; i++) {\n      childElement = elements.childNodes[i];\n\n      if (childElement.tagName !== 'circle') {\n        childElement.setAttribute('fill', color);\n        childElement.setAttribute('stroke', color);\n      }\n    }\n  };\n\n  Zoom.prototype.showTooltip = function (e) {\n    var text = e.target.id.split('_Zooming_ToolBar_')[1].split('_')[0];\n\n    if (!this.isTouch) {\n      createTooltip('EJ2_Map_Toolbar_Tip', this.maps.getLocalizedLabel(text), e.pageY + 10, e.pageX + 10, '10px');\n    }\n  };\n\n  Zoom.prototype.removeTooltip = function () {\n    if (getElementByID('EJ2_Map_Toolbar_Tip')) {\n      remove(getElementByID('EJ2_Map_Toolbar_Tip'));\n    }\n  };\n\n  Zoom.prototype.alignToolBar = function () {\n    var map = this.maps;\n    var padding = 10;\n    var element = createElement('div', {\n      id: map.element.id + '_ToolBar',\n      styles: 'position:absolute;z-index:2'\n    });\n    var rectSVGObject = map.renderer.createSvg({\n      id: map.element.id + '_Zooming_ToolBar',\n      width: 10,\n      height: 10\n    });\n    rectSVGObject.appendChild(this.toolBarGroup);\n    element.appendChild(rectSVGObject);\n\n    if (getElementByID(map.element.id + '_Secondary_Element')) {\n      getElementByID(map.element.id + '_Secondary_Element').appendChild(element);\n    }\n\n    var toolBarSize = this.toolBarGroup.getBoundingClientRect();\n    rectSVGObject.setAttribute('height', (toolBarSize.height + padding / 2).toString());\n    rectSVGObject.setAttribute('width', (toolBarSize.width + padding / 2).toString());\n    var size = !isNullOrUndefined(map.totalRect) ? map.totalRect : map.mapAreaRect;\n    var x = 0;\n    var y = 0;\n\n    switch (map.zoomSettings.verticalAlignment) {\n      case 'Near':\n        y = size.y;\n        break;\n\n      case 'Center':\n        y = size.height / 2 - toolBarSize.height / 2;\n        break;\n\n      case 'Far':\n        y = size.height - toolBarSize.height - padding;\n        break;\n    }\n\n    switch (map.zoomSettings.horizontalAlignment) {\n      case 'Near':\n        x = size.x;\n        break;\n\n      case 'Center':\n        x = size.width / 2 - toolBarSize.width / 2;\n        break;\n\n      case 'Far':\n        x = size.width - toolBarSize.width - padding;\n        break;\n    }\n\n    element.style.left = x + 'px';\n    element.style.top = y + 'px';\n    var color = this.maps.zoomSettings.highlightColor;\n    var css = ' .e-maps-toolbar:hover > circle { stroke:' + color + '; } .e-maps-toolbar:hover > path { fill: ' + color + ' ;  stroke: ' + color + '; }' + '.e-maps-toolbar:hover { cursor: pointer; } .e-maps-cursor-disable:hover { cursor: not-allowed; } .e-maps-panning:hover { cursor: pointer; } ' + '.e-maps-popup-close { display: block; opacity: 0; }';\n    var style = document.createElement('style');\n    style.appendChild(document.createTextNode(css));\n    element.appendChild(style);\n  };\n  /**\n   * To bind events.\n   * @return {void}\n   * @private\n   */\n\n\n  Zoom.prototype.wireEvents = function (element, process) {\n    EventHandler.add(element, Browser.touchStartEvent, process, this);\n    EventHandler.add(element, 'mouseover', this.showTooltip, this);\n    EventHandler.add(element, 'mouseout', this.removeTooltip, this);\n  };\n\n  Zoom.prototype.mapMouseWheel = function (e) {\n    if (this.maps.zoomSettings.enable && this.maps.zoomSettings.mouseWheelZoom) {\n      var map = this.maps;\n      var size = map.availableSize;\n      map.markerZoomedState = false;\n      map.zoomPersistence = map.enablePersistence;\n      var position = this.getMousePosition(e.pageX, e.pageY);\n      var prevLevel = map.tileZoomLevel;\n      var prevScale = map.scale;\n      var delta = 1;\n      var staticMaxZoomLevel = 22; // google map maximum zoom level value\n\n      var value = map.isTileMap ? prevLevel : prevScale;\n\n      if (position.x > map.mapAreaRect.x && position.x < map.mapAreaRect.x + map.mapAreaRect.width && position.y > map.mapAreaRect.y && position.y < map.mapAreaRect.y + map.mapAreaRect.height) {\n        e.preventDefault();\n        var direction = this.browserName === 'mozilla' && !this.isPointer ? -e.detail / 3 > 0 ? 'ZoomIn' : 'ZoomOut' : e.wheelDelta / 120 > 0 ? 'ZoomIn' : 'ZoomOut';\n\n        if (direction === 'ZoomIn') {\n          map.mapScaleValue = value + delta;\n          map.staticMapZoom = map.tileZoomLevel;\n\n          if (map.staticMapZoom > 0 && map.staticMapZoom < staticMaxZoomLevel) {\n            map.staticMapZoom += 1;\n          }\n\n          this.performZooming(position, value + delta, direction);\n        } else {\n          map.mapScaleValue = value - delta;\n          map.staticMapZoom = map.tileZoomLevel;\n\n          if (map.mapScaleValue === 1) {\n            map.markerCenterLatitude = null;\n            map.markerCenterLongitude = null;\n          }\n\n          if (map.staticMapZoom > 1 && map.staticMapZoom < staticMaxZoomLevel) {\n            map.staticMapZoom -= 1;\n          }\n\n          this.performZooming(position, value - delta, direction);\n        }\n      }\n    }\n  };\n\n  Zoom.prototype.doubleClick = function (e) {\n    var pageX = e.pageX;\n    var pageY = e.pageY;\n    var target = e.target;\n\n    if (this.maps.zoomSettings.enable && this.maps.zoomSettings.doubleClickZoom && !(e.target['id'].indexOf('_Zooming_') > -1)) {\n      var position = this.getMousePosition(pageX, pageY);\n      var map = this.maps;\n      var size = map.availableSize;\n      var prevLevel = map.tileZoomLevel;\n      var prevScale = map.scale;\n      map.mapScaleValue = map.mapScaleValue + 1;\n      var value = map.isTileMap ? prevLevel : prevScale;\n\n      if (position.x > map.mapAreaRect.x && position.x < map.mapAreaRect.x + map.mapAreaRect.width && position.y > map.mapAreaRect.y && position.y < map.mapAreaRect.y + map.mapAreaRect.height) {\n        this.performZooming(position, value + 1, 'ZoomIn');\n      }\n    }\n  };\n\n  Zoom.prototype.mouseDownHandler = function (e) {\n    var pageX;\n    var pageY;\n    var target;\n    var touches = null;\n    var element = e.target;\n\n    if (e.type === 'touchstart') {\n      this.isTouch = true;\n      touches = e.touches;\n      target = e.target;\n      pageX = touches[0].clientX;\n      pageY = touches[0].clientY;\n    } else {\n      pageX = e.pageX;\n      pageY = e.pageY;\n      target = e.target;\n    }\n\n    if (!this.maps.zoomSettings.enablePanning) {\n      this.isPanning = this.panColor !== this.selectionColor ? this.maps.zoomSettings.enablePanning : this.zoomColor === this.selectionColor;\n    } else {\n      this.isPanning = this.panColor === this.selectionColor ? this.maps.zoomSettings.enablePanning : this.zoomColor !== this.selectionColor;\n    }\n\n    this.mouseDownLatLong = {\n      x: pageX,\n      y: pageY\n    };\n    this.rectZoomingStart = !this.isPanning && this.maps.zoomSettings.enable;\n    this.mouseDownPoints = this.getMousePosition(pageX, pageY);\n\n    if (this.isTouch) {\n      this.firstMove = true;\n      this.pinchFactor = this.maps.scale;\n      this.fingers = touches.length;\n    }\n\n    this.isSingleClick = true;\n  };\n\n  Zoom.prototype.mouseMoveHandler = function (e) {\n    var pageX;\n    var pageY;\n    var map = this.maps;\n    var touchArg;\n    var target;\n    var touches = null;\n    var zoom = this.maps.zoomSettings;\n\n    if (e.type === 'touchmove') {\n      this.isTouch = true;\n      target = e.target;\n      touches = e.touches;\n      pageX = touches[0].clientX;\n      pageY = touches[0].clientY;\n    } else {\n      pageX = e.pageX;\n      pageY = e.pageY;\n      target = e.target;\n    }\n\n    if (getElementByID(map.element.id + '_Zooming_KitCollection')) {\n      if (target.id.indexOf('_Zooming_') > -1) {\n        getElementByID(map.element.id + '_Zooming_KitCollection').setAttribute('opacity', '1');\n\n        if (document.getElementById(map.element.id + '_Zooming_ToolBar_Pan_Group')) {\n          if (!this.maps.zoomSettings.enablePanning) {\n            if (target.id.indexOf('_Zooming_ToolBar') > -1 || target.id.indexOf('_Zooming_Rect') > -1) {\n              getElementByID(map.element.id + '_Zooming_ToolBar_Pan_Rect').setAttribute('opacity', '0.3');\n              getElementByID(map.element.id + '_Zooming_ToolBar_Pan').setAttribute('opacity', '0.3');\n            }\n          }\n        }\n      } else {\n        getElementByID(map.element.id + '_Zooming_KitCollection').setAttribute('opacity', '0.3');\n\n        if (!this.maps.zoomSettings.enablePanning && document.getElementById(map.element.id + '_Zooming_ToolBar_Pan_Group')) {\n          getElementByID(map.element.id + '_Zooming_ToolBar_Pan_Rect').setAttribute('opacity', '1');\n          getElementByID(map.element.id + '_Zooming_ToolBar_Pan').setAttribute('opacity', '1');\n        }\n      }\n    }\n\n    if (this.isTouch) {\n      if (this.maps.zoomSettings.pinchZooming) {\n        if (this.firstMove && touches.length === 2) {\n          this.rectZoomingStart = false;\n          this.updateInteraction();\n          this.touchStartList = targetTouches(e);\n        } else if (this.touchStartList.length === 2 && touches.length === 2) {\n          this.touchMoveList = targetTouches(e);\n          e.preventDefault();\n          this.rectZoomingStart = false;\n          this.performPinchZooming(e);\n        }\n\n        this.firstMove = false;\n      }\n    }\n\n    this.mouseMovePoints = this.getMousePosition(pageX, pageY);\n    var targetId = e.target['id'];\n    var targetEle = e.target;\n\n    if (zoom.enable && this.isPanning && (Browser.isDevice && touches.length > 1 || !Browser.isDevice)) {\n      e.preventDefault();\n      this.maps.element.style.cursor = 'pointer';\n      this.mouseMoveLatLong = {\n        x: pageX,\n        y: pageY\n      };\n\n      if (this.mouseDownLatLong['x'] !== this.mouseMoveLatLong['x'] && this.mouseDownLatLong['y'] !== this.mouseMoveLatLong['y']) {\n        if (this.maps.zoomSettings.enablePanning) {\n          this.panning('None', null, null, e);\n        }\n\n        this.mouseDownLatLong['x'] = pageX;\n        this.mouseDownLatLong['y'] = pageY;\n      }\n    }\n\n    if (this.isTouch ? touches.length === 1 && this.rectZoomingStart : this.rectZoomingStart) {\n      e.preventDefault();\n\n      if (this.maps.zoomSettings.enableSelectionZooming) {\n        this.drawZoomRectangle();\n      }\n    }\n  };\n\n  Zoom.prototype.mouseUpHandler = function (e) {\n    var isDragZoom;\n    var map = this.maps;\n    this.rectZoomingStart = false;\n    this.isPanning = false;\n    this.isSingleClick = this.isSingleClick ? true : false;\n    this.isTouch = false;\n    this.touchStartList = [];\n    this.touchMoveList = [];\n    this.lastScale = 1;\n    this.maps.element.style.cursor = 'auto';\n\n    if ((!isNullOrUndefined(this.distanceX) || !isNullOrUndefined(this.distanceY)) && !isNullOrUndefined(this.currentLayer) && this.currentLayer.type === 'SubLayer') {\n      this.toAlignSublayer();\n      this.distanceX = this.distanceY = null;\n    }\n\n    var zoomRectElement = getElementByID(this.maps.element.id + '_Selection_Rect_Zooming');\n\n    if (zoomRectElement && this.maps.zoomSettings.enable && this.maps.zoomSettings.enableSelectionZooming) {\n      isDragZoom = true;\n      remove(zoomRectElement);\n      this.performRectZooming();\n    }\n\n    this.mouseMoveLatLong = {\n      x: 0,\n      y: 0\n    };\n    this.mouseDownLatLong = {\n      x: 0,\n      y: 0\n    };\n  };\n\n  Zoom.prototype.mouseCancelHandler = function (e) {\n    this.isPanning = false;\n    this.isTouch = false;\n    this.rectZoomingStart = false;\n    var zoomRectElement = getElementByID(this.maps.element.id + '_Selection_Rect_Zooming');\n\n    if (zoomRectElement && this.maps.zoomSettings.enable) {\n      remove(zoomRectElement);\n      this.performRectZooming();\n    }\n  };\n  /**\n   * To handle the click event for maps.\n   * @param e\n   */\n\n\n  Zoom.prototype.click = function (e) {\n    var map = this.maps;\n\n    if (map.markerModule && map.markerModule.sameMarkerData.length > 0 || e.target['id'].indexOf('MarkerIndex') > -1 && e.target['id'].indexOf('cluster') == -1) {\n      return null;\n    }\n\n    if (this.isSingleClick && map.zoomSettings.zoomOnClick && !(e.target['id'].indexOf('_Zooming_') > -1) && !map.zoomSettings.doubleClickZoom && this.zoomColor !== this.selectionColor) {\n      var pageX = e.pageX;\n      var pageY = e.pageY;\n      var position = this.getMousePosition(pageX, pageY);\n      var prevLevel = map.tileZoomLevel;\n      var prevScale = map.scale;\n      map.mapScaleValue = map.mapScaleValue + 1;\n      var value = map.isTileMap ? prevLevel : prevScale;\n\n      if (position.x > map.mapAreaRect.x && position.x < map.mapAreaRect.x + map.mapAreaRect.width && position.y > map.mapAreaRect.y && position.y < map.mapAreaRect.y + map.mapAreaRect.height) {\n        this.performZooming(position, value + 1, 'ZoomIn');\n      }\n    }\n  };\n\n  Zoom.prototype.getMousePosition = function (pageX, pageY) {\n    var map = this.maps;\n    var elementRect = map.element.getBoundingClientRect();\n    var pageXOffset = map.element.ownerDocument.defaultView.pageXOffset;\n    var pageYOffset = map.element.ownerDocument.defaultView.pageYOffset;\n    var clientTop = map.element.ownerDocument.documentElement.clientTop;\n    var clientLeft = map.element.ownerDocument.documentElement.clientLeft;\n    var positionX = elementRect.left + pageXOffset - clientLeft;\n    var positionY = elementRect.top + pageYOffset - clientTop;\n    return new Point(Math.abs(pageX - positionX), Math.abs(pageY - positionY));\n  };\n\n  Zoom.prototype.addEventListener = function () {\n    if (this.maps.isDestroyed) {\n      return;\n    }\n\n    EventHandler.add(this.maps.element, this.wheelEvent, this.mapMouseWheel, this);\n    EventHandler.add(this.maps.element, 'click', this.click, this);\n    EventHandler.add(this.maps.element, 'dblclick', this.doubleClick, this);\n    this.maps.on(Browser.touchMoveEvent, this.mouseMoveHandler, this);\n    this.maps.on(Browser.touchStartEvent, this.mouseDownHandler, this);\n    this.maps.on(Browser.touchEndEvent, this.mouseUpHandler, this);\n    EventHandler.add(this.maps.element, this.cancelEvent, this.mouseCancelHandler, this);\n  };\n\n  Zoom.prototype.removeEventListener = function () {\n    if (this.maps.isDestroyed) {\n      return;\n    }\n\n    EventHandler.remove(this.maps.element, this.wheelEvent, this.mapMouseWheel);\n    EventHandler.remove(this.maps.element, 'click', this.click);\n    EventHandler.remove(this.maps.element, 'dblclick', this.doubleClick);\n    this.maps.off(Browser.touchMoveEvent, this.mouseMoveHandler);\n    this.maps.off(Browser.touchStartEvent, this.mouseDownHandler);\n    this.maps.off(Browser.touchEndEvent, this.mouseUpHandler);\n    this.maps.off(this.cancelEvent, this.mouseCancelHandler);\n  };\n  /**\n   * Get module name.\n   */\n\n\n  Zoom.prototype.getModuleName = function () {\n    return 'Zoom';\n  };\n  /**\n   * To destroy the zoom.\n   * @return {void}\n   * @private\n   */\n\n\n  Zoom.prototype.destroy = function (maps) {\n    this.removeEventListener();\n    /**\n     * Destroy method performed here\n     */\n  };\n\n  return Zoom;\n}();\n\nexport { Zoom };","map":{"version":3,"sources":["/Users/kristalduran/node_modules/@syncfusion/ej2-maps/src/maps/user-interaction/zoom.js"],"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","Point","getElementByID","PathOption","Rect","convertGeoToPoint","CircleOption","convertTileLatLongToPoint","RectOption","createTooltip","calculateScale","getTouchCenter","getTouches","targetTouches","MapLocation","zoomAnimate","smoothTranslate","measureText","textTrim","clusterTemplate","marker","markerTemplate","removeElement","getElement","clusterSeparate","markerColorChoose","markerShapeChoose","isNullOrUndefined","EventHandler","Browser","remove","createElement","changeBorderWidth","markerRendering","pan","getValueFromObject","Zoom","maps","isPanning","mouseEnter","isTouch","rectZoomingStart","pinchRect","browserName","info","name","isPointer","handled","pinchFactor","startTouches","shapeZoomLocation","intersect","mouseDownLatLong","x","y","mouseMoveLatLong","isSingleClick","wheelEvent","cancelEvent","selectionColor","zoomSettings","fillColor","color","addEventListener","groupElements","performZooming","position","newZoomFactor","type","_this","map","previousProjection","projectionType","defaultState","initialCheck","markerZoomedState","zoomPersistence","enablePersistence","prevLevel","tileZoomLevel","scale","previousScale","maxZoom","minZoom","prevTilePoint","tileTranslatePoint","isTileMap","availSize","mapAreaRect","minBounds","baseMapRectBounds","maxBounds","mapTotalWidth","Math","abs","mapTotalHeight","point","translatePoint","translatePointX","width","translatePointY","height","currentHeight","triggerZoomEvent","applyTransform","getTileTranslatePosition","pow","resetToInitial","applyZoomReset","initialZoomLevel","initialTileTranslate","mapScaleValue","document","querySelector","style","display","getElementById","element","id","mapLayerPanel","generateTiles","element1","setTimeout","zoomNotApplied","zoomArgs","cancel","isBlazor","previous","previousPoint","current","trigger","currentLevel","tileDefaultSize","padding","bounds","availableSize","prevSize","totalSize","performRectZooming","isDragZoom","size","zoomRect","zoomingRect","zoomCalculationFactor","round","setInteraction","newInteraction","lastScale","interaction","updateInteraction","fingers","performPinchZooming","touchStartList","touchMoveList","touchCenter","newScale","min","max","newTileFactor","drawZoomRectangle","down","mouseDownPoints","move","mouseMovePoints","border","elementRect","getBoundingClientRect","rectSVGObject","renderer","createSvg","rectOption","appendChild","drawRectangle","animateTransform","animate","duration","currentLayer","animationDuration","setAttribute","layerIndex","templateCount","layer","zoomshapelocation","markerStyle","collection","zoomShapeCollection","layerCollectionEle","i_1","childElementCount","layerElement","childNodes","tagName","index","parseFloat","split","layersCollection","factor","calculateFactor","j","currentEle","children","insertBefore","navigationLineModule","renderNavigation","zoomTranslatePoint","markerTranslates","k","markerTranslate","layerIndex_1","parseInt","dataIndex","markerIndex","markerSelectionValues","markerSettings","dataSource","x_1","initialMarkerSelection","markerSelection","selectionSettings","markerModule","sameMarkerData","mapsTooltipModule","tooltipTargetID","mapsTooltip","tooltipElement","x_2","getAttribute","y_1","svgTooltip","location","enableAnimation","childElement","bubbleTransform","bubleIndex","l","bubbleModule","bubbleCollection","centerX","centerY","currentX","currentY","zoomLabelPositions","dataLabelModule","dataLabelCollections","labelIndex","zoomshapewidth","push","dataLabelTranslate","dataLabel","layers","dataLabelSettings","labelX","labelY","zoomtext","textStyle","zoomtextSize","rectElement","rectX","rectY","arrangeTemplate","blazor","blazorTemplates","processTemplate","markerSVGObject","templateFn","nullCount","markerCounts","markerTemplateCounts","createGroup","class","mapsAreaRect","markerTemplateElements","className","styles","currentLayers","markerDatas","Array","forEach","data","markerNullCount","eventArgs","template","fill","colorValuePath","shapeValuePath","imageUrl","shape","marker_1","blazorEventArgs","latitudeValue","longitudeValue","longitudeValuePath","latitudeValuePath","MarkerArgs","lati","Number","long","data1","text","keys","toLowerCase","offset","visible","markerID","location_1","animate_1","zoomModule","transPoint","isNaN","markerDataLength","markerClusterSettings","allowClustering","svgObject","markerTemplateElement","datalabelTemplateElemement","labelCollection","zoomelement","trimmedLable","zoomtrimLabel","labelPath","shapeIndex","label","layerEle","templateOffset","layerOffset","elementOffset","parentElement","x_3","left","y_2","top","start","end","xpositionEnds","xpositionStart","textLocations","rightWidth","leftWidth","heightTop","heightBottom","smartLabelMode","innerHTML","dataLabelShape","intersectionAction","m","difference","lng","lat","location_2","baseLayerIndex","layerType","staticMapOffset","staticMapOffsetWidth","transform","panning","direction","xDifference","yDifference","mouseLocation","panArgs","layerRect","panningXDirection","margin","panningYDirection","location_3","getGeoLocation","latitude","longitude","distanceX","distanceY","location_4","getTileGeoLocation","toAlignSublayer","toolBarZooming","zoomFactor","isReset","mapWidth","mapHeight","tileZoomFactor","createZoomingToolbars","toolBarGroup","opacity","kitHeight","kitWidth","xSpacing","ySpacing","orientation","toolBarOrientation","toolbarsCollection","toolbars","shadowElement","toolBarLength","toolWidth","toolHeight","defElement","createDefs","outerElement","performFunction","toolbar_1","pathOptions","polyOptions","currentToolbarEle","polygonDirection","fillColor_1","strokeColor","enablePanning","enableSelectionZooming","themeStyle","zoomFillColor","drawPath","zoomElements","wireEvents","performToolBarAction","zoomInElements","zoomOutElements","panColor","panElements","drawCircle","target","stopImmediatePropagation","pointerType","toolbar","performZoomingByToolBar","zoomColor","applySelection","staticMapZoom","markerCenterLatitude","markerCenterLongitude","enable","panningStyle","svg","elements","showTooltip","getLocalizedLabel","pageY","pageX","removeTooltip","alignToolBar","toolBarSize","toString","totalRect","verticalAlignment","horizontalAlignment","highlightColor","css","createTextNode","process","add","touchStartEvent","mapMouseWheel","mouseWheelZoom","getMousePosition","prevScale","delta","staticMaxZoomLevel","value","preventDefault","detail","wheelDelta","doubleClick","doubleClickZoom","mouseDownHandler","touches","clientX","clientY","firstMove","mouseMoveHandler","touchArg","zoom","pinchZooming","targetId","targetEle","isDevice","cursor","mouseUpHandler","zoomRectElement","mouseCancelHandler","click","zoomOnClick","pageXOffset","ownerDocument","defaultView","pageYOffset","clientTop","documentElement","clientLeft","positionX","positionY","isDestroyed","on","touchMoveEvent","touchEndEvent","removeEventListener","off","getModuleName","destroy"],"mappings":"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","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n            t[p[i]] = s[p[i]];\n    return t;\n};\nimport { Point, getElementByID, PathOption, Rect, convertGeoToPoint, CircleOption, convertTileLatLongToPoint } from '../utils/helper';\nimport { RectOption, createTooltip, calculateScale, getTouchCenter, getTouches, targetTouches } from '../utils/helper';\nimport { MapLocation, zoomAnimate, smoothTranslate, measureText, textTrim, clusterTemplate, marker } from '../utils/helper';\nimport { markerTemplate, removeElement, getElement, clusterSeparate, markerColorChoose } from '../utils/helper';\nimport { markerShapeChoose } from '../utils/helper';\nimport { isNullOrUndefined, EventHandler, Browser, remove, createElement } from '@syncfusion/ej2-base';\nimport { changeBorderWidth, markerRendering, } from '../index';\nimport { pan } from '../model/constants';\nimport { getValueFromObject } from '../utils/helper';\n/**\n * Zoom module used to process the zoom for maps\n */\n/* tslint:disable:max-line-length */\nvar Zoom = /** @class */ (function () {\n    function Zoom(maps) {\n        this.isPanning = false;\n        this.mouseEnter = false;\n        this.isTouch = false;\n        this.rectZoomingStart = false;\n        this.pinchRect = new Rect(0, 0, 0, 0);\n        this.browserName = Browser.info.name;\n        this.isPointer = Browser.isPointer;\n        this.handled = false;\n        this.pinchFactor = 1;\n        this.startTouches = [];\n        this.shapeZoomLocation = [];\n        this.intersect = [];\n        this.mouseDownLatLong = { x: 0, y: 0 };\n        this.mouseMoveLatLong = { x: 0, y: 0 };\n        /**\n         * @private\n         */\n        this.isSingleClick = false;\n        this.maps = maps;\n        this.wheelEvent = this.browserName === 'mozilla' ? (this.isPointer ? 'mousewheel' : 'DOMMouseScroll') : 'mousewheel';\n        this.cancelEvent = this.isPointer ? 'pointerleave' : 'mouseleave';\n        this.selectionColor = this.maps.zoomSettings.selectionColor;\n        this.fillColor = this.maps.zoomSettings.color;\n        this.addEventListener();\n        this.groupElements = [];\n    }\n    /* tslint:disable:no-string-literal */\n    /**\n     * To perform zooming for maps\n     * @param position\n     * @param newZoomFactor\n     * @param type\n     */\n    Zoom.prototype.performZooming = function (position, newZoomFactor, type) {\n        var _this = this;\n        var map = this.maps;\n        map.previousProjection = map.projectionType;\n        map.defaultState = false;\n        map.initialCheck = false;\n        map.markerZoomedState = false;\n        map.zoomPersistence = map.enablePersistence;\n        var prevLevel = map.tileZoomLevel;\n        var scale = map.previousScale = map.scale;\n        var maxZoom = map.zoomSettings.maxZoom;\n        var minZoom = map.zoomSettings.minZoom;\n        newZoomFactor = (minZoom > newZoomFactor && type === 'ZoomIn') ? minZoom + 1 : newZoomFactor;\n        var prevTilePoint = map.tileTranslatePoint;\n        if ((!map.isTileMap) && (type === 'ZoomIn' ? newZoomFactor >= minZoom && newZoomFactor <= maxZoom : newZoomFactor >= minZoom)) {\n            var availSize = map.mapAreaRect;\n            var minBounds = map.baseMapRectBounds['min'];\n            var maxBounds = map.baseMapRectBounds['max'];\n            var mapTotalWidth = Math.abs(minBounds['x'] - maxBounds['x']);\n            var mapTotalHeight = Math.abs(minBounds['y'] - maxBounds['y']);\n            var point = map.translatePoint;\n            var translatePointX = point.x - (((availSize.width / scale) - (availSize.width / newZoomFactor)) / (availSize.width / position.x));\n            var translatePointY = point.y - (((availSize.height / scale) - (availSize.height / newZoomFactor)) / (availSize.height / position.y));\n            var currentHeight = Math.abs(map.baseMapRectBounds['max']['y'] - map.baseMapRectBounds['min']['y']) * newZoomFactor;\n            translatePointX = (currentHeight < map.mapAreaRect.height) ? (availSize.x + ((-(minBounds['x'])) + ((availSize.width / 2) - (mapTotalWidth / 2)))) : translatePointX;\n            translatePointY = (currentHeight < map.mapAreaRect.height) ? (availSize.y + ((-(minBounds['y'])) + ((availSize.height / 2) - (mapTotalHeight / 2)))) : translatePointY;\n            map.translatePoint = new Point(translatePointX, translatePointY);\n            map.scale = newZoomFactor;\n            this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n            this.applyTransform();\n        }\n        else if ((map.isTileMap) && (newZoomFactor >= minZoom && newZoomFactor <= maxZoom)) {\n            this.getTileTranslatePosition(prevLevel, newZoomFactor, position, type);\n            map.tileZoomLevel = newZoomFactor;\n            map.scale = Math.pow(2, newZoomFactor - 1);\n            if (type === 'ZoomOut' && map.zoomSettings.resetToInitial && map.applyZoomReset && newZoomFactor <= map.initialZoomLevel) {\n                map.initialCheck = true;\n                map.zoomPersistence = false;\n                map.tileTranslatePoint.x = map.initialTileTranslate.x;\n                map.tileTranslatePoint.y = map.initialTileTranslate.y;\n                newZoomFactor = map.tileZoomLevel = map.mapScaleValue = map.initialZoomLevel;\n                map.scale = Math.pow(2, newZoomFactor - 1);\n            }\n            map.translatePoint.y = (map.tileTranslatePoint.y - (0.01 * map.scale)) / map.scale;\n            map.translatePoint.x = (map.tileTranslatePoint.x - (0.01 * map.scale)) / map.scale;\n            this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n            if (document.querySelector('.GroupElement')) {\n                document.querySelector('.GroupElement').style.display = 'none';\n            }\n            if (document.getElementById(this.maps.element.id + '_LayerIndex_1')) {\n                document.getElementById(this.maps.element.id + '_LayerIndex_1').style.display = 'none';\n            }\n            map.mapLayerPanel.generateTiles(newZoomFactor, map.tileTranslatePoint, type + 'wheel', null, position);\n            var element1 = document.getElementById(this.maps.element.id + '_tiles');\n            setTimeout(function () {\n                // if (type === 'ZoomOut') {\n                //     element1.removeChild(element1.children[element1.childElementCount - 1]);\n                //     if (element1.childElementCount) {\n                //         element1.removeChild(element1.children[element1.childElementCount - 1]);\n                //     } else {\n                //         element1 = element1;\n                //     }\n                // }\n                _this.applyTransform();\n                if (document.getElementById(_this.maps.element.id + '_LayerIndex_1')) {\n                    document.getElementById(_this.maps.element.id + '_LayerIndex_1').style.display = 'block';\n                }\n                // tslint:disable-next-line:align\n            }, 250);\n        }\n        this.maps.zoomNotApplied = false;\n    };\n    Zoom.prototype.triggerZoomEvent = function (prevTilePoint, prevLevel, type) {\n        var map = this.maps;\n        var zoomArgs;\n        if (!map.isTileMap) {\n            zoomArgs = {\n                cancel: false, name: 'zoom', type: type, maps: !map.isBlazor ? map : null,\n                tileTranslatePoint: {}, translatePoint: { previous: map.previousPoint, current: map.translatePoint },\n                tileZoomLevel: {}, scale: { previous: map.previousScale, current: map.scale }\n            };\n        }\n        else {\n            zoomArgs = {\n                cancel: false, name: 'zoom', type: type, maps: !map.isBlazor ? map : null,\n                tileTranslatePoint: { previous: prevTilePoint, current: map.tileTranslatePoint }, translatePoint: { previous: map.previousPoint, current: map.translatePoint },\n                tileZoomLevel: { previous: prevLevel, current: map.tileZoomLevel }, scale: { previous: map.previousScale, current: map.scale }\n            };\n        }\n        map.trigger('zoom', zoomArgs);\n    };\n    Zoom.prototype.getTileTranslatePosition = function (prevLevel, currentLevel, position, type) {\n        var map = this.maps;\n        var tileDefaultSize = 256;\n        var padding = type === 'ZoomOut' ? 10 : (type === 'Reset' && currentLevel > 1) ? 0 : 10;\n        var bounds = map.availableSize;\n        var prevSize = Math.pow(2, prevLevel) * 256;\n        var totalSize = Math.pow(2, currentLevel) * 256;\n        var x = ((position.x - map.tileTranslatePoint.x) / prevSize) * 100;\n        var y = ((position.y - map.tileTranslatePoint.y) / prevSize) * 100;\n        map.tileTranslatePoint.x = (currentLevel === 1) ? (bounds.width / 2) - ((tileDefaultSize * 2) / 2) :\n            position.x - ((x * totalSize) / 100);\n        map.tileTranslatePoint.y = (currentLevel === 1) ? ((bounds.height / 2) - ((tileDefaultSize * 2) / 2) + (padding * 2)) :\n            position.y - ((y * totalSize) / 100);\n    };\n    Zoom.prototype.performRectZooming = function () {\n        this.isDragZoom = true;\n        var map = this.maps;\n        var size = map.availableSize;\n        map.previousProjection = map.projectionType;\n        var prevLevel = map.tileZoomLevel;\n        var prevTilePoint = map.tileTranslatePoint;\n        var zoomRect = this.zoomingRect;\n        var maxZoom = map.zoomSettings.maxZoom;\n        var minZoom = map.zoomSettings.minZoom;\n        if (zoomRect.height > 0 && zoomRect.width > 0) {\n            var x = this.zoomingRect.x + (this.zoomingRect.width / 2);\n            var y = this.zoomingRect.y + (this.zoomingRect.height / 2);\n            var zoomCalculationFactor = void 0;\n            if (!map.isTileMap) {\n                var scale = map.previousScale = map.scale;\n                zoomCalculationFactor = scale + Math.round((((size.width / zoomRect.width) + (size.height / zoomRect.height)) / 2));\n                var translatePoint = map.previousPoint = map.translatePoint;\n                var translatePointX = translatePoint.x - (((size.width / scale) - (size.width / zoomCalculationFactor)) / (size.width / x));\n                var translatePointY = translatePoint.y - (((size.height / scale) - (size.height / zoomCalculationFactor)) / (size.height / y));\n                map.translatePoint = new Point(translatePointX, translatePointY);\n                map.scale = zoomCalculationFactor;\n                this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n            }\n            else {\n                zoomCalculationFactor = prevLevel + (Math.round(prevLevel + (((size.width / zoomRect.width) + (size.height / zoomRect.height)) / 2)));\n                zoomCalculationFactor = (zoomCalculationFactor >= minZoom && zoomCalculationFactor <= maxZoom) ? zoomCalculationFactor : maxZoom;\n                this.getTileTranslatePosition(prevLevel, zoomCalculationFactor, { x: x, y: y });\n                map.tileZoomLevel = zoomCalculationFactor;\n                map.translatePoint.x = (map.tileTranslatePoint.x - (0.5 * Math.pow(2, zoomCalculationFactor))) /\n                    (Math.pow(2, zoomCalculationFactor));\n                map.translatePoint.y = (map.tileTranslatePoint.y - (0.5 * Math.pow(2, zoomCalculationFactor))) /\n                    (Math.pow(2, zoomCalculationFactor));\n                map.scale = (Math.pow(2, zoomCalculationFactor));\n                this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n                map.mapLayerPanel.generateTiles(zoomCalculationFactor, map.tileTranslatePoint);\n            }\n            map.mapScaleValue = zoomCalculationFactor;\n            this.applyTransform(true);\n            this.maps.zoomNotApplied = false;\n            this.zoomingRect = null;\n        }\n    };\n    Zoom.prototype.setInteraction = function (newInteraction) {\n        this.lastScale = 1;\n        this.interaction = newInteraction;\n    };\n    Zoom.prototype.updateInteraction = function () {\n        if (this.fingers === 2) {\n            this.setInteraction('zoom');\n        }\n        else {\n            this.setInteraction(null);\n        }\n    };\n    Zoom.prototype.performPinchZooming = function (e) {\n        var map = this.maps;\n        var prevLevel = map.tileZoomLevel;\n        var availSize = map.mapAreaRect;\n        map.previousScale = map.scale;\n        map.previousPoint = map.translatePoint;\n        var prevTilePoint = map.tileTranslatePoint;\n        var scale = calculateScale(this.touchStartList, this.touchMoveList);\n        var touchCenter = getTouchCenter(getTouches(this.touchMoveList, this.maps));\n        var newScale = scale / this.lastScale;\n        this.lastScale = scale;\n        this.pinchFactor *= newScale;\n        this.pinchFactor = Math.min(this.maps.zoomSettings.maxZoom, Math.max(this.pinchFactor, this.maps.zoomSettings.minZoom));\n        var zoomCalculationFactor = this.pinchFactor;\n        var zoomArgs;\n        if (!map.isTileMap) {\n            var minBounds = map.baseMapRectBounds['min'];\n            var maxBounds = map.baseMapRectBounds['max'];\n            var mapTotalWidth = Math.abs(minBounds['x'] - maxBounds['x']);\n            var mapTotalHeight = Math.abs(minBounds['y'] - maxBounds['y']);\n            var translatePoint = map.translatePoint;\n            var currentHeight = Math.abs(map.baseMapRectBounds['max']['y'] - map.baseMapRectBounds['min']['y']) * zoomCalculationFactor;\n            var translatePointX = translatePoint.x - (((availSize.width / map.scale) - (availSize.width / zoomCalculationFactor)) / (availSize.width / touchCenter.x));\n            var translatePointY = translatePoint.y - (((availSize.height / map.scale) - (availSize.height / zoomCalculationFactor)) / (availSize.height / touchCenter.y));\n            translatePointX = (currentHeight < map.mapAreaRect.height) ? (availSize.x + ((-(minBounds['x'])) + ((availSize.width / 2) - (mapTotalWidth / 2)))) : translatePointX;\n            translatePointY = (currentHeight < map.mapAreaRect.height) ? (availSize.y + ((-(minBounds['y'])) + ((availSize.height / 2) - (mapTotalHeight / 2)))) : translatePointY;\n            map.translatePoint = new Point(translatePointX, translatePointY);\n            map.scale = zoomCalculationFactor;\n            this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n        }\n        else {\n            var newTileFactor = zoomCalculationFactor;\n            this.getTileTranslatePosition(prevLevel, newTileFactor, { x: touchCenter.x, y: touchCenter.y });\n            map.tileZoomLevel = newTileFactor;\n            map.translatePoint.x = (map.tileTranslatePoint.x - (0.5 * Math.pow(2, newTileFactor))) /\n                (Math.pow(2, newTileFactor));\n            map.translatePoint.y = (map.tileTranslatePoint.y - (0.5 * Math.pow(2, newTileFactor))) /\n                (Math.pow(2, newTileFactor));\n            map.scale = (Math.pow(2, newTileFactor));\n            this.triggerZoomEvent(prevTilePoint, prevLevel, '');\n            map.mapLayerPanel.generateTiles(newTileFactor, map.tileTranslatePoint);\n        }\n        this.applyTransform();\n    };\n    Zoom.prototype.drawZoomRectangle = function () {\n        var map = this.maps;\n        var down = this.mouseDownPoints;\n        var move = this.mouseMovePoints;\n        var x;\n        var y;\n        var width;\n        var height;\n        var border = { width: 1, color: '#009900' };\n        width = Math.abs(move.x - down.x);\n        height = Math.abs(move.y - down.y);\n        x = ((move.x > down.x) ? down.x : down.x - width);\n        y = ((move.y > down.y) ? down.y : down.y - height);\n        var elementRect = getElementByID(map.element.id).getBoundingClientRect();\n        if ((x > map.mapAreaRect.x && x < (map.mapAreaRect.x + map.mapAreaRect.width)) &&\n            (y > map.mapAreaRect.y) && (y < map.mapAreaRect.y + map.mapAreaRect.height)) {\n            this.zoomingRect = new Rect(x, y, width, height);\n            var rectSVGObject = map.renderer.createSvg({\n                id: map.element.id + '_Selection_Rect_Zooming',\n                width: map.availableSize.width,\n                height: map.availableSize.height,\n            });\n            var rectOption = new RectOption(map.element.id + '_ZoomRect', '#d3d3d3', border, 0.5, this.zoomingRect, 0, 0, '', '3');\n            rectSVGObject.appendChild(map.renderer.drawRectangle(rectOption));\n            getElementByID(map.element.id + '_Secondary_Element').appendChild(rectSVGObject);\n        }\n    };\n    /**\n     * To animate the zooming process\n     */\n    Zoom.prototype.animateTransform = function (element, animate, x, y, scale) {\n        var duration = this.currentLayer.animationDuration;\n        if (!animate || duration === 0) {\n            element.setAttribute('transform', 'scale(' + (scale) + ') translate( ' + x + ' ' + y + ' )');\n            return;\n        }\n        zoomAnimate(element, 0, duration, new MapLocation(x, y), scale, this.maps.mapAreaRect, this.maps);\n    };\n    //tslint:disable:max-func-body-length\n    Zoom.prototype.applyTransform = function (animate) {\n        var layerIndex;\n        this.templateCount = 0;\n        var layer;\n        var zoomshapelocation;\n        var i;\n        var markerStyle;\n        var scale = this.maps.scale;\n        var x = this.maps.translatePoint.x;\n        var y = this.maps.translatePoint.y;\n        var collection = [];\n        this.maps.zoomShapeCollection = [];\n        if (document.getElementById(this.maps.element.id + '_mapsTooltip')) {\n            removeElement(this.maps.element.id + '_mapsTooltip');\n        }\n        if (this.layerCollectionEle) {\n            for (var i_1 = 0; i_1 < this.layerCollectionEle.childElementCount; i_1++) {\n                var layerElement = this.layerCollectionEle.childNodes[i_1];\n                if (layerElement.tagName === 'g') {\n                    this.templateCount++;\n                    this.index = layerElement.id.indexOf('_LayerIndex_') > -1 && parseFloat(layerElement.id.split('_LayerIndex_')[1].split('_')[0]);\n                    this.currentLayer = this.maps.layersCollection[this.index];\n                    var factor = this.maps.mapLayerPanel.calculateFactor(this.currentLayer);\n                    for (var j = 0; j < layerElement.childElementCount; j++) {\n                        var currentEle = layerElement.childNodes[j];\n                        if (!(currentEle.id.indexOf('_Markers_Group') > -1) && (!(currentEle.id.indexOf('_bubble_Group') > -1))\n                            && (!(currentEle.id.indexOf('_dataLableIndex_Group') > -1))) {\n                            if (this.maps.isTileMap && (currentEle.id.indexOf('_line_Group') > -1)) {\n                                currentEle.remove();\n                                if (layerElement.children.length > 0 && layerElement.children[0]) {\n                                    layerElement.insertBefore(this.maps.navigationLineModule.renderNavigation(this.currentLayer, this.maps.tileZoomLevel, this.index), layerElement.children[0]);\n                                }\n                                else {\n                                    layerElement.appendChild(this.maps.navigationLineModule.renderNavigation(this.currentLayer, this.maps.tileZoomLevel, this.index));\n                                }\n                            }\n                            else {\n                                changeBorderWidth(currentEle, this.index, scale, this.maps);\n                                this.maps.zoomTranslatePoint = this.maps.translatePoint;\n                                this.animateTransform(currentEle, animate, x, y, scale);\n                                this.shapeZoomLocation = currentEle.childNodes;\n                            }\n                        }\n                        else if (currentEle.id.indexOf('_Markers_Group') > -1) {\n                            if (!this.isPanning) {\n                                this.markerTranslates(currentEle.childNodes[0], factor, x, y, scale, 'Marker', layerElement, animate);\n                            }\n                            currentEle = layerElement.childNodes[j];\n                            if (!isNullOrUndefined(currentEle)) {\n                                for (var k = 0; k < currentEle.childElementCount; k++) {\n                                    this.markerTranslate(currentEle.childNodes[k], factor, x, y, scale, 'Marker', animate);\n                                    var layerIndex_1 = parseInt(currentEle.childNodes[k]['id'].split('_LayerIndex_')[1].split('_')[0], 10);\n                                    var dataIndex = parseInt(currentEle.childNodes[k]['id'].split('_dataIndex_')[1].split('_')[0], 10);\n                                    var markerIndex = parseInt(currentEle.childNodes[k]['id'].split('_MarkerIndex_')[1].split('_')[0], 10);\n                                    var markerSelectionValues = this.currentLayer.markerSettings[markerIndex].dataSource[dataIndex];\n                                    for (var x_1 = 0; x_1 < this.currentLayer.markerSettings[markerIndex].initialMarkerSelection.length; x_1++) {\n                                        if (this.currentLayer.markerSettings[markerIndex].initialMarkerSelection[x_1]['latitude'] ===\n                                            markerSelectionValues['latitude'] ||\n                                            this.currentLayer.markerSettings[markerIndex].initialMarkerSelection[x_1]['longitude'] ===\n                                                markerSelectionValues['longitude']) {\n                                            this.maps.markerSelection(this.currentLayer.markerSettings[markerIndex].selectionSettings, this.maps, currentEle.children[k], this.currentLayer.markerSettings[markerIndex].dataSource[dataIndex]);\n                                        }\n                                    }\n                                    if (!this.maps.isTileMap && this.currentLayer.animationDuration > 0) {\n                                        markerStyle = 'visibility:hidden';\n                                        currentEle.setAttribute('style', markerStyle);\n                                    }\n                                }\n                                if (this.isPanning && this.maps.markerModule.sameMarkerData.length > 0) {\n                                    clusterSeparate(this.maps.markerModule.sameMarkerData, this.maps, currentEle, true);\n                                }\n                                else if (this.maps.markerModule.sameMarkerData.length > 0) {\n                                    this.maps.markerModule.sameMarkerData = [];\n                                    if (document.getElementById(this.maps.element.id + '_mapsTooltip')) {\n                                        removeElement(this.maps.element.id + '_mapsTooltip');\n                                    }\n                                }\n                                if (document.getElementById(this.maps.element.id + '_mapsTooltip') && this.maps.mapsTooltipModule.tooltipTargetID.indexOf('_MarkerIndex_')\n                                    && !this.isPanning) {\n                                    var mapsTooltip = this.maps.mapsTooltipModule;\n                                    var tooltipElement = currentEle.querySelector('#' + mapsTooltip.tooltipTargetID);\n                                    if (!isNullOrUndefined(tooltipElement)) {\n                                        if (tooltipElement['style']['visibility'] === 'hidden') {\n                                            removeElement(this.maps.element.id + '_mapsTooltip');\n                                        }\n                                        else {\n                                            var x_2 = parseFloat(tooltipElement.getAttribute('transform').split('(')[1].split(')')[0].split(' ')[1]);\n                                            var y_1 = parseFloat(tooltipElement.getAttribute('transform').split('(')[1].split(')')[0].split(' ')[2]);\n                                            if (this.maps.isTileMap) {\n                                                x_2 += +getElement(this.maps.element.id + '_tile_parent')['style']['left'].split('px')[0];\n                                                y_1 += +getElement(this.maps.element.id + '_tile_parent')['style']['top'].split('px')[0];\n                                            }\n                                            mapsTooltip.svgTooltip.location.x = x_2;\n                                            mapsTooltip.svgTooltip.location.y = y_1;\n                                            mapsTooltip.svgTooltip.enableAnimation = false;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        else if (currentEle.id.indexOf('_bubble_Group') > -1) {\n                            var childElement = void 0;\n                            for (var k = 0; k < currentEle.childElementCount; k++) {\n                                childElement = currentEle.childNodes[k];\n                                var bubbleTransform = childElement.getAttribute('transform');\n                                layerIndex = parseFloat(childElement.id.split('_LayerIndex_')[1].split('_')[0]);\n                                var bubleIndex = parseFloat(childElement.id.split('_BubbleIndex_')[1].split('_')[0]);\n                                var dataIndex = parseFloat(childElement.id.split('_BubbleIndex_')[1].split('_')[2]);\n                                for (var l = 0; l < this.maps.bubbleModule.bubbleCollection.length; l++) {\n                                    var bubbleCollection = this.maps.bubbleModule.bubbleCollection[l];\n                                    if (bubbleCollection['LayerIndex'] === layerIndex && bubbleCollection['BubbleIndex'] === bubleIndex &&\n                                        bubbleCollection['DataIndex'] === dataIndex) {\n                                        var centerX = bubbleCollection['center']['x'];\n                                        var centerY = bubbleCollection['center']['y'];\n                                        var currentX = ((centerX + x) * scale);\n                                        var currentY = ((centerY + y) * scale);\n                                        var duration = this.currentLayer.animationDuration;\n                                        if (!animate || duration === 0) {\n                                            childElement.setAttribute('transform', 'translate( ' + currentX + ' ' + currentY + ' )');\n                                        }\n                                        else {\n                                            smoothTranslate(childElement, 0, duration, new MapLocation(currentX, currentY));\n                                        }\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                        else if (currentEle.id.indexOf('_dataLableIndex_Group') > -1) {\n                            this.intersect = [];\n                            this.maps.zoomLabelPositions = [];\n                            this.maps.zoomLabelPositions = this.maps.dataLabelModule.dataLabelCollections;\n                            for (var k = 0; k < currentEle.childElementCount; k++) {\n                                if (currentEle.childNodes[k]['id'].indexOf('_LabelIndex_') > -1) {\n                                    var labelIndex = parseFloat(currentEle.childNodes[k]['id'].split('_LabelIndex_')[1].split('_')[0]);\n                                    this.zoomshapewidth = this.shapeZoomLocation[labelIndex].getBoundingClientRect();\n                                    this.maps.zoomShapeCollection.push(this.zoomshapewidth);\n                                    this.dataLabelTranslate(currentEle.childNodes[k], factor, x, y, scale, 'DataLabel', animate);\n                                    var dataLabel = this.maps.layers[this.index].dataLabelSettings;\n                                    var border = dataLabel.border;\n                                    if (k > 0 && border['width'] > 1) {\n                                        if (currentEle.childNodes[k - 1]['id'].indexOf('_rectIndex_') > -1) {\n                                            var labelX = ((this.maps.zoomLabelPositions[labelIndex]['location']['x'] + x) * scale);\n                                            var labelY = ((this.maps.zoomLabelPositions[labelIndex]['location']['y'] + y) * scale);\n                                            var zoomtext = currentEle.childNodes[k]['innerHTML'];\n                                            var style = this.maps.layers[this.index].dataLabelSettings.textStyle;\n                                            var zoomtextSize = measureText(zoomtext, style);\n                                            var padding = 5;\n                                            var rectElement = currentEle.childNodes[k - 1];\n                                            var rectX = labelX - zoomtextSize['width'] / 2;\n                                            var rectY = labelY - zoomtextSize['height'] / 2 - padding;\n                                            rectElement['setAttribute']('x', rectX);\n                                            rectElement['setAttribute']('y', rectY);\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n                this.maps.arrangeTemplate();\n                var blazor = this.maps.isBlazor ? this.maps.blazorTemplates() : null;\n            }\n            if (!isNullOrUndefined(this.currentLayer)) {\n                if (!animate || this.currentLayer.animationDuration === 0) {\n                    this.processTemplate(x, y, scale, this.maps);\n                }\n            }\n        }\n    };\n    //tslint:disable\n    Zoom.prototype.markerTranslates = function (element, factor, x, y, scale, type, layerElement, animate) {\n        var _this = this;\n        if (animate === void 0) { animate = false; }\n        var markerSVGObject;\n        var templateFn;\n        var nullCount = 0;\n        var markerCounts = 0;\n        var markerTemplateCounts = 0;\n        var layerIndex = parseInt((element ? element : layerElement).id.split('_LayerIndex_')[1].split('_')[0], 10);\n        markerSVGObject = this.maps.renderer.createGroup({\n            id: this.maps.element.id + '_Markers_Group',\n            class: 'GroupElement',\n            style: 'pointer-events: auto;'\n        });\n        if (document.getElementById(markerSVGObject.id)) {\n            removeElement(markerSVGObject.id);\n        }\n        var mapsAreaRect = this.maps.mapAreaRect;\n        var markerTemplateElements = createElement('div', {\n            id: this.maps.element.id + '_LayerIndex_' + layerIndex + '_Markers_Template_Group',\n            className: 'template',\n            styles: 'overflow: hidden; position: absolute;pointer-events: none;' +\n                'top:' + mapsAreaRect.y + 'px;' +\n                'left:' + mapsAreaRect.x + 'px;' +\n                'height:' + mapsAreaRect.height + 'px;' +\n                'width:' + mapsAreaRect.width + 'px;'\n        });\n        if (document.getElementById(markerTemplateElements.id)) {\n            removeElement(markerTemplateElements.id);\n        }\n        var currentLayers = this.maps.layersCollection[layerIndex];\n        currentLayers.markerSettings.map(function (markerSettings, markerIndex) {\n            var markerDatas = markerSettings.dataSource;\n            Array.prototype.forEach.call(markerDatas, function (data, dataIndex) {\n                _this.maps.markerNullCount = markerIndex >= 0 && dataIndex === 0 ? 0 : _this.maps.markerNullCount;\n                var eventArgs = {\n                    template: markerSettings.template, data: data, maps: _this.maps, marker: markerSettings,\n                    cancel: false, name: markerRendering, fill: markerSettings.fill, colorValuePath: markerSettings.colorValuePath,\n                    shapeValuePath: markerSettings.shapeValuePath, height: markerSettings.height,\n                    width: markerSettings.width, imageUrl: markerSettings.imageUrl, shape: markerSettings.shape,\n                    border: markerSettings.border\n                };\n                eventArgs = markerShapeChoose(eventArgs, data);\n                eventArgs = markerColorChoose(eventArgs, data);\n                if (_this.maps.isBlazor) {\n                    var maps = eventArgs.maps, marker_1 = eventArgs.marker, blazorEventArgs = __rest(eventArgs, [\"maps\", \"marker\"]);\n                    eventArgs = blazorEventArgs;\n                    var latitudeValue = 'Latitude';\n                    var longitudeValue = 'Longitude';\n                    markerSettings.longitudeValuePath = !isNullOrUndefined(markerSettings.longitudeValuePath) ?\n                        markerSettings.longitudeValuePath : !isNullOrUndefined(data['Longitude']) ? longitudeValue :\n                        !isNullOrUndefined(data['longitude']) ? 'longitude' : null;\n                    markerSettings.latitudeValuePath = !isNullOrUndefined(markerSettings.latitudeValuePath) ?\n                        markerSettings.latitudeValuePath : !isNullOrUndefined(data['Latitude']) ? latitudeValue :\n                        !isNullOrUndefined(data['latitude']) ? 'latitude' : null;\n                }\n                _this.maps.trigger('markerRendering', eventArgs, function (MarkerArgs) {\n                    if (markerSettings.shapeValuePath !== eventArgs.shapeValuePath) {\n                        eventArgs = markerShapeChoose(eventArgs, data);\n                    }\n                    if (markerSettings.colorValuePath !== eventArgs.colorValuePath) {\n                        eventArgs = markerColorChoose(eventArgs, data);\n                    }\n                    var lati = (!isNullOrUndefined(markerSettings.latitudeValuePath)) ?\n                        Number(getValueFromObject(data, markerSettings.latitudeValuePath)) : !isNullOrUndefined(data['latitude']) ?\n                        parseFloat(data['latitude']) : !isNullOrUndefined(data['Latitude']) ? data['Latitude'] : 0;\n                    var long = (!isNullOrUndefined(markerSettings.longitudeValuePath)) ?\n                        Number(getValueFromObject(data, markerSettings.longitudeValuePath)) : !isNullOrUndefined(data['longitude']) ?\n                        parseFloat(data['longitude']) : !isNullOrUndefined(data['Longitude']) ? data['Longitude'] : 0;\n                    if (_this.maps.isBlazor) {\n                        var data1 = {};\n                        var j = 0;\n                        var text = [];\n                        for (var i = 0; i < Object.keys(data).length; i++) {\n                            if (Object.keys(data)[i].toLowerCase() !== 'text' && Object.keys(data)[i].toLowerCase() !== 'latitude'\n                                && Object.keys(data)[i].toLowerCase() !== 'blazortemplateid' && Object.keys(data)[i].toLowerCase() !== 'longitude'\n                                && Object.keys(data)[i].toLowerCase() !== 'name') {\n                                data1['text'] = text;\n                                text[j] = data[Object.keys(data)[i].toLowerCase()];\n                                j++;\n                            }\n                        }\n                        data['text'] = data1['text'];\n                    }\n                    var offset = markerSettings.offset;\n                    if (!eventArgs.cancel && markerSettings.visible && !isNullOrUndefined(long) && !isNullOrUndefined(lati)) {\n                        var markerID = _this.maps.element.id + '_LayerIndex_' + layerIndex + '_MarkerIndex_'\n                            + markerIndex + '_dataIndex_' + dataIndex;\n                        var location_1 = (_this.maps.isTileMap) ? convertTileLatLongToPoint(new MapLocation(long, lati), _this.maps.tileZoomLevel, _this.maps.tileTranslatePoint, true) : convertGeoToPoint(lati, long, factor, currentLayers, _this.maps);\n                        var animate_1 = currentLayers.animationDuration !== 0 || isNullOrUndefined(_this.maps.zoomModule);\n                        var transPoint = { x: x, y: y };\n                        if (eventArgs.template && (!isNaN(location_1.x) && !isNaN(location_1.y))) {\n                            markerTemplateCounts++;\n                            markerTemplate(eventArgs, templateFn, markerID, data, markerIndex, markerTemplateElements, location_1, scale, offset, _this.maps);\n                        }\n                        else if (!eventArgs.template && (!isNaN(location_1.x) && !isNaN(location_1.y))) {\n                            markerCounts++;\n                            marker(eventArgs, markerSettings, markerDatas, dataIndex, location_1, transPoint, markerID, offset, scale, _this.maps, markerSVGObject);\n                        }\n                    }\n                    nullCount += (!isNaN(lati) && !isNaN(long)) ? 0 : 1;\n                    markerTemplateCounts += (eventArgs.cancel) ? 1 : 0;\n                    markerCounts += (eventArgs.cancel) ? 1 : 0;\n                    _this.maps.markerNullCount = (!isNullOrUndefined(lati) || !isNullOrUndefined(long))\n                        ? _this.maps.markerNullCount : _this.maps.markerNullCount + 1;\n                    var markerDataLength = markerDatas.length - _this.maps.markerNullCount;\n                    if (markerSVGObject.childElementCount === (markerDatas.length - markerTemplateCounts - nullCount) && (type !== 'Template')) {\n                        layerElement.appendChild(markerSVGObject);\n                        if (currentLayers.markerClusterSettings.allowClustering) {\n                            _this.maps.svgObject.appendChild(markerSVGObject);\n                            _this.maps.element.appendChild(_this.maps.svgObject);\n                            clusterTemplate(currentLayers, markerSVGObject, _this.maps, layerIndex, markerSVGObject, layerElement, true, true);\n                        }\n                    }\n                    if (markerTemplateElements.childElementCount === (markerDatas.length - markerCounts - nullCount) && getElementByID(_this.maps.element.id + '_Secondary_Element')) {\n                        getElementByID(_this.maps.element.id + '_Secondary_Element').appendChild(markerTemplateElements);\n                        if (currentLayers.markerClusterSettings.allowClustering) {\n                            clusterTemplate(currentLayers, markerTemplateElements, _this.maps, layerIndex, markerSVGObject, layerElement, false, true);\n                        }\n                    }\n                });\n            });\n        });\n    };\n    ;\n    /**\n     * To translate the layer template elements\n     * @private\n     */\n    Zoom.prototype.processTemplate = function (x, y, scale, maps) {\n        for (var i = 0; i < this.templateCount; i++) {\n            this.currentLayer = maps.layersCollection[i];\n            var factor = maps.mapLayerPanel.calculateFactor(this.currentLayer);\n            var markerTemplateElement = getElementByID(maps.element.id + '_LayerIndex_' +\n                i + '_Markers_Template_Group');\n            var datalabelTemplateElemement = getElementByID(maps.element.id + '_LayerIndex_'\n                + i + '_Label_Template_Group');\n            if ((!isNullOrUndefined(markerTemplateElement)) && markerTemplateElement.childElementCount > 0) {\n                for (var k = 0; k < markerTemplateElement.childElementCount; k++) {\n                    this.markerTranslate(markerTemplateElement.childNodes[k], factor, x, y, scale, 'Template');\n                }\n            }\n            if ((!isNullOrUndefined(datalabelTemplateElemement)) && datalabelTemplateElemement.childElementCount > 0) {\n                for (var k = 0; k < datalabelTemplateElemement.childElementCount; k++) {\n                    this.dataLabelTranslate(datalabelTemplateElemement.childNodes[k], factor, x, y, scale, 'Template');\n                }\n            }\n        }\n    };\n    //tslint:disable:max-func-body-length\n    Zoom.prototype.dataLabelTranslate = function (element, factor, x, y, scale, type, animate) {\n        if (animate === void 0) { animate = false; }\n        var labelCollection = this.maps.dataLabelModule.dataLabelCollections;\n        var zoomelement = element.getBoundingClientRect();\n        var text;\n        var trimmedLable;\n        var style = this.maps.layers[this.index].dataLabelSettings.textStyle;\n        var zoomtext;\n        var zoomtextSize;\n        var zoomtrimLabel;\n        var labelPath = this.maps.layers[this.index].dataLabelSettings.labelPath;\n        var layerIndex = parseFloat(element.id.split('_LayerIndex_')[1].split('_')[0]);\n        var shapeIndex = parseFloat(element.id.split('_shapeIndex_')[1].split('_')[0]);\n        var labelIndex;\n        if (element.id.indexOf('_LabelIndex_') > -1) {\n            labelIndex = parseFloat(element.id.split('_LabelIndex_')[1].split('_')[0]);\n        }\n        var duration = this.currentLayer.animationDuration;\n        for (var l = 0; l < labelCollection.length; l++) {\n            var label = labelCollection[l];\n            if (label['layerIndex'] === layerIndex && label['shapeIndex'] === shapeIndex\n                && label['labelIndex'] === labelIndex) {\n                var labelX = label['location']['x'];\n                var labelY = label['location']['y'];\n                if (type === 'Template') {\n                    var layerEle = getElementByID(this.maps.element.id + '_Layer_Collections');\n                    labelX = ((Math.abs(this.maps.baseMapRectBounds['min']['x'] - labelX)) * scale);\n                    labelY = ((Math.abs(this.maps.baseMapRectBounds['min']['y'] - labelY)) * scale);\n                    var templateOffset = element.getBoundingClientRect();\n                    var layerOffset = layerEle.getBoundingClientRect();\n                    var elementOffset = element.parentElement.getBoundingClientRect();\n                    var x_3 = ((labelX) + (layerOffset.left - elementOffset.left) - (templateOffset.width / 2));\n                    var y_2 = ((labelY) + (layerOffset.top - elementOffset.top) - (templateOffset.height / 2));\n                    element.style.left = x_3 + 'px';\n                    element.style.top = y_2 + 'px';\n                }\n                else {\n                    labelX = ((labelX + x) * scale);\n                    labelY = ((labelY + y) * scale);\n                    zoomtext = label['dataLabelText'];\n                    zoomtextSize = measureText(zoomtext, style);\n                    var start = labelY - zoomtextSize['height'] / 4;\n                    var end = labelY + zoomtextSize['height'] / 4;\n                    var xpositionEnds = labelX + zoomtextSize['width'] / 2;\n                    var xpositionStart = labelX - zoomtextSize['width'] / 2;\n                    var textLocations = { rightWidth: xpositionEnds, leftWidth: xpositionStart, heightTop: start, heightBottom: end };\n                    if (!animate || duration === 0) {\n                        element.setAttribute('transform', 'translate( ' + labelX + ' ' + labelY + ' )');\n                    }\n                    if (this.maps.layers[this.index].dataLabelSettings.smartLabelMode === 'Hide') {\n                        if (scale > 1) {\n                            text = (this.zoomshapewidth['width'] >= zoomtextSize['width']) ? zoomtext : '';\n                            element.innerHTML = text;\n                        }\n                        else {\n                            text = (this.maps.dataLabelShape[l] >= zoomtextSize['width']) ? zoomtext : '';\n                            element.innerHTML = text;\n                        }\n                    }\n                    if (this.maps.layers[this.index].dataLabelSettings.smartLabelMode === 'Trim') {\n                        if (scale > 1) {\n                            zoomtrimLabel = textTrim(this.zoomshapewidth['width'], zoomtext, style);\n                            text = zoomtrimLabel;\n                            element.innerHTML = text;\n                        }\n                        else {\n                            zoomtrimLabel = textTrim(this.maps.dataLabelShape[l], zoomtext, style);\n                            text = zoomtrimLabel;\n                            element.innerHTML = text;\n                        }\n                    }\n                    if (this.maps.layers[this.index].dataLabelSettings.intersectionAction === 'Hide') {\n                        for (var m = 0; m < this.intersect.length; m++) {\n                            if (!isNullOrUndefined(this.intersect[m])) {\n                                if (textLocations['leftWidth'] > this.intersect[m]['rightWidth']\n                                    || textLocations['rightWidth'] < this.intersect[m]['leftWidth']\n                                    || textLocations['heightTop'] > this.intersect[m]['heightBottom']\n                                    || textLocations['heightBottom'] < this.intersect[m]['heightTop']) {\n                                    text = !isNullOrUndefined(text) ? text : zoomtext;\n                                    element.innerHTML = text;\n                                }\n                                else {\n                                    text = '';\n                                    element.innerHTML = text;\n                                    break;\n                                }\n                            }\n                        }\n                        this.intersect.push(textLocations);\n                    }\n                    if (this.maps.layers[this.index].dataLabelSettings.intersectionAction === 'Trim') {\n                        for (var j = 0; j < this.intersect.length; j++) {\n                            if (!isNullOrUndefined(this.intersect[j])) {\n                                if (textLocations['rightWidth'] < this.intersect[j]['leftWidth']\n                                    || textLocations['leftWidth'] > this.intersect[j]['rightWidth']\n                                    || textLocations['heightBottom'] < this.intersect[j]['heightTop']\n                                    || textLocations['heightTop'] > this.intersect[j]['heightBottom']) {\n                                    trimmedLable = !isNullOrUndefined(text) ? text : zoomtext;\n                                    if (scale > 1) {\n                                        trimmedLable = textTrim(this.zoomshapewidth['width'], trimmedLable, style);\n                                    }\n                                    element.innerHTML = trimmedLable;\n                                }\n                                else {\n                                    if (textLocations['leftWidth'] > this.intersect[j]['leftWidth']) {\n                                        var width = this.intersect[j]['rightWidth'] - textLocations['leftWidth'];\n                                        var difference = width - (textLocations['rightWidth'] - textLocations['leftWidth']);\n                                        text = !isNullOrUndefined(text) ? text : zoomtext;\n                                        trimmedLable = textTrim(difference, text, style);\n                                        element.innerHTML = trimmedLable;\n                                        break;\n                                    }\n                                    if (textLocations['leftWidth'] < this.intersect[j]['leftWidth']) {\n                                        var width = textLocations['rightWidth'] - this.intersect[j]['leftWidth'];\n                                        var difference = Math.abs(width - (textLocations['rightWidth'] - textLocations['leftWidth']));\n                                        text = !isNullOrUndefined(text) ? text : zoomtext;\n                                        trimmedLable = textTrim(difference, text, style);\n                                        element.innerHTML = trimmedLable;\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                        this.intersect.push(textLocations);\n                        if (isNullOrUndefined(trimmedLable)) {\n                            trimmedLable = textTrim(this.zoomshapewidth['width'], zoomtext, style);\n                            element.innerHTML = trimmedLable;\n                        }\n                    }\n                    else {\n                        smoothTranslate(element, 0, duration, new MapLocation(labelX, labelY));\n                    }\n                }\n            }\n        }\n    };\n    Zoom.prototype.markerTranslate = function (element, factor, x, y, scale, type, animate) {\n        if (animate === void 0) { animate = false; }\n        var layerIndex = parseInt(element.id.split('_LayerIndex_')[1].split('_')[0], 10);\n        var markerIndex = parseInt(element.id.split('_MarkerIndex_')[1].split('_')[0], 10);\n        var dataIndex = parseInt(element.id.split('_dataIndex_')[1].split('_')[0], 10);\n        var layer = this.maps.layersCollection[layerIndex];\n        var marker = layer.markerSettings[markerIndex];\n        if (!isNullOrUndefined(marker) && !isNullOrUndefined(marker.dataSource) && !isNullOrUndefined(marker.dataSource[dataIndex])) {\n            if (this.maps.isBlazor) {\n                marker.longitudeValuePath = !isNullOrUndefined(marker.longitudeValuePath) ?\n                    marker.longitudeValuePath : !isNullOrUndefined(marker.dataSource[dataIndex]['Longitude']) ? 'Longitude' :\n                    !isNullOrUndefined(marker.dataSource[dataIndex]['longitude']) ? 'longitude' : null;\n                marker.latitudeValuePath = !isNullOrUndefined(marker.latitudeValuePath) ?\n                    marker.latitudeValuePath : !isNullOrUndefined(marker.dataSource[dataIndex]['Latitude']) ? 'Latitude' :\n                    !isNullOrUndefined(marker.dataSource[dataIndex]['latitude']) ? 'latitude' : null;\n                var data1 = {};\n                var j = 0;\n                var text = [];\n                for (var i = 0; i < Object.keys(marker.dataSource[dataIndex]).length; i++) {\n                    if (Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'text' && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'longitude'\n                        && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'latitude' && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'blazortemplateid'\n                        && Object.keys(marker.dataSource[dataIndex])[i].toLowerCase() !== 'name') {\n                        data1['text'] = text;\n                        text[j] = marker.dataSource[dataIndex][Object.keys(marker.dataSource[dataIndex])[i].toLowerCase()];\n                        j++;\n                    }\n                }\n                marker.dataSource[dataIndex]['text'] = data1['text'];\n            }\n            var lng = (!isNullOrUndefined(marker.longitudeValuePath)) ?\n                Number(getValueFromObject(marker.dataSource[dataIndex], marker.longitudeValuePath)) :\n                !isNullOrUndefined(marker.dataSource[dataIndex]['longitude']) ? parseFloat(marker.dataSource[dataIndex]['longitude']) :\n                    !isNullOrUndefined(marker.dataSource[dataIndex]['Latitude']) ? parseFloat(marker.dataSource[dataIndex]['Latitude']) : 0;\n            var lat = (!isNullOrUndefined(marker.latitudeValuePath)) ?\n                Number(getValueFromObject(marker.dataSource[dataIndex], marker.latitudeValuePath)) :\n                !isNullOrUndefined(marker.dataSource[dataIndex]['latitude']) ? parseFloat(marker.dataSource[dataIndex]['latitude']) :\n                    !isNullOrUndefined(marker.dataSource[dataIndex]['Latitude']) ? parseFloat(marker.dataSource[dataIndex]['Latitude']) : 0;\n            var duration = this.currentLayer.animationDuration;\n            var location_2 = (this.maps.isTileMap) ? convertTileLatLongToPoint(new Point(lng, lat), this.maps.tileZoomLevel, this.maps.tileTranslatePoint, true) : convertGeoToPoint(lat, lng, factor, layer, this.maps);\n            if (this.maps.isTileMap) {\n                if (type === 'Template') {\n                    var templateOffset = element.getBoundingClientRect();\n                    element.style.left = ((location_2.x - (templateOffset.width / 2)) + marker.offset.x) + 'px';\n                    element.style.top = ((location_2.y - (templateOffset.height / 2)) + marker.offset.y) + 'px';\n                    if (this.maps.layers[this.maps.baseLayerIndex].layerType === 'GoogleStaticMap') {\n                        var staticMapOffset = getElementByID(this.maps.element.id + '_StaticGoogleMap').getBoundingClientRect();\n                        var staticMapOffsetWidth = 640;\n                        if (element['style']['display'] !== 'none') {\n                            if ((staticMapOffset['x'] > templateOffset['x'] || staticMapOffset['x'] + staticMapOffsetWidth < templateOffset['x'] + templateOffset['width'])\n                                && (staticMapOffset['y'] > templateOffset['y'] || staticMapOffset['y'] + staticMapOffset['height'] < templateOffset['y'] + templateOffset['height'])) {\n                                element['style']['display'] = 'none';\n                            }\n                            else if ((staticMapOffset['x'] > templateOffset['x'] || staticMapOffset['x'] + staticMapOffsetWidth < templateOffset['x'] + templateOffset['width'])) {\n                                element['style']['display'] = 'none';\n                            }\n                        }\n                    }\n                }\n                else {\n                    location_2.x += marker.offset.x;\n                    location_2.y += marker.offset.y;\n                    element.setAttribute('transform', 'translate( ' + location_2.x + ' ' + location_2.y + ' )');\n                }\n            }\n            else {\n                if (type === 'Template') {\n                    location_2.x = ((Math.abs(this.maps.baseMapRectBounds['min']['x'] - location_2.x)) * scale);\n                    location_2.y = ((Math.abs(this.maps.baseMapRectBounds['min']['y'] - location_2.y)) * scale);\n                    var layerOffset = getElementByID(this.maps.element.id + '_Layer_Collections').getBoundingClientRect();\n                    var elementOffset = element.parentElement.getBoundingClientRect();\n                    element.style.left = (((location_2.x) + (layerOffset.left - elementOffset.left)) + marker.offset.x) + 'px';\n                    element.style.top = (((location_2.y) + (layerOffset.top - elementOffset.top)) + marker.offset.y) + 'px';\n                    element.style.transform = 'translate(-50%, -50%)';\n                }\n                else {\n                    location_2.x = (((location_2.x + x) * scale) + marker.offset.x);\n                    location_2.y = (((location_2.y + y) * scale) + marker.offset.y);\n                    if (!animate || duration === 0) {\n                        element.setAttribute('transform', 'translate( ' + location_2.x + ' ' + location_2.y + ' )');\n                    }\n                    else {\n                        smoothTranslate(element, 0, duration, location_2);\n                    }\n                }\n            }\n        }\n    };\n    Zoom.prototype.panning = function (direction, xDifference, yDifference, mouseLocation) {\n        var map = this.maps;\n        var panArgs;\n        var down = this.mouseDownPoints;\n        var move = this.mouseMovePoints;\n        var scale = map.scale;\n        map.markerZoomedState = false;\n        map.zoomPersistence = map.enablePersistence;\n        map.defaultState = false;\n        map.initialCheck = false;\n        var translatePoint = map.translatePoint;\n        var prevTilePoint = map.tileTranslatePoint;\n        var x;\n        var y;\n        xDifference = !isNullOrUndefined(xDifference) ? xDifference : (down.x - move.x);\n        yDifference = !isNullOrUndefined(yDifference) ? yDifference : (down.y - move.y);\n        if (!map.isTileMap) {\n            x = translatePoint.x - xDifference / scale;\n            y = translatePoint.y - yDifference / scale;\n            var layerRect = getElementByID(map.element.id + '_Layer_Collections').getBoundingClientRect();\n            var elementRect = getElementByID(map.element.id + '_svg').getBoundingClientRect();\n            var panningXDirection = ((xDifference < 0 ? layerRect.left <= (elementRect.left + map.mapAreaRect.x) :\n                ((layerRect.left + layerRect.width) >= (elementRect.left + elementRect.width) + map.mapAreaRect.x + map.margin.left)));\n            var panningYDirection = ((yDifference < 0 ? layerRect.top <= (elementRect.top + map.mapAreaRect.y) :\n                ((layerRect.top + layerRect.height + map.margin.top) >= (elementRect.top + elementRect.height))));\n            var location_3 = this.maps.getGeoLocation(this.maps.layersCollection.length - 1, mouseLocation);\n            panArgs = {\n                cancel: false, name: pan, maps: !map.isBlazor ? map : null,\n                tileTranslatePoint: {}, translatePoint: { previous: translatePoint, current: new Point(x, y) },\n                scale: map.scale, tileZoomLevel: map.tileZoomLevel, latitude: location_3['latitude'], longitude: location_3['longitude']\n            };\n            map.trigger(pan, panArgs);\n            if (!panArgs.cancel) {\n                if (panningXDirection && panningYDirection) {\n                    map.translatePoint = new Point(x, y);\n                    this.applyTransform();\n                }\n                else if (panningXDirection) {\n                    map.translatePoint = new Point(x, map.translatePoint.y);\n                    this.applyTransform();\n                }\n                else if (panningYDirection) {\n                    map.translatePoint = new Point(map.translatePoint.x, y);\n                    this.applyTransform();\n                }\n            }\n            this.maps.zoomNotApplied = false;\n        }\n        else if (this.maps.tileZoomLevel > 1) {\n            x = map.tileTranslatePoint.x - xDifference;\n            y = map.tileTranslatePoint.y - yDifference;\n            this.distanceX = x - map.tileTranslatePoint.x;\n            this.distanceY = y - map.tileTranslatePoint.y;\n            map.tileTranslatePoint.x = x;\n            map.tileTranslatePoint.y = y;\n            if ((map.tileTranslatePoint.y > -10 && yDifference < 0) || ((map.tileTranslatePoint.y < -((Math.pow(2, this.maps.tileZoomLevel) - 2) * 256) && yDifference > 0))) {\n                map.tileTranslatePoint.x = x + xDifference;\n                map.tileTranslatePoint.y = y + yDifference;\n            }\n            map.translatePoint.x = (map.tileTranslatePoint.x - xDifference) / map.scale;\n            map.translatePoint.y = (map.tileTranslatePoint.y - yDifference) / map.scale;\n            var location_4 = this.maps.getTileGeoLocation(mouseLocation);\n            panArgs = {\n                cancel: false, name: pan, maps: !map.isBlazor ? map : null,\n                tileTranslatePoint: { previous: prevTilePoint, current: map.tileTranslatePoint },\n                translatePoint: { previous: translatePoint, current: map.translatePoint }, scale: map.scale,\n                tileZoomLevel: map.tileZoomLevel, latitude: location_4['latitude'], longitude: location_4['longitude']\n            };\n            map.trigger(pan, panArgs);\n            map.mapLayerPanel.generateTiles(map.tileZoomLevel, map.tileTranslatePoint, 'Pan');\n            this.applyTransform();\n        }\n        map.zoomTranslatePoint = map.translatePoint;\n        this.mouseDownPoints = this.mouseMovePoints;\n        this.maps.zoomNotApplied = false;\n        this.isSingleClick = false;\n    };\n    Zoom.prototype.toAlignSublayer = function () {\n        this.maps.translatePoint.x = !isNullOrUndefined(this.distanceX) ? (this.maps.translatePoint.x -\n            (this.distanceX / this.maps.scale)) : this.maps.translatePoint.x;\n        this.maps.translatePoint.y = !isNullOrUndefined(this.distanceY) ? this.maps.translatePoint.y -\n            (this.distanceY / this.maps.scale) : this.maps.translatePoint.y;\n        this.applyTransform(false);\n    };\n    Zoom.prototype.toolBarZooming = function (zoomFactor, type) {\n        var _this = this;\n        var map = this.maps;\n        map.initialCheck = false;\n        map.defaultState = ((type === 'Reset' && zoomFactor === 1 && !(map.zoomSettings.resetToInitial && map.applyZoomReset))\n            || (type === 'ZoomOut' && zoomFactor === 1));\n        var prevLevel = map.tileZoomLevel;\n        var scale = map.previousScale = map.scale;\n        map.markerZoomedState = false;\n        map.zoomPersistence = map.enablePersistence;\n        map.mapScaleValue = zoomFactor;\n        var maxZoom = map.zoomSettings.maxZoom;\n        var minZoom = map.zoomSettings.minZoom;\n        var size = map.mapAreaRect;\n        var translatePoint = map.previousPoint = map.translatePoint;\n        var prevTilePoint = map.tileTranslatePoint;\n        map.previousProjection = map.projectionType;\n        zoomFactor = (type === 'ZoomOut') ? (Math.round(zoomFactor) === 1 ? 1 : zoomFactor) : zoomFactor;\n        zoomFactor = (type === 'Reset') ? 1 : (Math.round(zoomFactor) === 0) ? 1 : zoomFactor;\n        zoomFactor = (minZoom > zoomFactor && type === 'ZoomIn') ? minZoom + 1 : zoomFactor;\n        var zoomArgs;\n        if ((!map.isTileMap) && (type === 'ZoomIn' ? zoomFactor >= minZoom && zoomFactor <= maxZoom : zoomFactor >= minZoom\n            || map.isReset)) {\n            var min = map.baseMapRectBounds['min'];\n            var max = map.baseMapRectBounds['max'];\n            var mapWidth = Math.abs(max['x'] - min['x']);\n            var mapHeight = Math.abs(min['y'] - max['y']);\n            var translatePointX = translatePoint.x - (((size.width / scale) - (size.width / zoomFactor)) / 2);\n            var translatePointY = translatePoint.y - (((size.height / scale) - (size.height / zoomFactor)) / 2);\n            var currentHeight = Math.abs(map.baseMapRectBounds['max']['y'] - map.baseMapRectBounds['min']['y']) * zoomFactor;\n            translatePointX = (currentHeight < map.mapAreaRect.height) ? (size.x + ((-(min['x'])) + ((size.width / 2) - (mapWidth / 2))))\n                : translatePointX;\n            translatePointY = (currentHeight < map.mapAreaRect.height) ? (size.y + ((-(min['y'])) + ((size.height / 2) - (mapHeight / 2))))\n                : translatePointY;\n            map.translatePoint = new Point(translatePointX, translatePointY);\n            map.zoomTranslatePoint = map.translatePoint;\n            map.scale = zoomFactor;\n            this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n            this.applyTransform(true);\n        }\n        else if ((map.isTileMap) && ((zoomFactor >= minZoom && zoomFactor <= maxZoom) || map.isReset)) {\n            var tileZoomFactor = prevLevel < minZoom && !map.isReset ? minZoom : zoomFactor;\n            map.scale = Math.pow(2, tileZoomFactor - 1);\n            map.tileZoomLevel = tileZoomFactor;\n            var position = { x: map.availableSize.width / 2, y: map.availableSize.height / 2 };\n            this.getTileTranslatePosition(prevLevel, tileZoomFactor, position, type);\n            if (map.zoomSettings.resetToInitial && map.applyZoomReset && type === 'Reset' || (type === 'ZoomOut' && map.zoomSettings.resetToInitial && map.applyZoomReset && tileZoomFactor <= map.initialZoomLevel)) {\n                map.initialCheck = true;\n                map.zoomPersistence = false;\n                map.tileTranslatePoint.x = map.initialTileTranslate.x;\n                map.tileTranslatePoint.y = map.initialTileTranslate.y;\n                tileZoomFactor = map.tileZoomLevel = map.mapScaleValue = map.initialZoomLevel;\n            }\n            this.triggerZoomEvent(prevTilePoint, prevLevel, type);\n            map.translatePoint.y = (map.tileTranslatePoint.y - (0.01 * map.scale)) / map.scale;\n            map.translatePoint.x = (map.tileTranslatePoint.x - (0.01 * map.scale)) / map.scale;\n            if (document.getElementById(this.maps.element.id + '_LayerIndex_1')) {\n                document.getElementById(this.maps.element.id + '_LayerIndex_1').style.display = 'none';\n            }\n            if (document.querySelector('.GroupElement')) {\n                document.querySelector('.GroupElement').style.display = 'none';\n            }\n            map.mapLayerPanel.generateTiles(tileZoomFactor, map.tileTranslatePoint, type);\n            var element1 = document.getElementById(this.maps.element.id + '_tiles');\n            setTimeout(function () {\n                if (type === 'ZoomOut' || type === \"Reset\") {\n                    // element1.removeChild(element1.children[element1.childElementCount - 1]);\n                    // element1.childElementCount ? element1.removeChild(element1.children[element1.childElementCount - 1]) : element1;\n                }\n                _this.applyTransform(true);\n                if (document.getElementById(_this.maps.element.id + '_LayerIndex_1')) {\n                    document.getElementById(_this.maps.element.id + '_LayerIndex_1').style.display = 'block';\n                }\n            }, 250);\n        }\n        this.maps.zoomNotApplied = false;\n    };\n    /* tslint:disable:max-func-body-length */\n    Zoom.prototype.createZoomingToolbars = function () {\n        var map = this.maps;\n        this.toolBarGroup = map.renderer.createGroup({\n            id: map.element.id + '_Zooming_KitCollection',\n            opacity: 0.3,\n        });\n        var kitHeight = 16;\n        var kitWidth = 16;\n        var xSpacing = 15;\n        var ySpacing = 15;\n        var padding = 20;\n        var orientation = map.zoomSettings.toolBarOrientation;\n        var toolbarsCollection = map.zoomSettings.toolbars;\n        var shadowElement = '<filter id=\"chart_shadow\" height=\"130%\"><feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"5\"/>';\n        shadowElement += '<feOffset dx=\"-3\" dy=\"4\" result=\"offsetblur\"/><feComponentTransfer><feFuncA type=\"linear\" slope=\"1\"/>';\n        shadowElement += '</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>';\n        var toolBarLength = map.zoomSettings.toolbars.length;\n        var toolWidth = (map.zoomSettings.toolBarOrientation === 'Horizontal') ? (toolBarLength * kitWidth) + (toolBarLength * padding) : (kitWidth * 2);\n        var toolHeight = (map.zoomSettings.toolBarOrientation === 'Horizontal') ? (kitHeight * 2) : (toolBarLength * kitHeight) + (toolBarLength * padding);\n        this.toolBarGroup.appendChild(map.renderer.drawRectangle(new RectOption(map.element.id + '_Zooming_Rect', 'transparent', { color: 'transparent', width: 1 }, 1, new Rect(0, 0, toolWidth, toolHeight), 0, 0)));\n        var defElement = map.renderer.createDefs();\n        defElement.innerHTML = shadowElement;\n        this.toolBarGroup.appendChild(defElement);\n        var outerElement = map.renderer.drawRectangle(new RectOption(map.element.id + '_Zooming_Rect', 'transparent', { color: 'transparent', width: 1 }, 0.1, new Rect(0, 0, toolWidth, toolHeight), 0, 0));\n        outerElement.setAttribute('filter', 'url(#chart_shadow)');\n        this.toolBarGroup.appendChild(outerElement);\n        var performFunction;\n        for (var i = 0; i < toolbarsCollection.length; i++) {\n            var toolbar_1 = toolbarsCollection[i];\n            var pathOptions = void 0;\n            var polyOptions = void 0;\n            this.currentToolbarEle = map.renderer.createGroup({\n                id: map.element.id + '_Zooming_ToolBar_' + toolbar_1 + '_Group',\n                transform: 'translate( ' + xSpacing + ' ' + ySpacing + ' ) '\n            });\n            this.currentToolbarEle.setAttribute('class', 'e-maps-toolbar');\n            var fillColor = '';\n            var fill = 'transparent';\n            var direction = '';\n            var polygonDirection = '';\n            switch (toolbar_1.toLowerCase()) {\n                case 'zoom':\n                    var fillColor_1 = void 0;\n                    var strokeColor = void 0;\n                    direction = 'M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,';\n                    direction += '5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571';\n                    direction = direction + 'L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,';\n                    if (this.maps.zoomSettings.enablePanning && !this.maps.zoomSettings.enableSelectionZooming) {\n                        fillColor_1 = fill;\n                        strokeColor = this.maps.themeStyle.zoomFillColor;\n                    }\n                    else if (this.maps.zoomSettings.enablePanning && this.maps.zoomSettings.enableSelectionZooming) {\n                        fillColor_1 = fill;\n                        strokeColor = this.maps.themeStyle.zoomFillColor;\n                    }\n                    else if (!this.maps.zoomSettings.enablePanning && !this.maps.zoomSettings.enableSelectionZooming) {\n                        fillColor_1 = fill;\n                        strokeColor = this.maps.themeStyle.zoomFillColor;\n                    }\n                    else {\n                        fillColor_1 = this.selectionColor;\n                        strokeColor = this.selectionColor;\n                    }\n                    this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, fillColor_1, 1, strokeColor, 1, null, direction + '4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z')));\n                    this.zoomElements = this.currentToolbarEle;\n                    this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n                    break;\n                case 'zoomin':\n                    direction = 'M 8, 0 L 8, 16 M 0, 8 L 16, 8';\n                    this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1 + '_Path', fill, 3, this.maps.themeStyle.zoomFillColor, 1, null, direction)));\n                    this.zoomInElements = this.currentToolbarEle;\n                    this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n                    break;\n                case 'zoomout':\n                    direction = 'M 0, 8 L 16, 8';\n                    this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, fill, 3, this.maps.themeStyle.zoomFillColor, 1, null, direction)));\n                    this.zoomOutElements = this.currentToolbarEle;\n                    this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n                    break;\n                case 'pan':\n                    var color = void 0;\n                    direction = 'M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,';\n                    direction += '11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z';\n                    if (this.maps.zoomSettings.enablePanning && this.maps.zoomModule.isDragZoom) {\n                        color = \"#737373\";\n                    }\n                    else if (!this.maps.zoomSettings.enablePanning) {\n                        color = \"#737373\";\n                        this.currentToolbarEle.setAttribute('class', '');\n                    }\n                    else {\n                        color = this.selectionColor;\n                    }\n                    this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, color, 1, color, 1, null, direction)));\n                    this.panColor = color;\n                    this.panElements = this.currentToolbarEle;\n                    this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n                    break;\n                case 'reset':\n                    direction = 'M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,';\n                    direction += '1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,';\n                    direction += '13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,';\n                    this.currentToolbarEle.appendChild(map.renderer.drawPath(new PathOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1, this.fillColor, null, this.maps.themeStyle.zoomFillColor, 1, null, direction + '3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z')));\n                    this.wireEvents(this.currentToolbarEle, this.performToolBarAction);\n                    break;\n            }\n            this.currentToolbarEle.appendChild(map.renderer.drawCircle(new CircleOption(map.element.id + '_Zooming_ToolBar_' + toolbar_1 + '_Rect', fill, { color: this.maps.themeStyle.zoomFillColor, width: 1 }, 1, 8, 8, 16, '')));\n            xSpacing = (orientation === 'Horizontal') ? (xSpacing + (kitWidth + padding)) : xSpacing;\n            ySpacing = (orientation === 'Horizontal') ? ySpacing : (ySpacing + (kitHeight + padding));\n            this.toolBarGroup.appendChild(this.currentToolbarEle);\n        }\n    };\n    Zoom.prototype.performToolBarAction = function (e) {\n        var target = e.target;\n        e.stopImmediatePropagation();\n        var isTouch = e.pointerType === 'touch' || e.pointerType === '2' || (e.type.indexOf('touch') > -1);\n        var toolbar = target.id.split('_Zooming_ToolBar_')[1].split('_')[0];\n        if (isTouch) {\n            this.handled = true;\n            this.performZoomingByToolBar(toolbar);\n        }\n        else if ((e.type === 'mousedown' || e.type === 'pointerdown') && !this.handled) {\n            this.handled = false;\n            this.performZoomingByToolBar(toolbar);\n        }\n        else {\n            this.handled = false;\n        }\n    };\n    /**\n     *\n     * @private\n     */\n    Zoom.prototype.performZoomingByToolBar = function (type) {\n        var map = this.maps;\n        map.isReset = false;\n        switch (type.toLowerCase()) {\n            case 'zoom':\n                this.panColor = this.fillColor;\n                this.zoomColor = this.selectionColor;\n                this.applySelection(this.zoomElements, this.selectionColor);\n                this.applySelection(this.panElements, this.fillColor);\n                break;\n            case 'pan':\n                if (!this.maps.zoomSettings.enablePanning) {\n                    this.panColor = '#737373';\n                }\n                else {\n                    this.panColor = this.selectionColor;\n                }\n                this.zoomColor = this.fillColor;\n                if (!this.maps.zoomSettings.enablePanning) {\n                    this.applySelection(this.zoomElements, this.selectionColor);\n                    this.applySelection(this.panElements, this.panColor);\n                }\n                else {\n                    this.applySelection(this.zoomElements, this.fillColor);\n                    this.applySelection(this.panElements, this.panColor);\n                }\n                break;\n            case 'zoomin':\n                map.staticMapZoom = map.tileZoomLevel;\n                if (map.staticMapZoom > 0 && map.staticMapZoom < 22) {\n                    map.staticMapZoom += 1;\n                }\n                this.toolBarZooming((map.isTileMap ? map.tileZoomLevel : map.scale) + 1, 'ZoomIn');\n                break;\n            case 'zoomout':\n                map.staticMapZoom = map.tileZoomLevel;\n                map.markerCenterLatitude = null;\n                map.markerCenterLongitude = null;\n                this.toolBarZooming((map.isTileMap ? map.tileZoomLevel : map.scale) - 1, 'ZoomOut');\n                break;\n            case 'reset':\n                map.staticMapZoom = map.zoomSettings.enable ? map.zoomSettings.zoomFactor : 0;\n                map.markerCenterLatitude = null;\n                map.markerCenterLongitude = null;\n                this.toolBarZooming(1, 'Reset');\n                if (!this.maps.zoomSettings.enablePanning) {\n                    this.applySelection(this.zoomElements, this.selectionColor);\n                    this.applySelection(this.panElements, '#737373');\n                }\n                else {\n                    this.applySelection(this.zoomElements, this.fillColor);\n                    this.applySelection(this.panElements, this.selectionColor);\n                }\n        }\n        this.panningStyle(type.toLowerCase());\n    };\n    Zoom.prototype.panningStyle = function (toolbar) {\n        var svg = getElementByID(this.maps.element.id + '_svg');\n        if (toolbar === 'pan' || this.isPanning) {\n            svg.setAttribute('class', 'e-maps-panning');\n        }\n        else {\n            svg.setAttribute('class', '');\n        }\n    };\n    Zoom.prototype.applySelection = function (elements, color) {\n        if (!elements) {\n            return;\n        }\n        var childElement;\n        for (var i = 0; i < elements.childElementCount; i++) {\n            childElement = elements.childNodes[i];\n            if (childElement.tagName !== 'circle') {\n                childElement.setAttribute('fill', color);\n                childElement.setAttribute('stroke', color);\n            }\n        }\n    };\n    Zoom.prototype.showTooltip = function (e) {\n        var text = e.target.id.split('_Zooming_ToolBar_')[1].split('_')[0];\n        if (!this.isTouch) {\n            createTooltip('EJ2_Map_Toolbar_Tip', this.maps.getLocalizedLabel(text), (e.pageY + 10), (e.pageX + 10), '10px');\n        }\n    };\n    Zoom.prototype.removeTooltip = function () {\n        if (getElementByID('EJ2_Map_Toolbar_Tip')) {\n            remove(getElementByID('EJ2_Map_Toolbar_Tip'));\n        }\n    };\n    Zoom.prototype.alignToolBar = function () {\n        var map = this.maps;\n        var padding = 10;\n        var element = createElement('div', { id: map.element.id + '_ToolBar', styles: 'position:absolute;z-index:2' });\n        var rectSVGObject = map.renderer.createSvg({\n            id: map.element.id + '_Zooming_ToolBar', width: 10, height: 10,\n        });\n        rectSVGObject.appendChild(this.toolBarGroup);\n        element.appendChild(rectSVGObject);\n        if (getElementByID(map.element.id + '_Secondary_Element')) {\n            getElementByID(map.element.id + '_Secondary_Element').appendChild(element);\n        }\n        var toolBarSize = this.toolBarGroup.getBoundingClientRect();\n        rectSVGObject.setAttribute('height', (toolBarSize.height + padding / 2).toString());\n        rectSVGObject.setAttribute('width', (toolBarSize.width + padding / 2).toString());\n        var size = !isNullOrUndefined(map.totalRect) ? map.totalRect : map.mapAreaRect;\n        var x = 0;\n        var y = 0;\n        switch (map.zoomSettings.verticalAlignment) {\n            case 'Near':\n                y = size.y;\n                break;\n            case 'Center':\n                y = (size.height / 2) - (toolBarSize.height / 2);\n                break;\n            case 'Far':\n                y = (size.height - toolBarSize.height) - padding;\n                break;\n        }\n        switch (map.zoomSettings.horizontalAlignment) {\n            case 'Near':\n                x = size.x;\n                break;\n            case 'Center':\n                x = (size.width / 2) - (toolBarSize.width / 2);\n                break;\n            case 'Far':\n                x = (size.width - toolBarSize.width) - padding;\n                break;\n        }\n        element.style.left = x + 'px';\n        element.style.top = y + 'px';\n        var color = this.maps.zoomSettings.highlightColor;\n        var css = ' .e-maps-toolbar:hover > circle { stroke:' + color + '; } .e-maps-toolbar:hover > path { fill: ' + color + ' ;  stroke: ' + color + '; }' +\n            '.e-maps-toolbar:hover { cursor: pointer; } .e-maps-cursor-disable:hover { cursor: not-allowed; } .e-maps-panning:hover { cursor: pointer; } ' +\n            '.e-maps-popup-close { display: block; opacity: 0; }';\n        var style = document.createElement('style');\n        style.appendChild(document.createTextNode(css));\n        element.appendChild(style);\n    };\n    /**\n     * To bind events.\n     * @return {void}\n     * @private\n     */\n    Zoom.prototype.wireEvents = function (element, process) {\n        EventHandler.add(element, Browser.touchStartEvent, process, this);\n        EventHandler.add(element, 'mouseover', this.showTooltip, this);\n        EventHandler.add(element, 'mouseout', this.removeTooltip, this);\n    };\n    Zoom.prototype.mapMouseWheel = function (e) {\n        if (this.maps.zoomSettings.enable && this.maps.zoomSettings.mouseWheelZoom) {\n            var map = this.maps;\n            var size = map.availableSize;\n            map.markerZoomedState = false;\n            map.zoomPersistence = map.enablePersistence;\n            var position = this.getMousePosition(e.pageX, e.pageY);\n            var prevLevel = map.tileZoomLevel;\n            var prevScale = map.scale;\n            var delta = 1;\n            var staticMaxZoomLevel = 22; // google map maximum zoom level value\n            var value = (map.isTileMap) ? prevLevel : prevScale;\n            if (((position.x > map.mapAreaRect.x) && (position.x < (map.mapAreaRect.x + map.mapAreaRect.width))) &&\n                (position.y > map.mapAreaRect.y) && position.y < (map.mapAreaRect.y + map.mapAreaRect.height)) {\n                e.preventDefault();\n                var direction = (this.browserName === 'mozilla' && !this.isPointer) ?\n                    -(e.detail) / 3 > 0 ? 'ZoomIn' : 'ZoomOut' : (e.wheelDelta / 120) > 0 ? 'ZoomIn' : 'ZoomOut';\n                if (direction === 'ZoomIn') {\n                    map.mapScaleValue = value + delta;\n                    map.staticMapZoom = map.tileZoomLevel;\n                    if (map.staticMapZoom > 0 && map.staticMapZoom < staticMaxZoomLevel) {\n                        map.staticMapZoom += 1;\n                    }\n                    this.performZooming(position, (value + delta), direction);\n                }\n                else {\n                    map.mapScaleValue = value - delta;\n                    map.staticMapZoom = map.tileZoomLevel;\n                    if (map.mapScaleValue === 1) {\n                        map.markerCenterLatitude = null;\n                        map.markerCenterLongitude = null;\n                    }\n                    if (map.staticMapZoom > 1 && map.staticMapZoom < staticMaxZoomLevel) {\n                        map.staticMapZoom -= 1;\n                    }\n                    this.performZooming(position, (value - delta), direction);\n                }\n            }\n        }\n    };\n    Zoom.prototype.doubleClick = function (e) {\n        var pageX = e.pageX;\n        var pageY = e.pageY;\n        var target = e.target;\n        if (this.maps.zoomSettings.enable && this.maps.zoomSettings.doubleClickZoom\n            && !(e.target['id'].indexOf('_Zooming_') > -1)) {\n            var position = this.getMousePosition(pageX, pageY);\n            var map = this.maps;\n            var size = map.availableSize;\n            var prevLevel = map.tileZoomLevel;\n            var prevScale = map.scale;\n            map.mapScaleValue = map.mapScaleValue + 1;\n            var value = (map.isTileMap) ? prevLevel : prevScale;\n            if (((position.x > map.mapAreaRect.x) && (position.x < (map.mapAreaRect.x + map.mapAreaRect.width))) &&\n                (position.y > map.mapAreaRect.y) && position.y < (map.mapAreaRect.y + map.mapAreaRect.height)) {\n                this.performZooming(position, (value + 1), 'ZoomIn');\n            }\n        }\n    };\n    Zoom.prototype.mouseDownHandler = function (e) {\n        var pageX;\n        var pageY;\n        var target;\n        var touches = null;\n        var element = e.target;\n        if (e.type === 'touchstart') {\n            this.isTouch = true;\n            touches = e.touches;\n            target = e.target;\n            pageX = touches[0].clientX;\n            pageY = touches[0].clientY;\n        }\n        else {\n            pageX = e.pageX;\n            pageY = e.pageY;\n            target = e.target;\n        }\n        if (!this.maps.zoomSettings.enablePanning) {\n            this.isPanning = this.panColor !== this.selectionColor ? this.maps.zoomSettings.enablePanning\n                : this.zoomColor === this.selectionColor;\n        }\n        else {\n            this.isPanning = this.panColor === this.selectionColor ? this.maps.zoomSettings.enablePanning\n                : this.zoomColor !== this.selectionColor;\n        }\n        this.mouseDownLatLong = { x: pageX, y: pageY };\n        this.rectZoomingStart = ((!this.isPanning) && this.maps.zoomSettings.enable);\n        this.mouseDownPoints = this.getMousePosition(pageX, pageY);\n        if (this.isTouch) {\n            this.firstMove = true;\n            this.pinchFactor = this.maps.scale;\n            this.fingers = touches.length;\n        }\n        this.isSingleClick = true;\n    };\n    Zoom.prototype.mouseMoveHandler = function (e) {\n        var pageX;\n        var pageY;\n        var map = this.maps;\n        var touchArg;\n        var target;\n        var touches = null;\n        var zoom = this.maps.zoomSettings;\n        if (e.type === 'touchmove') {\n            this.isTouch = true;\n            target = e.target;\n            touches = e.touches;\n            pageX = touches[0].clientX;\n            pageY = touches[0].clientY;\n        }\n        else {\n            pageX = e.pageX;\n            pageY = e.pageY;\n            target = e.target;\n        }\n        if (getElementByID(map.element.id + '_Zooming_KitCollection')) {\n            if (target.id.indexOf('_Zooming_') > -1) {\n                getElementByID(map.element.id + '_Zooming_KitCollection').setAttribute('opacity', '1');\n                if (document.getElementById(map.element.id + '_Zooming_ToolBar_Pan_Group')) {\n                    if (!this.maps.zoomSettings.enablePanning) {\n                        if (target.id.indexOf('_Zooming_ToolBar') > -1 || target.id.indexOf('_Zooming_Rect') > -1) {\n                            getElementByID(map.element.id + '_Zooming_ToolBar_Pan_Rect').setAttribute('opacity', '0.3');\n                            getElementByID(map.element.id + '_Zooming_ToolBar_Pan').setAttribute('opacity', '0.3');\n                        }\n                    }\n                }\n            }\n            else {\n                getElementByID(map.element.id + '_Zooming_KitCollection').setAttribute('opacity', '0.3');\n                if (!this.maps.zoomSettings.enablePanning && document.getElementById(map.element.id + '_Zooming_ToolBar_Pan_Group')) {\n                    getElementByID(map.element.id + '_Zooming_ToolBar_Pan_Rect').setAttribute('opacity', '1');\n                    getElementByID(map.element.id + '_Zooming_ToolBar_Pan').setAttribute('opacity', '1');\n                }\n            }\n        }\n        if (this.isTouch) {\n            if (this.maps.zoomSettings.pinchZooming) {\n                if (this.firstMove && touches.length === 2) {\n                    this.rectZoomingStart = false;\n                    this.updateInteraction();\n                    this.touchStartList = targetTouches(e);\n                }\n                else if (this.touchStartList.length === 2 && touches.length === 2) {\n                    this.touchMoveList = targetTouches(e);\n                    e.preventDefault();\n                    this.rectZoomingStart = false;\n                    this.performPinchZooming(e);\n                }\n                this.firstMove = false;\n            }\n        }\n        this.mouseMovePoints = this.getMousePosition(pageX, pageY);\n        var targetId = e.target['id'];\n        var targetEle = e.target;\n        if (zoom.enable && this.isPanning && ((Browser.isDevice && touches.length > 1) || !Browser.isDevice)) {\n            e.preventDefault();\n            this.maps.element.style.cursor = 'pointer';\n            this.mouseMoveLatLong = { x: pageX, y: pageY };\n            if ((this.mouseDownLatLong['x'] !== this.mouseMoveLatLong['x']) && (this.mouseDownLatLong['y'] !== this.mouseMoveLatLong['y'])) {\n                if (this.maps.zoomSettings.enablePanning) {\n                    this.panning('None', null, null, e);\n                }\n                this.mouseDownLatLong['x'] = pageX;\n                this.mouseDownLatLong['y'] = pageY;\n            }\n        }\n        if (this.isTouch ? (touches.length === 1 && this.rectZoomingStart) : this.rectZoomingStart) {\n            e.preventDefault();\n            if (this.maps.zoomSettings.enableSelectionZooming) {\n                this.drawZoomRectangle();\n            }\n        }\n    };\n    Zoom.prototype.mouseUpHandler = function (e) {\n        var isDragZoom;\n        var map = this.maps;\n        this.rectZoomingStart = false;\n        this.isPanning = false;\n        this.isSingleClick = this.isSingleClick ? true : false;\n        this.isTouch = false;\n        this.touchStartList = [];\n        this.touchMoveList = [];\n        this.lastScale = 1;\n        this.maps.element.style.cursor = 'auto';\n        if ((!isNullOrUndefined(this.distanceX) || !isNullOrUndefined(this.distanceY)) && (!isNullOrUndefined(this.currentLayer) && this.currentLayer.type === 'SubLayer')) {\n            this.toAlignSublayer();\n            this.distanceX = this.distanceY = null;\n        }\n        var zoomRectElement = getElementByID(this.maps.element.id + '_Selection_Rect_Zooming');\n        if (zoomRectElement && this.maps.zoomSettings.enable && this.maps.zoomSettings.enableSelectionZooming) {\n            isDragZoom = true;\n            remove(zoomRectElement);\n            this.performRectZooming();\n        }\n        this.mouseMoveLatLong = { x: 0, y: 0 };\n        this.mouseDownLatLong = { x: 0, y: 0 };\n    };\n    Zoom.prototype.mouseCancelHandler = function (e) {\n        this.isPanning = false;\n        this.isTouch = false;\n        this.rectZoomingStart = false;\n        var zoomRectElement = getElementByID(this.maps.element.id + '_Selection_Rect_Zooming');\n        if (zoomRectElement && this.maps.zoomSettings.enable) {\n            remove(zoomRectElement);\n            this.performRectZooming();\n        }\n    };\n    /**\n     * To handle the click event for maps.\n     * @param e\n     */\n    Zoom.prototype.click = function (e) {\n        var map = this.maps;\n        if ((map.markerModule && map.markerModule.sameMarkerData.length > 0) ||\n            (e.target['id'].indexOf('MarkerIndex') > -1 && e.target['id'].indexOf('cluster') == -1)) {\n            return null;\n        }\n        if (this.isSingleClick && map.zoomSettings.zoomOnClick && !(e.target['id'].indexOf('_Zooming_') > -1) && !map.zoomSettings.doubleClickZoom\n            && (this.zoomColor !== this.selectionColor)) {\n            var pageX = e.pageX;\n            var pageY = e.pageY;\n            var position = this.getMousePosition(pageX, pageY);\n            var prevLevel = map.tileZoomLevel;\n            var prevScale = map.scale;\n            map.mapScaleValue = map.mapScaleValue + 1;\n            var value = (map.isTileMap) ? prevLevel : prevScale;\n            if (((position.x > map.mapAreaRect.x) && (position.x < (map.mapAreaRect.x + map.mapAreaRect.width))) &&\n                (position.y > map.mapAreaRect.y) && position.y < (map.mapAreaRect.y + map.mapAreaRect.height)) {\n                this.performZooming(position, (value + 1), 'ZoomIn');\n            }\n        }\n    };\n    Zoom.prototype.getMousePosition = function (pageX, pageY) {\n        var map = this.maps;\n        var elementRect = map.element.getBoundingClientRect();\n        var pageXOffset = map.element.ownerDocument.defaultView.pageXOffset;\n        var pageYOffset = map.element.ownerDocument.defaultView.pageYOffset;\n        var clientTop = map.element.ownerDocument.documentElement.clientTop;\n        var clientLeft = map.element.ownerDocument.documentElement.clientLeft;\n        var positionX = elementRect.left + pageXOffset - clientLeft;\n        var positionY = elementRect.top + pageYOffset - clientTop;\n        return new Point(Math.abs(pageX - positionX), Math.abs(pageY - positionY));\n    };\n    Zoom.prototype.addEventListener = function () {\n        if (this.maps.isDestroyed) {\n            return;\n        }\n        EventHandler.add(this.maps.element, this.wheelEvent, this.mapMouseWheel, this);\n        EventHandler.add(this.maps.element, 'click', this.click, this);\n        EventHandler.add(this.maps.element, 'dblclick', this.doubleClick, this);\n        this.maps.on(Browser.touchMoveEvent, this.mouseMoveHandler, this);\n        this.maps.on(Browser.touchStartEvent, this.mouseDownHandler, this);\n        this.maps.on(Browser.touchEndEvent, this.mouseUpHandler, this);\n        EventHandler.add(this.maps.element, this.cancelEvent, this.mouseCancelHandler, this);\n    };\n    Zoom.prototype.removeEventListener = function () {\n        if (this.maps.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(this.maps.element, this.wheelEvent, this.mapMouseWheel);\n        EventHandler.remove(this.maps.element, 'click', this.click);\n        EventHandler.remove(this.maps.element, 'dblclick', this.doubleClick);\n        this.maps.off(Browser.touchMoveEvent, this.mouseMoveHandler);\n        this.maps.off(Browser.touchStartEvent, this.mouseDownHandler);\n        this.maps.off(Browser.touchEndEvent, this.mouseUpHandler);\n        this.maps.off(this.cancelEvent, this.mouseCancelHandler);\n    };\n    /**\n     * Get module name.\n     */\n    Zoom.prototype.getModuleName = function () {\n        return 'Zoom';\n    };\n    /**\n     * To destroy the zoom.\n     * @return {void}\n     * @private\n     */\n    Zoom.prototype.destroy = function (maps) {\n        this.removeEventListener();\n        /**\n         * Destroy method performed here\n         */\n    };\n    return Zoom;\n}());\nexport { Zoom };\n"]},"metadata":{},"sourceType":"module"}